
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>sleap.nn.inference &#8212; SLEAP  documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="sleap.nn.losses" href="sleap.nn.losses.html" />
    <link rel="prev" title="sleap.nn.heads" href="sleap.nn.heads.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="module-sleap.nn.inference">
<span id="sleap-nn-inference"></span><h1>sleap.nn.inference<a class="headerlink" href="#module-sleap.nn.inference" title="Permalink to this headline">¶</a></h1>
<p>Inference pipelines and utilities.</p>
<p>This module contains the classes and high level APIs for predicting instances on new
data using trained models.</p>
<p>The inference logic is implemented at two levels:</p>
<ul class="simple">
<li><p>Low-level <cite>InferenceModel`s which subclass `tf.keras.Model</cite> and implement the core
TensorFlow operations surrounding inference. These should only be used when
implementing custom inference routines, such as real-time or performance-critical
applications. They do not implement tracking (identity association).</p></li>
<li><p>High-level <a href="#id1"><span class="problematic" id="id2">`</span></a>Predictor`s which handle data loading, preprocessing, inference, tracking
and postprocessing, including converting raw array results into SLEAP-specific data
structures. These should be used for general-purpose prediction, including interactive
inference and applications that require tracking (identity association).</p></li>
</ul>
<p>For more information on tracking, see the <cite>sleap.nn.tracking</cite> module.</p>
<p>The recommended high-level API for loading saved models is the <cite>sleap.load_models</cite>
function which provides a simplified interface for creating <a href="#id3"><span class="problematic" id="id4">`</span></a>Predictor`s.</p>
<dl class="py class">
<dt id="sleap.nn.inference.BottomUpInferenceLayer">
<em class="property">class </em><code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">BottomUpInferenceLayer</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#BottomUpInferenceLayer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceLayer" title="Permalink to this definition">¶</a></dt>
<dd><p>Keras layer that predicts instances from images using a trained model.</p>
<p>This layer encapsulates all of the inference operations required for generating
predictions from a centered instance confidence map model. This includes
preprocessing, model forward pass, peak finding and coordinate adjustment.</p>
<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpInferenceLayer.keras_model">
<code class="sig-name descname">keras_model</code><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceLayer.keras_model" title="Permalink to this definition">¶</a></dt>
<dd><p>A <cite>tf.keras.Model</cite> that accepts rank-4 images as input and predicts
rank-4 confidence maps and part affinity fields as output.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpInferenceLayer.paf_scorer">
<code class="sig-name descname">paf_scorer</code><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceLayer.paf_scorer" title="Permalink to this definition">¶</a></dt>
<dd><p>A <cite>sleap.nn.paf_grouping.PAFScorer</cite> instance configured to group
instances based on peaks and PAFs produced by the model.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpInferenceLayer.input_scale">
<code class="sig-name descname">input_scale</code><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceLayer.input_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Float indicating if the images should be resized before being
passed to the model.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpInferenceLayer.cm_output_stride">
<code class="sig-name descname">cm_output_stride</code><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceLayer.cm_output_stride" title="Permalink to this definition">¶</a></dt>
<dd><p>Output stride of the model, denoting the scale of the output
confidence maps relative to the images (after input scaling). This is used
for adjusting the peak coordinates to the image grid. This will be inferred
from the model shapes if not provided.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpInferenceLayer.paf_output_stride">
<code class="sig-name descname">paf_output_stride</code><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceLayer.paf_output_stride" title="Permalink to this definition">¶</a></dt>
<dd><p>Output stride of the model, denoting the scale of the output
part affinity fields relative to the images (after input scaling). This is
used for adjusting the peak coordinates to the PAF grid. This will be
inferred from the model shapes if not provided.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpInferenceLayer.peak_threshold">
<code class="sig-name descname">peak_threshold</code><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceLayer.peak_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimum confidence map value to consider a global peak as valid.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpInferenceLayer.refinement">
<code class="sig-name descname">refinement</code><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceLayer.refinement" title="Permalink to this definition">¶</a></dt>
<dd><p>If <cite>None</cite>, returns the grid-aligned peaks with no refinement. If
<cite>“integral”</cite>, peaks will be refined with integral regression. If <cite>“local”</cite>,
peaks will be refined with quarter pixel local gradient offset. This has no
effect if the model has an offset regression head.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpInferenceLayer.integral_patch_size">
<code class="sig-name descname">integral_patch_size</code><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceLayer.integral_patch_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of patches to crop around each rough peak for integral
refinement as an integer scalar.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpInferenceLayer.return_confmaps">
<code class="sig-name descname">return_confmaps</code><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceLayer.return_confmaps" title="Permalink to this definition">¶</a></dt>
<dd><p>If <cite>True</cite>, the confidence maps will be returned together with
the predicted instances. This will result in slower inference times since
the data must be copied off of the GPU, but is useful for visualizing the
raw output of the model.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpInferenceLayer.return_pafs">
<code class="sig-name descname">return_pafs</code><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceLayer.return_pafs" title="Permalink to this definition">¶</a></dt>
<dd><p>If <cite>True</cite>, the part affinity fields will be returned together with
the predicted instances. This will result in slower inference times since
the data must be copied off of the GPU, but is useful for visualizing the
raw output of the model.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpInferenceLayer.confmaps_ind">
<code class="sig-name descname">confmaps_ind</code><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceLayer.confmaps_ind" title="Permalink to this definition">¶</a></dt>
<dd><p>Index of the output tensor of the model corresponding to
confidence maps. If <cite>None</cite> (the default), this will be detected
automatically by searching for the first tensor that contains
<cite>“MultiInstanceConfmapsHead”</cite> in its name.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpInferenceLayer.pafs_ind">
<code class="sig-name descname">pafs_ind</code><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceLayer.pafs_ind" title="Permalink to this definition">¶</a></dt>
<dd><p>Index of the output tensor of the model corresponding to part affinity
fields. If <cite>None</cite> (the default), this will be detected automatically by
searching for the first tensor that contains <cite>“PartAffinityFieldsHead”</cite> in
its name.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpInferenceLayer.offsets_ind">
<code class="sig-name descname">offsets_ind</code><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceLayer.offsets_ind" title="Permalink to this definition">¶</a></dt>
<dd><p>Index of the output tensor of the model corresponding to
offset regression maps. If <cite>None</cite> (the default), this will be detected
automatically by searching for the first tensor that contains
<cite>“OffsetRefinementHead”</cite> in its name. If the head is not present, the method
specified in the <cite>refinement</cite> attribute will be used.</p>
</dd></dl>

<dl class="py method">
<dt id="sleap.nn.inference.BottomUpInferenceLayer.call">
<code class="sig-name descname">call</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#BottomUpInferenceLayer.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceLayer.call" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict instances for one batch of images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – This may be either a single batch of images as a 4-D tensor of shape</p></li>
<li><p><strong>`</strong> (<em>batch_size</em><em>, </em><em>height</em><em>, </em><em>width</em><em>, </em><em>channels</em>) – </p></li>
<li><p><strong>batch in the &quot;images&quot; key.</strong> (<em>image</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><cite>“instance_peaks”: (batch_size, n_instances, n_nodes, 2)</cite>: Instance skeleton
points.</p>
<p><cite>”instance_peak_vals”: (batch_size, n_instances, n_nodes)</cite>: Confidence
values for the instance skeleton points.</p>
<p><cite>”instance_scores”: (batch_size, n_instances)</cite>: PAF matching score for each
instance.</p>
<p>If <cite>BottomUpInferenceLayer.return_confmaps</cite> is <cite>True</cite>, the predicted
confidence maps will be returned in the <cite>“confmaps”</cite> key.</p>
<p>If <cite>BottomUpInferenceLayer.return_pafs</cite> is <cite>True</cite>, the predicted PAFs will
be returned in the <cite>“part_affinity_fields”</cite> key.</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>The predicted instances as a dictionary of tensors with keys</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sleap.nn.inference.BottomUpInferenceLayer.find_peaks">
<code class="sig-name descname">find_peaks</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cms</span></em>, <em class="sig-param"><span class="n">offsets</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#BottomUpInferenceLayer.find_peaks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceLayer.find_peaks" title="Permalink to this definition">¶</a></dt>
<dd><p>Run peak finding on predicted confidence maps.</p>
</dd></dl>

<dl class="py method">
<dt id="sleap.nn.inference.BottomUpInferenceLayer.forward_pass">
<code class="sig-name descname">forward_pass</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#BottomUpInferenceLayer.forward_pass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceLayer.forward_pass" title="Permalink to this definition">¶</a></dt>
<dd><p>Run preprocessing and model inference on a batch.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sleap.nn.inference.BottomUpInferenceModel">
<em class="property">class </em><code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">BottomUpInferenceModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#BottomUpInferenceModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bottom-up instance prediction model.</p>
<p>This model encapsulates the bottom-up approach where points are first detected by
local peak detection and then grouped into instances by connectivity scoring using
part affinity fields.</p>
<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpInferenceModel.bottomup_layer">
<code class="sig-name descname">bottomup_layer</code><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceModel.bottomup_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>A <cite>BottomUpInferenceLayer</cite>. This layer takes as input a full
image and outputs the predicted instances.</p>
</dd></dl>

<dl class="py method">
<dt id="sleap.nn.inference.BottomUpInferenceModel.call">
<code class="sig-name descname">call</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">example</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#BottomUpInferenceModel.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceModel.call" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict instances for one batch of images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>example</strong> – This may be either a single batch of images as a 4-D tensor of
shape <cite>(batch_size, height, width, channels)</cite>, or a dictionary
containing the image batch in the <cite>“images”</cite> key.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt><cite>“instance_peaks”: (batch_size, n_instances, n_nodes, 2)</cite>: Instance skeleton</dt><dd><p>points.</p>
</dd>
<dt><cite>”instance_peak_vals”: (batch_size, n_instances, n_nodes)</cite>: Confidence</dt><dd><p>values for the instance skeleton points.</p>
</dd>
<dt><cite>”instance_scores”: (batch_size, n_instances)</cite>: PAF matching score for each</dt><dd><p>instance.</p>
</dd>
</dl>
<p>If <cite>BottomUpInferenceModel.bottomup_layer.return_confmaps</cite> is <cite>True</cite>, the
predicted confidence maps will be returned in the <cite>“confmaps”</cite> key.</p>
<p>If <cite>BottomUpInferenceModel.bottomup_layer.return_pafs</cite> is <cite>True</cite>, the
predicted PAFs will be returned in the <cite>“part_affinity_fields”</cite> key.</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>The predicted instances as a dictionary of tensors with keys</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sleap.nn.inference.BottomUpPredictor">
<em class="property">class </em><code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">BottomUpPredictor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bottomup_config</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sleap.nn.config.training_job.html#sleap.nn.config.training_job.TrainingJobConfig" title="sleap.nn.config.training_job.TrainingJobConfig">sleap.nn.config.training_job.TrainingJobConfig</a></span></em>, <em class="sig-param"><span class="n">bottomup_model</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sleap.nn.model.html#sleap.nn.model.Model" title="sleap.nn.model.Model">sleap.nn.model.Model</a></span></em>, <em class="sig-param"><span class="n">inference_model</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="#sleap.nn.inference.BottomUpInferenceModel" title="sleap.nn.inference.BottomUpInferenceModel">sleap.nn.inference.BottomUpInferenceModel</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">peak_threshold</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.2</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="n">integral_refinement</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">integral_patch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em>, <em class="sig-param"><span class="n">max_edge_length_ratio</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">paf_line_points</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">10</span></em>, <em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">verbosity</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'rich'</span></em>, <em class="sig-param"><span class="n">report_rate</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">2.0</span></em>, <em class="sig-param"><span class="n">model_paths</span><span class="p">:</span> <span class="n">List<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">NOTHING</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#BottomUpPredictor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.BottomUpPredictor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bottom-up multi-instance predictor.</p>
<p>This high-level class handles initialization, preprocessing and tracking using a
trained bottom-up multi-instance SLEAP model.</p>
<p>This should be initialized using the <cite>from_trained_models()</cite> constructor or the
high-level API (<cite>sleap.load_model</cite>).</p>
<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpPredictor.bottomup_config">
<code class="sig-name descname">bottomup_config</code><a class="headerlink" href="#sleap.nn.inference.BottomUpPredictor.bottomup_config" title="Permalink to this definition">¶</a></dt>
<dd><p>The <cite>sleap.nn.config.TrainingJobConfig</cite> containing the metadata
for the trained bottomup model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="sleap.nn.config.training_job.html#sleap.nn.config.training_job.TrainingJobConfig" title="sleap.nn.config.training_job.TrainingJobConfig">sleap.nn.config.training_job.TrainingJobConfig</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpPredictor.bottomup_model">
<code class="sig-name descname">bottomup_model</code><a class="headerlink" href="#sleap.nn.inference.BottomUpPredictor.bottomup_model" title="Permalink to this definition">¶</a></dt>
<dd><p>A <cite>sleap.nn.model.Model</cite> instance created from the trained
bottomup model. If <cite>None</cite>, ground truth centroids will be used if available
from the data source.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="sleap.nn.model.html#sleap.nn.model.Model" title="sleap.nn.model.Model">sleap.nn.model.Model</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpPredictor.inference_model">
<code class="sig-name descname">inference_model</code><a class="headerlink" href="#sleap.nn.inference.BottomUpPredictor.inference_model" title="Permalink to this definition">¶</a></dt>
<dd><p>A <cite>sleap.nn.inference.BottomUpInferenceModel</cite> that wraps a
trained <cite>tf.keras.Model</cite> to implement preprocessing, centroid detection,
cropping and peak finding.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[<a class="reference internal" href="#sleap.nn.inference.BottomUpInferenceModel" title="sleap.nn.inference.BottomUpInferenceModel">sleap.nn.inference.BottomUpInferenceModel</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpPredictor.pipeline">
<code class="sig-name descname">pipeline</code><a class="headerlink" href="#sleap.nn.inference.BottomUpPredictor.pipeline" title="Permalink to this definition">¶</a></dt>
<dd><p>A <cite>sleap.nn.data.Pipeline</cite> that loads the data and batches input data.
This will be updated dynamically if new data sources are used.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[<a class="reference internal" href="sleap.nn.data.pipelines.html#sleap.nn.data.pipelines.Pipeline" title="sleap.nn.data.pipelines.Pipeline">sleap.nn.data.pipelines.Pipeline</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpPredictor.tracker">
<code class="sig-name descname">tracker</code><a class="headerlink" href="#sleap.nn.inference.BottomUpPredictor.tracker" title="Permalink to this definition">¶</a></dt>
<dd><p>A <cite>sleap.nn.tracking.Tracker</cite> that will be called to associate
detections over time. Predicted instances will not be assigned to tracks if
if this is <cite>None</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[<a class="reference internal" href="sleap.nn.tracking.html#sleap.nn.tracking.Tracker" title="sleap.nn.tracking.Tracker">sleap.nn.tracking.Tracker</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpPredictor.batch_size">
<code class="sig-name descname">batch_size</code><a class="headerlink" href="#sleap.nn.inference.BottomUpPredictor.batch_size" title="Permalink to this definition">¶</a></dt>
<dd><p>The default batch size to use when loading data for inference.
Higher values increase inference speed at the cost of higher memory usage.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpPredictor.peak_threshold">
<code class="sig-name descname">peak_threshold</code><a class="headerlink" href="#sleap.nn.inference.BottomUpPredictor.peak_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimum confidence map value to consider a local peak as valid.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpPredictor.integral_refinement">
<code class="sig-name descname">integral_refinement</code><a class="headerlink" href="#sleap.nn.inference.BottomUpPredictor.integral_refinement" title="Permalink to this definition">¶</a></dt>
<dd><p>If <cite>True</cite>, peaks will be refined with integral regression.
If <cite>False</cite>, <cite>“local”</cite>, peaks will be refined with quarter pixel local
gradient offset. This has no effect if the model has an offset regression
head.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpPredictor.integral_patch_size">
<code class="sig-name descname">integral_patch_size</code><a class="headerlink" href="#sleap.nn.inference.BottomUpPredictor.integral_patch_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of patches to crop around each rough peak for integral
refinement as an integer scalar.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpPredictor.max_edge_length_ratio">
<code class="sig-name descname">max_edge_length_ratio</code><a class="headerlink" href="#sleap.nn.inference.BottomUpPredictor.max_edge_length_ratio" title="Permalink to this definition">¶</a></dt>
<dd><p>The maximum expected length of a connected pair of points
in relative image units. Candidate connections above this length will be
penalized during matching.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpPredictor.paf_line_points">
<code class="sig-name descname">paf_line_points</code><a class="headerlink" href="#sleap.nn.inference.BottomUpPredictor.paf_line_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of points to sample along the line integral.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sleap.nn.inference.BottomUpPredictor.from_trained_models">
<em class="property">classmethod </em><code class="sig-name descname">from_trained_models</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model_path</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="n">peak_threshold</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.2</span></em>, <em class="sig-param"><span class="n">integral_refinement</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">integral_patch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#sleap.nn.inference.BottomUpPredictor" title="sleap.nn.inference.BottomUpPredictor">sleap.nn.inference.BottomUpPredictor</a><a class="reference internal" href="../_modules/sleap/nn/inference.html#BottomUpPredictor.from_trained_models"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.BottomUpPredictor.from_trained_models" title="Permalink to this definition">¶</a></dt>
<dd><p>Create predictor from a saved model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_path</strong> – Path to a bottom-up model folder or training job JSON file
inside a model folder. This folder should contain <cite>training_config.json</cite>
and <cite>best_model.h5</cite> files for a trained model.</p></li>
<li><p><strong>batch_size</strong> – The default batch size to use when loading data for inference.
Higher values increase inference speed at the cost of higher memory
usage.</p></li>
<li><p><strong>peak_threshold</strong> – Minimum confidence map value to consider a local peak as
valid.</p></li>
<li><p><strong>integral_refinement</strong> – If <cite>True</cite>, peaks will be refined with integral
regression. If <cite>False</cite>, <cite>“local”</cite>, peaks will be refined with quarter
pixel local gradient offset. This has no effect if the model has an
offset regression head.</p></li>
<li><p><strong>integral_patch_size</strong> – Size of patches to crop around each rough peak for
integral refinement as an integer scalar.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An instance of <cite>BottomUpPredictor</cite> with the loaded model.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sleap.nn.inference.CentroidCrop">
<em class="property">class </em><code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">CentroidCrop</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#CentroidCrop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.CentroidCrop" title="Permalink to this definition">¶</a></dt>
<dd><p>Inference layer for applying centroid crop-based models.</p>
<p>This layer encapsulates all of the inference operations requires for generating
predictions from a centroid confidence map model. This includes preprocessing,
model forward pass, peak finding, coordinate adjustment and cropping.</p>
<dl class="py attribute">
<dt id="sleap.nn.inference.CentroidCrop.keras_model">
<code class="sig-name descname">keras_model</code><a class="headerlink" href="#sleap.nn.inference.CentroidCrop.keras_model" title="Permalink to this definition">¶</a></dt>
<dd><p>A <cite>tf.keras.Model</cite> that accepts rank-4 images as input and predicts
rank-4 confidence maps as output. This should be a model that is trained on
centroid/anchor confidence maps.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.CentroidCrop.crop_size">
<code class="sig-name descname">crop_size</code><a class="headerlink" href="#sleap.nn.inference.CentroidCrop.crop_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Integer scalar specifying the height/width of the centered crops.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.CentroidCrop.input_scale">
<code class="sig-name descname">input_scale</code><a class="headerlink" href="#sleap.nn.inference.CentroidCrop.input_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Float indicating if the images should be resized before being
passed to the model.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.CentroidCrop.pad_to_stride">
<code class="sig-name descname">pad_to_stride</code><a class="headerlink" href="#sleap.nn.inference.CentroidCrop.pad_to_stride" title="Permalink to this definition">¶</a></dt>
<dd><p>If not 1, input image will be paded to ensure that it is
divisible by this value (after scaling). This should be set to the max
stride of the model.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.CentroidCrop.output_stride">
<code class="sig-name descname">output_stride</code><a class="headerlink" href="#sleap.nn.inference.CentroidCrop.output_stride" title="Permalink to this definition">¶</a></dt>
<dd><p>Output stride of the model, denoting the scale of the output
confidence maps relative to the images (after input scaling). This is used
for adjusting the peak coordinates to the image grid. This will be inferred
from the model shapes if not provided.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.CentroidCrop.peak_threshold">
<code class="sig-name descname">peak_threshold</code><a class="headerlink" href="#sleap.nn.inference.CentroidCrop.peak_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimum confidence map value to consider a global peak as valid.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.CentroidCrop.refinement">
<code class="sig-name descname">refinement</code><a class="headerlink" href="#sleap.nn.inference.CentroidCrop.refinement" title="Permalink to this definition">¶</a></dt>
<dd><p>If <cite>None</cite>, returns the grid-aligned peaks with no refinement. If
<cite>“integral”</cite>, peaks will be refined with integral regression. If <cite>“local”</cite>,
peaks will be refined with quarter pixel local gradient offset. This has no
effect if the model has an offset regression head.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.CentroidCrop.integral_patch_size">
<code class="sig-name descname">integral_patch_size</code><a class="headerlink" href="#sleap.nn.inference.CentroidCrop.integral_patch_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of patches to crop around each rough peak for integral
refinement as an integer scalar.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.CentroidCrop.return_confmaps">
<code class="sig-name descname">return_confmaps</code><a class="headerlink" href="#sleap.nn.inference.CentroidCrop.return_confmaps" title="Permalink to this definition">¶</a></dt>
<dd><p>If <cite>True</cite>, the confidence maps will be returned together with
the predicted peaks. This will result in slower inference times since the
data must be copied off of the GPU, but is useful for visualizing the raw
output of the model.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.CentroidCrop.confmaps_ind">
<code class="sig-name descname">confmaps_ind</code><a class="headerlink" href="#sleap.nn.inference.CentroidCrop.confmaps_ind" title="Permalink to this definition">¶</a></dt>
<dd><p>Index of the output tensor of the model corresponding to
confidence maps. If <cite>None</cite> (the default), this will be detected
automatically by searching for the first tensor that contains
<cite>“CentroidConfmapsHead”</cite> in its name.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.CentroidCrop.offsets_ind">
<code class="sig-name descname">offsets_ind</code><a class="headerlink" href="#sleap.nn.inference.CentroidCrop.offsets_ind" title="Permalink to this definition">¶</a></dt>
<dd><p>Index of the output tensor of the model corresponding to
offset regression maps. If <cite>None</cite> (the default), this will be detected
automatically by searching for the first tensor that contains
<cite>“OffsetRefinementHead”</cite> in its name. If the head is not present, the method
specified in the <cite>refinement</cite> attribute will be used.</p>
</dd></dl>

<dl class="py method">
<dt id="sleap.nn.inference.CentroidCrop.call">
<code class="sig-name descname">call</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inputs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#CentroidCrop.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.CentroidCrop.call" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict centroid confidence maps and crop around peaks.</p>
<p>This layer can be chained with a <cite>FindInstancePeaks</cite> layer to create a top-down
inference function from full images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inputs</strong> – Full frame images as a <cite>tf.Tensor</cite> of shape
<cite>(samples, height, width, channels)</cite> or a dictionary with key:
<cite>“image”</cite>: Full frame images in the same format as above.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt><cite>“crops”</cite>: Cropped images of shape</dt><dd><p><cite>(samples, ?, crop_size, crop_size, channels)</cite>.</p>
</dd>
<dt><cite>”crop_offsets”</cite>: Coordinates of the top-left of the crops as <cite>(x, y)</cite></dt><dd><p>offsets of shape <cite>(samples, ?, 2)</cite> for adjusting the predicted peak
coordinates.</p>
</dd>
</dl>
<p><cite>”centroids”</cite>: The predicted centroids of shape <cite>(samples, ?, 2)</cite>.
<cite>“centroid_vals”: The centroid confidence values of shape `(samples, ?)</cite>.</p>
<p>If the <cite>return_confmaps</cite> attribute is set to <cite>True</cite>, the output will also
contain a key named <cite>“centroid_confmaps”</cite> containing a <cite>tf.RaggedTensor</cite> of
shape <cite>(samples, ?, output_height, output_width, 1)</cite> containing the
confidence maps predicted by the model.</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A dictionary of outputs grouped by sample with keys</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sleap.nn.inference.CentroidCropGroundTruth">
<em class="property">class </em><code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">CentroidCropGroundTruth</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#CentroidCropGroundTruth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.CentroidCropGroundTruth" title="Permalink to this definition">¶</a></dt>
<dd><p>Keras layer that simulates a centroid cropping model using ground truth.</p>
<p>This layer is useful for testing and evaluating centered instance models.</p>
<dl class="py attribute">
<dt id="sleap.nn.inference.CentroidCropGroundTruth.crop_size">
<code class="sig-name descname">crop_size</code><a class="headerlink" href="#sleap.nn.inference.CentroidCropGroundTruth.crop_size" title="Permalink to this definition">¶</a></dt>
<dd><p>The length of the square box to extract around each centroid.</p>
</dd></dl>

<dl class="py method">
<dt id="sleap.nn.inference.CentroidCropGroundTruth.call">
<code class="sig-name descname">call</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">example_gt</span><span class="p">:</span> <span class="n">Dict<span class="p">[</span>str<span class="p">, </span>tensorflow.python.framework.ops.Tensor<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; Dict<span class="p">[</span>str<span class="p">, </span>tensorflow.python.framework.ops.Tensor<span class="p">]</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#CentroidCropGroundTruth.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.CentroidCropGroundTruth.call" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the ground truth instance crops.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>example_gt</strong> – <p>Dictionary generated from a labels pipeline with the keys:
<cite>“image”: (batch_size, height, width, channels)</cite>
<cite>“centroids”: (batch_size, n_centroids, 2)</cite>: The input centroids.</p>
<blockquote>
<div><p>Axis 1 is expected to be ragged.</p>
</div></blockquote>
<p>These can be generated by the <cite>InstanceCentroidFinder</cite> transformer.</p>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><cite>“crops”: (batch_size, n_centroids, crop_size, crop_size, channels)</cite>
<cite>“crop_offsets”: (batch_size, n_centroids, crop_size, crop_size, channels)</cite></p>
<blockquote>
<div><p>These contain the top-left coordinates of each crop in the full images.</p>
</div></blockquote>
<p><cite>”centroids”: (batch_size, n_centroids, 2)</cite>
<cite>“centroid_vals”: (batch_size, n_centroids)</cite></p>
<p>Axis 1 of all keys are expected to be ragged.</p>
<p><cite>”centroids”</cite> are from the input example and <cite>“centroid_vals”</cite> will be
filled with ones.</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Dictionary containing the output of the instance cropping layer with keys</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sleap.nn.inference.FindInstancePeaks">
<em class="property">class </em><code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">FindInstancePeaks</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#FindInstancePeaks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.FindInstancePeaks" title="Permalink to this definition">¶</a></dt>
<dd><p>Keras layer that predicts instance peaks from images using a trained model.</p>
<p>This layer encapsulates all of the inference operations required for generating
predictions from a centered instance confidence map model. This includes
preprocessing, model forward pass, peak finding and coordinate adjustment.</p>
<dl class="py attribute">
<dt id="sleap.nn.inference.FindInstancePeaks.keras_model">
<code class="sig-name descname">keras_model</code><a class="headerlink" href="#sleap.nn.inference.FindInstancePeaks.keras_model" title="Permalink to this definition">¶</a></dt>
<dd><p>A <cite>tf.keras.Model</cite> that accepts rank-4 images as input and predicts
rank-4 confidence maps as output. This should be a model that is trained on
centered instance confidence maps.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.FindInstancePeaks.input_scale">
<code class="sig-name descname">input_scale</code><a class="headerlink" href="#sleap.nn.inference.FindInstancePeaks.input_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Float indicating if the images should be resized before being
passed to the model.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.FindInstancePeaks.output_stride">
<code class="sig-name descname">output_stride</code><a class="headerlink" href="#sleap.nn.inference.FindInstancePeaks.output_stride" title="Permalink to this definition">¶</a></dt>
<dd><p>Output stride of the model, denoting the scale of the output
confidence maps relative to the images (after input scaling). This is used
for adjusting the peak coordinates to the image grid. This will be inferred
from the model shapes if not provided.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.FindInstancePeaks.peak_threshold">
<code class="sig-name descname">peak_threshold</code><a class="headerlink" href="#sleap.nn.inference.FindInstancePeaks.peak_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimum confidence map value to consider a global peak as valid.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.FindInstancePeaks.refinement">
<code class="sig-name descname">refinement</code><a class="headerlink" href="#sleap.nn.inference.FindInstancePeaks.refinement" title="Permalink to this definition">¶</a></dt>
<dd><p>If <cite>None</cite>, returns the grid-aligned peaks with no refinement. If
<cite>“integral”</cite>, peaks will be refined with integral regression. If <cite>“local”</cite>,
peaks will be refined with quarter pixel local gradient offset. This has no
effect if the model has an offset regression head.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.FindInstancePeaks.integral_patch_size">
<code class="sig-name descname">integral_patch_size</code><a class="headerlink" href="#sleap.nn.inference.FindInstancePeaks.integral_patch_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of patches to crop around each rough peak for integral
refinement as an integer scalar.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.FindInstancePeaks.return_confmaps">
<code class="sig-name descname">return_confmaps</code><a class="headerlink" href="#sleap.nn.inference.FindInstancePeaks.return_confmaps" title="Permalink to this definition">¶</a></dt>
<dd><p>If <cite>True</cite>, the confidence maps will be returned together with
the predicted peaks. This will result in slower inference times since the
data must be copied off of the GPU, but is useful for visualizing the raw
output of the model.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.FindInstancePeaks.confmaps_ind">
<code class="sig-name descname">confmaps_ind</code><a class="headerlink" href="#sleap.nn.inference.FindInstancePeaks.confmaps_ind" title="Permalink to this definition">¶</a></dt>
<dd><p>Index of the output tensor of the model corresponding to
confidence maps. If <cite>None</cite> (the default), this will be detected
automatically by searching for the first tensor that contains
<cite>“CenteredInstanceConfmapsHead”</cite> in its name.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.FindInstancePeaks.offsets_ind">
<code class="sig-name descname">offsets_ind</code><a class="headerlink" href="#sleap.nn.inference.FindInstancePeaks.offsets_ind" title="Permalink to this definition">¶</a></dt>
<dd><p>Index of the output tensor of the model corresponding to
offset regression maps. If <cite>None</cite> (the default), this will be detected
automatically by searching for the first tensor that contains
<cite>“OffsetRefinementHead”</cite> in its name. If the head is not present, the method
specified in the <cite>refinement</cite> attribute will be used.</p>
</dd></dl>

<dl class="py method">
<dt id="sleap.nn.inference.FindInstancePeaks.call">
<code class="sig-name descname">call</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inputs</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>Dict<span class="p">[</span>str<span class="p">, </span>tensorflow.python.framework.ops.Tensor<span class="p">]</span><span class="p">, </span>tensorflow.python.framework.ops.Tensor<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; Dict<span class="p">[</span>str<span class="p">, </span>tensorflow.python.framework.ops.Tensor<span class="p">]</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#FindInstancePeaks.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.FindInstancePeaks.call" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict confidence maps and infer peak coordinates.</p>
<p>This layer can be chained with a <cite>CentroidCrop</cite> layer to create a top-down
inference function from full images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inputs</strong> – <p>Instance-centered images as a <cite>tf.Tensor</cite> of shape
<cite>(samples, height, width, channels)</cite> or <cite>tf.RaggedTensor</cite> of shape
<cite>(samples, ?, height, width, channels)</cite> where images are grouped by
sample and may contain a variable number of crops, or a dictionary with
keys:
<cite>“crops”</cite>: Cropped images in either format above.
<cite>“crop_offsets”</cite>: (Optional) Coordinates of the top-left of the crops as</p>
<blockquote>
<div><p><cite>(x, y)</cite> offsets of shape <cite>(samples, ?, 2)</cite> for adjusting the
predicted peak coordinates. No adjustment is performed if not
provided.</p>
</div></blockquote>
<dl class="simple">
<dt><cite>”centroids”</cite>: (Optional) If provided, will be passed through to the</dt><dd><p>output.</p>
</dd>
<dt><cite>”centroid_vals”</cite>: (Optional) If provided, will be passed through to the</dt><dd><p>output.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt><cite>“instance_peaks”</cite>: The predicted peaks for each instance in the batch as a</dt><dd><p><cite>tf.RaggedTensor</cite> of shape <cite>(samples, ?, nodes, 2)</cite>.</p>
</dd>
<dt><cite>”instance_peak_vals”</cite>: The value of the confidence maps at the predicted</dt><dd><p>peaks for each instance in the batch as a <cite>tf.RaggedTensor</cite> of shape
<cite>(samples, ?, nodes)</cite>.</p>
</dd>
</dl>
<p>If provided (e.g., from an input <cite>CentroidCrop</cite> layer), the centroids that
generated the crops will also be included in the keys <cite>“centroids”</cite> and
<cite>“centroid_vals”</cite>.</p>
<p>If the <cite>return_confmaps</cite> attribute is set to <cite>True</cite>, the output will also
contain a key named <cite>“instance_confmaps”</cite> containing a <cite>tf.RaggedTensor</cite> of
shape <cite>(samples, ?, output_height, output_width, nodes)</cite> containing the
confidence maps predicted by the model.</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A dictionary of outputs with keys</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sleap.nn.inference.FindInstancePeaksGroundTruth">
<em class="property">class </em><code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">FindInstancePeaksGroundTruth</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#FindInstancePeaksGroundTruth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.FindInstancePeaksGroundTruth" title="Permalink to this definition">¶</a></dt>
<dd><p>Keras layer that simulates a centered instance peaks model.</p>
<p>This layer is useful for testing and evaluating centroid models.</p>
<dl class="py method">
<dt id="sleap.nn.inference.FindInstancePeaksGroundTruth.call">
<code class="sig-name descname">call</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">example_gt</span><span class="p">:</span> <span class="n">Dict<span class="p">[</span>str<span class="p">, </span>tensorflow.python.framework.ops.Tensor<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">crop_output</span><span class="p">:</span> <span class="n">Dict<span class="p">[</span>str<span class="p">, </span>tensorflow.python.framework.ops.Tensor<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; Dict<span class="p">[</span>str<span class="p">, </span>tensorflow.python.framework.ops.Tensor<span class="p">]</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#FindInstancePeaksGroundTruth.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.FindInstancePeaksGroundTruth.call" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the ground truth instance peaks given a set of crops.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>example_gt</strong> – <p>Dictionary generated from a labels pipeline with the key:
<cite>“instances”: (batch_size, n_instances_gt, n_nodes, 2)</cite></p>
<blockquote>
<div><p>Axes 1 and 2 are expected to be ragged dimensions.</p>
</div></blockquote>
</p></li>
<li><p><strong>crop_output</strong> – <p>Dictionary containing the output of the instance cropping layer
with keys:
<cite>“centroids”: (batch_size, n_centroids, 2)</cite>,
<cite>“centroid_vals”: (batch_size, n_centroids)</cite></p>
<blockquote>
<div><p>Axis 1 of both keys are expected to be ragged.</p>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>A dictionary with the instance peaks for each frame. The peaks are just the
ground truth instances matched to the crop output centroids via greedy
matching of the closest node point to each centroid.</p>
<dl>
<dt>The output will have keys:</dt><dd><p><cite>”centroids”: (batch_size, n_centroids, 2)</cite>: The input centroids.
<cite>“centroid_vals”: (batch_size, n_centroids)</cite>: The input centroid</p>
<blockquote>
<div><p>confidence values.</p>
</div></blockquote>
<dl class="simple">
<dt><cite>”instance_peaks”: (batch_size, n_centroids, n_nodes, 2)</cite>: The matched</dt><dd><p>instances.</p>
</dd>
<dt><cite>”instance_peak_vals”: (batch_size, n_centroids, n_nodes)</cite>: Peak</dt><dd><p>confidence values (all 1.0).</p>
</dd>
</dl>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sleap.nn.inference.InferenceLayer">
<em class="property">class </em><code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">InferenceLayer</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#InferenceLayer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.InferenceLayer" title="Permalink to this definition">¶</a></dt>
<dd><p>Base layer for wrapping a Keras model into a layer with preprocessing.</p>
<p>This layer is useful for wrapping input preprocessing operations that would
otherwise be handled by a separate pipeline.</p>
<p>This layer expects the same input as the model (rank-4 image) and automatically
converts the input to a float if it is in integer form. This can help improve
performance by enabling inference directly on <cite>uint8</cite> inputs.</p>
<p>The <cite>call()</cite> method can be overloaded to create custom inference routines that
take advantage of the <cite>preprocess()</cite> method.</p>
<dl class="py attribute">
<dt id="sleap.nn.inference.InferenceLayer.keras_model">
<code class="sig-name descname">keras_model</code><a class="headerlink" href="#sleap.nn.inference.InferenceLayer.keras_model" title="Permalink to this definition">¶</a></dt>
<dd><p>A <cite>tf.keras.Model</cite> that will be called on the input to this layer.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.InferenceLayer.input_scale">
<code class="sig-name descname">input_scale</code><a class="headerlink" href="#sleap.nn.inference.InferenceLayer.input_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>If not 1.0, input image will be resized by this factor.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.InferenceLayer.pad_to_stride">
<code class="sig-name descname">pad_to_stride</code><a class="headerlink" href="#sleap.nn.inference.InferenceLayer.pad_to_stride" title="Permalink to this definition">¶</a></dt>
<dd><p>If not 1, input image will be paded to ensure that it is
divisible by this value (after scaling).</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.InferenceLayer.ensure_grayscale">
<code class="sig-name descname">ensure_grayscale</code><a class="headerlink" href="#sleap.nn.inference.InferenceLayer.ensure_grayscale" title="Permalink to this definition">¶</a></dt>
<dd><p>If <cite>True</cite>, converts inputs to grayscale if not already. If
<cite>False</cite>, converts inputs to RGB if not already. If <cite>None</cite> (default), infer
from the shape of the input layer of the model.</p>
</dd></dl>

<dl class="py method">
<dt id="sleap.nn.inference.InferenceLayer.call">
<code class="sig-name descname">call</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span><span class="p">:</span> <span class="n">tensorflow.python.framework.ops.Tensor</span></em><span class="sig-paren">)</span> &#x2192; tensorflow.python.framework.ops.Tensor<a class="reference internal" href="../_modules/sleap/nn/inference.html#InferenceLayer.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.InferenceLayer.call" title="Permalink to this definition">¶</a></dt>
<dd><p>Call the model with preprocessed data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – Inputs to the model.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Output of the model after being called with preprocessing.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sleap.nn.inference.InferenceLayer.preprocess">
<code class="sig-name descname">preprocess</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">imgs</span><span class="p">:</span> <span class="n">tensorflow.python.framework.ops.Tensor</span></em><span class="sig-paren">)</span> &#x2192; tensorflow.python.framework.ops.Tensor<a class="reference internal" href="../_modules/sleap/nn/inference.html#InferenceLayer.preprocess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.InferenceLayer.preprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply all preprocessing operations configured for this layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>imgs</strong> – A batch of images as a tensor.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The input tensor after applying preprocessing operations. The tensor will
always be a <cite>tf.float32</cite>, which will be adjusted to the range <cite>[0, 1]</cite> if it
was previously an integer.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sleap.nn.inference.InferenceModel">
<em class="property">class </em><code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">InferenceModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#InferenceModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.InferenceModel" title="Permalink to this definition">¶</a></dt>
<dd><p>SLEAP inference model base class.</p>
<p>This class wraps the <cite>tf.keras.Model</cite> class to provide SLEAP-specific inference
utilities such as handling different input data types, preprocessing and variable
output shapes.</p>
<dl class="py method">
<dt id="sleap.nn.inference.InferenceModel.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>numpy.ndarray<span class="p">, </span>tensorflow.python.framework.ops.Tensor<span class="p">, </span>Dict<span class="p">[</span>str<span class="p">, </span>tensorflow.python.framework.ops.Tensor<span class="p">]</span><span class="p">, </span>tensorflow.python.data.ops.dataset_ops.DatasetV2<span class="p">, </span><a class="reference internal" href="sleap.nn.data.pipelines.html#sleap.nn.data.pipelines.Pipeline" title="sleap.nn.data.pipelines.Pipeline">sleap.nn.data.pipelines.Pipeline</a><span class="p">, </span><a class="reference internal" href="sleap.io.video.html#sleap.io.video.Video" title="sleap.io.video.Video">sleap.io.video.Video</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">numpy</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span> &#x2192; Union<span class="p">[</span>Dict<span class="p">[</span>str<span class="p">, </span>numpy.ndarray<span class="p">]</span><span class="p">, </span>Dict<span class="p">[</span>str<span class="p">, </span>Union<span class="p">[</span>tensorflow.python.framework.ops.Tensor<span class="p">, </span>tensorflow.python.ops.ragged.ragged_tensor.RaggedTensor<span class="p">]</span><span class="p">]</span><span class="p">]</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#InferenceModel.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.InferenceModel.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict instances in the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – <p>Input data in any form. Possible types:
- <cite>np.ndarray</cite>, <cite>tf.Tensor</cite>: Images of shape</p>
<blockquote>
<div><p><cite>(samples, height, width, channels)</cite></p>
</div></blockquote>
<ul>
<li><p><cite>dict</cite> with key <cite>“image”</cite> as a tensor</p></li>
<li><p><cite>tf.data.Dataset</cite> that generates examples in one of the above formats.</p></li>
<li><p><cite>sleap.Pipeline</cite> that generates examples in one of the above formats.</p></li>
<li><dl class="simple">
<dt><cite>sleap.Video</cite> which will be converted into a pipeline that generates</dt><dd><p>batches of <cite>batch_size</cite> frames.</p>
</dd>
</dl>
</li>
</ul>
</p></li>
<li><p><strong>numpy</strong> – If <cite>True</cite> (default), returned values will be converted to
<a href="#id5"><span class="problematic" id="id6">`</span></a>np.ndarray`s or Python primitives if scalars.</p></li>
<li><p><strong>batch_size</strong> – Batch size to use for inference. No effect if using a dataset or
pipeline as input since those are expected to generate batches.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>The model outputs as a dictionary of (potentially ragged) tensors or numpy
arrays if <cite>numpy</cite> is <cite>True</cite>.</p>
<p>If <cite>numpy</cite> is <cite>False</cite>, values of the dictionary may be <a href="#id7"><span class="problematic" id="id8">`</span></a>tf.RaggedTensor`s
with the same length for axis 0 (samples), but variable length axis 1
(instances).</p>
<p>If <cite>numpy</cite> is <cite>True</cite> and the output contained ragged tensors, they will be
NaN-padded to the bounding shape and an additional key <cite>“n_valid”</cite> will be
included to indicate the number of valid elements (before padding) in axis
1 of the tensors.</p>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sleap.nn.inference.Predictor">
<em class="property">class </em><code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">Predictor</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">verbosity</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'rich'</span></em>, <em class="sig-param"><span class="n">report_rate</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">2.0</span></em>, <em class="sig-param"><span class="n">model_paths</span><span class="p">:</span> <span class="n">List<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">NOTHING</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#Predictor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.Predictor" title="Permalink to this definition">¶</a></dt>
<dd><p>Base interface class for predictors.</p>
<dl class="py method">
<dt id="sleap.nn.inference.Predictor.from_model_paths">
<em class="property">classmethod </em><code class="sig-name descname">from_model_paths</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model_paths</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>str<span class="p">, </span>List<span class="p">[</span>str<span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">peak_threshold</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.2</span></em>, <em class="sig-param"><span class="n">integral_refinement</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">integral_patch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#sleap.nn.inference.Predictor" title="sleap.nn.inference.Predictor">sleap.nn.inference.Predictor</a><a class="reference internal" href="../_modules/sleap/nn/inference.html#Predictor.from_model_paths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.Predictor.from_model_paths" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the appropriate <cite>Predictor</cite> subclass from a list of model paths.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_paths</strong> – A single or list of trained model paths.</p></li>
<li><p><strong>peak_threshold</strong> – Minimum confidence map value to consider a peak as valid.</p></li>
<li><p><strong>integral_refinement</strong> – If <cite>True</cite>, peaks will be refined with integral
regression. If <cite>False</cite>, <cite>“local”</cite>, peaks will be refined with quarter
pixel local gradient offset. This has no effect if the model has an
offset regression head.</p></li>
<li><p><strong>integral_patch_size</strong> – Size of patches to crop around each rough peak for
integral refinement as an integer scalar.</p></li>
<li><p><strong>batch_size</strong> – The default batch size to use when loading data for inference.
Higher values increase inference speed at the cost of higher memory
usage.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A subclass of <cite>Predictor</cite>.</p>
</dd>
</dl>
<p>See also: <cite>SingleInstancePredictor</cite>, <cite>TopDownPredictor</cite>, <cite>BottomUpPredictor</cite></p>
</dd></dl>

<dl class="py method">
<dt id="sleap.nn.inference.Predictor.make_pipeline">
<code class="sig-name descname">make_pipeline</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_provider</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Provider<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="sleap.nn.data.pipelines.html#sleap.nn.data.pipelines.Pipeline" title="sleap.nn.data.pipelines.Pipeline">sleap.nn.data.pipelines.Pipeline</a><a class="reference internal" href="../_modules/sleap/nn/inference.html#Predictor.make_pipeline"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.Predictor.make_pipeline" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a data loading pipeline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data_provider</strong> – If not <cite>None</cite>, the pipeline will be created with an instance
of a <cite>sleap.pipelines.Provider</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The created <cite>sleap.pipelines.Pipeline</cite> with batching and prefetching.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method also updates the class attribute for the pipeline and will be
called automatically when predicting on data from a new source.</p>
</dd></dl>

<dl class="py method">
<dt id="sleap.nn.inference.Predictor.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>Provider<span class="p">, </span><a class="reference internal" href="sleap.io.dataset.html#sleap.io.dataset.Labels" title="sleap.io.dataset.Labels">sleap.io.dataset.Labels</a><span class="p">, </span><a class="reference internal" href="sleap.io.video.html#sleap.io.video.Video" title="sleap.io.video.Video">sleap.io.video.Video</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">make_labels</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span> &#x2192; Union<span class="p">[</span>List<span class="p">[</span>Dict<span class="p">[</span>str<span class="p">, </span>numpy.ndarray<span class="p">]</span><span class="p">]</span><span class="p">, </span><a class="reference internal" href="sleap.io.dataset.html#sleap.io.dataset.Labels" title="sleap.io.dataset.Labels">sleap.io.dataset.Labels</a><span class="p">]</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#Predictor.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.Predictor.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Run inference on a data source.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – A <cite>sleap.pipelines.Provider</cite>, <cite>sleap.Labels</cite> or <cite>sleap.Video</cite> to
run inference over.</p></li>
<li><p><strong>make_labels</strong> – If <cite>True</cite> (the default), returns a <cite>sleap.Labels</cite> instance with
<cite>sleap.PredictedInstance`s. If `False</cite>, just return a list of
dictionaries containing the raw arrays returned by the inference model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <cite>sleap.Labels</cite> with <cite>sleap.PredictedInstance`s if `make_labels</cite> is <cite>True</cite>,
otherwise a list of dictionaries containing batches of numpy arrays with the
raw results.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sleap.nn.inference.Predictor.report_period">
<em class="property">property </em><code class="sig-name descname">report_period</code><a class="headerlink" href="#sleap.nn.inference.Predictor.report_period" title="Permalink to this definition">¶</a></dt>
<dd><p>Time between progress reports in seconds.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sleap.nn.inference.RateColumn">
<em class="property">class </em><code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">RateColumn</code><a class="reference internal" href="../_modules/sleap/nn/inference.html#RateColumn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.RateColumn" title="Permalink to this definition">¶</a></dt>
<dd><p>Renders the progress rate.</p>
<dl class="py method">
<dt id="sleap.nn.inference.RateColumn.render">
<code class="sig-name descname">render</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">task</span><span class="p">:</span> <span class="n">Task</span></em><span class="sig-paren">)</span> &#x2192; rich.text.Text<a class="reference internal" href="../_modules/sleap/nn/inference.html#RateColumn.render"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.RateColumn.render" title="Permalink to this definition">¶</a></dt>
<dd><p>Show progress rate.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sleap.nn.inference.SingleInstanceInferenceLayer">
<em class="property">class </em><code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">SingleInstanceInferenceLayer</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#SingleInstanceInferenceLayer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.SingleInstanceInferenceLayer" title="Permalink to this definition">¶</a></dt>
<dd><p>Inference layer for applying single instance models.</p>
<p>This layer encapsulates all of the inference operations requires for generating
predictions from a single instance confidence map model. This includes
preprocessing, model forward pass, peak finding and coordinate adjustment.</p>
<dl class="py attribute">
<dt id="sleap.nn.inference.SingleInstanceInferenceLayer.keras_model">
<code class="sig-name descname">keras_model</code><a class="headerlink" href="#sleap.nn.inference.SingleInstanceInferenceLayer.keras_model" title="Permalink to this definition">¶</a></dt>
<dd><p>A <cite>tf.keras.Model</cite> that accepts rank-4 images as input and predicts
rank-4 confidence maps as output. This should be a model that is trained on
single instance confidence maps.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.SingleInstanceInferenceLayer.input_scale">
<code class="sig-name descname">input_scale</code><a class="headerlink" href="#sleap.nn.inference.SingleInstanceInferenceLayer.input_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Float indicating if the images should be resized before being
passed to the model.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.SingleInstanceInferenceLayer.pad_to_stride">
<code class="sig-name descname">pad_to_stride</code><a class="headerlink" href="#sleap.nn.inference.SingleInstanceInferenceLayer.pad_to_stride" title="Permalink to this definition">¶</a></dt>
<dd><p>If not 1, input image will be paded to ensure that it is
divisible by this value (after scaling). This should be set to the max
stride of the model.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.SingleInstanceInferenceLayer.output_stride">
<code class="sig-name descname">output_stride</code><a class="headerlink" href="#sleap.nn.inference.SingleInstanceInferenceLayer.output_stride" title="Permalink to this definition">¶</a></dt>
<dd><p>Output stride of the model, denoting the scale of the output
confidence maps relative to the images (after input scaling). This is used
for adjusting the peak coordinates to the image grid. This will be inferred
from the model shapes if not provided.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.SingleInstanceInferenceLayer.peak_threshold">
<code class="sig-name descname">peak_threshold</code><a class="headerlink" href="#sleap.nn.inference.SingleInstanceInferenceLayer.peak_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimum confidence map value to consider a global peak as valid.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.SingleInstanceInferenceLayer.refinement">
<code class="sig-name descname">refinement</code><a class="headerlink" href="#sleap.nn.inference.SingleInstanceInferenceLayer.refinement" title="Permalink to this definition">¶</a></dt>
<dd><p>If <cite>None</cite>, returns the grid-aligned peaks with no refinement. If
<cite>“integral”</cite>, peaks will be refined with integral regression. If <cite>“local”</cite>,
peaks will be refined with quarter pixel local gradient offset. This has no
effect if the model has an offset regression head.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.SingleInstanceInferenceLayer.integral_patch_size">
<code class="sig-name descname">integral_patch_size</code><a class="headerlink" href="#sleap.nn.inference.SingleInstanceInferenceLayer.integral_patch_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of patches to crop around each rough peak for integral
refinement as an integer scalar.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.SingleInstanceInferenceLayer.return_confmaps">
<code class="sig-name descname">return_confmaps</code><a class="headerlink" href="#sleap.nn.inference.SingleInstanceInferenceLayer.return_confmaps" title="Permalink to this definition">¶</a></dt>
<dd><p>If <cite>True</cite>, the confidence maps will be returned together with
the predicted peaks. This will result in slower inference times since the
data must be copied off of the GPU, but is useful for visualizing the raw
output of the model.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.SingleInstanceInferenceLayer.confmaps_ind">
<code class="sig-name descname">confmaps_ind</code><a class="headerlink" href="#sleap.nn.inference.SingleInstanceInferenceLayer.confmaps_ind" title="Permalink to this definition">¶</a></dt>
<dd><p>Index of the output tensor of the model corresponding to
confidence maps. If <cite>None</cite> (the default), this will be detected
automatically by searching for the first tensor that contains
<cite>“SingleInstanceConfmapsHead”</cite> in its name.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.SingleInstanceInferenceLayer.offsets_ind">
<code class="sig-name descname">offsets_ind</code><a class="headerlink" href="#sleap.nn.inference.SingleInstanceInferenceLayer.offsets_ind" title="Permalink to this definition">¶</a></dt>
<dd><p>Index of the output tensor of the model corresponding to
offset regression maps. If <cite>None</cite> (the default), this will be detected
automatically by searching for the first tensor that contains
<cite>“OffsetRefinementHead”</cite> in its name. If the head is not present, the method
specified in the <cite>refinement</cite> attribute will be used.</p>
</dd></dl>

<dl class="py method">
<dt id="sleap.nn.inference.SingleInstanceInferenceLayer.call">
<code class="sig-name descname">call</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#SingleInstanceInferenceLayer.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.SingleInstanceInferenceLayer.call" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict instance confidence maps and find peaks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inputs</strong> – Full frame images as a <cite>tf.Tensor</cite> of shape
<cite>(samples, height, width, channels)</cite> or a dictionary with key:
<cite>“image”</cite>: Full frame images in the same format as above.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><cite>“peaks”</cite>: The predicted peaks of shape <cite>(samples, nodes, 2)</cite>.
<cite>“peak_vals”: The peak confidence values of shape `(samples, nodes)</cite>.</p>
<p>If the <cite>return_confmaps</cite> attribute is set to <cite>True</cite>, the output will also
contain a key named <cite>“confmaps”</cite> containing a <cite>tf.Tensor</cite> of shape
<cite>(samples, output_height, output_width, 1)</cite> containing the confidence maps
predicted by the model.</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A dictionary of outputs grouped by sample with keys</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sleap.nn.inference.SingleInstanceInferenceModel">
<em class="property">class </em><code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">SingleInstanceInferenceModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#SingleInstanceInferenceModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.SingleInstanceInferenceModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Single instance prediction model.</p>
<p>This model encapsulates the basic single instance approach where it is assumed that
there is only one instance in the frame. The images are passed to a peak detector
which is trained to detect all body parts for the instance assuming a single peak
per body part.</p>
<dl class="py attribute">
<dt id="sleap.nn.inference.SingleInstanceInferenceModel.single_instance_layer">
<code class="sig-name descname">single_instance_layer</code><a class="headerlink" href="#sleap.nn.inference.SingleInstanceInferenceModel.single_instance_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>A single instance instance peak detection layer. This
layer takes as input full images and outputs the detected peaks.</p>
</dd></dl>

<dl class="py method">
<dt id="sleap.nn.inference.SingleInstanceInferenceModel.call">
<code class="sig-name descname">call</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">example</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#SingleInstanceInferenceModel.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.SingleInstanceInferenceModel.call" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict instances for one batch of images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>example</strong> – This may be either a single batch of images as a 4-D tensor of
shape <cite>(batch_size, height, width, channels)</cite>, or a dictionary
containing the image batch in the <cite>“images”</cite> key.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><cite>“peaks”: (batch_size, n_nodes, 2)</cite>: Instance skeleton points.
<cite>“peak_vals”: (batch_size, n_instances, n_nodes)</cite>: Confidence values for the</p>
<blockquote>
<div><p>instance skeleton points.</p>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>The predicted instances as a dictionary of tensors with keys</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sleap.nn.inference.SingleInstancePredictor">
<em class="property">class </em><code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">SingleInstancePredictor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">confmap_config</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sleap.nn.config.training_job.html#sleap.nn.config.training_job.TrainingJobConfig" title="sleap.nn.config.training_job.TrainingJobConfig">sleap.nn.config.training_job.TrainingJobConfig</a></span></em>, <em class="sig-param"><span class="n">confmap_model</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sleap.nn.model.html#sleap.nn.model.Model" title="sleap.nn.model.Model">sleap.nn.model.Model</a></span></em>, <em class="sig-param"><span class="n">inference_model</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="#sleap.nn.inference.SingleInstanceInferenceModel" title="sleap.nn.inference.SingleInstanceInferenceModel">sleap.nn.inference.SingleInstanceInferenceModel</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">peak_threshold</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.2</span></em>, <em class="sig-param"><span class="n">integral_refinement</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">integral_patch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">verbosity</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'rich'</span></em>, <em class="sig-param"><span class="n">report_rate</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">2.0</span></em>, <em class="sig-param"><span class="n">model_paths</span><span class="p">:</span> <span class="n">List<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">NOTHING</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#SingleInstancePredictor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.SingleInstancePredictor" title="Permalink to this definition">¶</a></dt>
<dd><p>Single instance predictor.</p>
<p>This high-level class handles initialization, preprocessing and tracking using a
trained single instance SLEAP model.</p>
<p>This should be initialized using the <cite>from_trained_models()</cite> constructor or the
high-level API (<cite>sleap.load_model</cite>).</p>
<dl class="py attribute">
<dt id="sleap.nn.inference.SingleInstancePredictor.confmap_config">
<code class="sig-name descname">confmap_config</code><a class="headerlink" href="#sleap.nn.inference.SingleInstancePredictor.confmap_config" title="Permalink to this definition">¶</a></dt>
<dd><p>The <cite>sleap.nn.config.TrainingJobConfig</cite> containing the metadata
for the trained model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="sleap.nn.config.training_job.html#sleap.nn.config.training_job.TrainingJobConfig" title="sleap.nn.config.training_job.TrainingJobConfig">sleap.nn.config.training_job.TrainingJobConfig</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.SingleInstancePredictor.confmap_model">
<code class="sig-name descname">confmap_model</code><a class="headerlink" href="#sleap.nn.inference.SingleInstancePredictor.confmap_model" title="Permalink to this definition">¶</a></dt>
<dd><p>A <cite>sleap.nn.model.Model</cite> instance created from the trained model.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="sleap.nn.model.html#sleap.nn.model.Model" title="sleap.nn.model.Model">sleap.nn.model.Model</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.SingleInstancePredictor.inference_model">
<code class="sig-name descname">inference_model</code><a class="headerlink" href="#sleap.nn.inference.SingleInstancePredictor.inference_model" title="Permalink to this definition">¶</a></dt>
<dd><p>A <cite>sleap.nn.inference.SingleInstanceInferenceModel</cite> that wraps
a trained <cite>tf.keras.Model</cite> to implement preprocessing and peak finding.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[<a class="reference internal" href="#sleap.nn.inference.SingleInstanceInferenceModel" title="sleap.nn.inference.SingleInstanceInferenceModel">sleap.nn.inference.SingleInstanceInferenceModel</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.SingleInstancePredictor.pipeline">
<code class="sig-name descname">pipeline</code><a class="headerlink" href="#sleap.nn.inference.SingleInstancePredictor.pipeline" title="Permalink to this definition">¶</a></dt>
<dd><p>A <cite>sleap.nn.data.Pipeline</cite> that loads the data and batches input data.
This will be updated dynamically if new data sources are used.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[<a class="reference internal" href="sleap.nn.data.pipelines.html#sleap.nn.data.pipelines.Pipeline" title="sleap.nn.data.pipelines.Pipeline">sleap.nn.data.pipelines.Pipeline</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.SingleInstancePredictor.peak_threshold">
<code class="sig-name descname">peak_threshold</code><a class="headerlink" href="#sleap.nn.inference.SingleInstancePredictor.peak_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimum confidence map value to consider a global peak as valid.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.SingleInstancePredictor.integral_refinement">
<code class="sig-name descname">integral_refinement</code><a class="headerlink" href="#sleap.nn.inference.SingleInstancePredictor.integral_refinement" title="Permalink to this definition">¶</a></dt>
<dd><p>If <cite>True</cite>, peaks will be refined with integral regression.
If <cite>False</cite>, <cite>“local”</cite>, peaks will be refined with quarter pixel local
gradient offset. This has no effect if the model has an offset regression
head.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.SingleInstancePredictor.integral_patch_size">
<code class="sig-name descname">integral_patch_size</code><a class="headerlink" href="#sleap.nn.inference.SingleInstancePredictor.integral_patch_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of patches to crop around each rough peak for integral
refinement as an integer scalar.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.SingleInstancePredictor.batch_size">
<code class="sig-name descname">batch_size</code><a class="headerlink" href="#sleap.nn.inference.SingleInstancePredictor.batch_size" title="Permalink to this definition">¶</a></dt>
<dd><p>The default batch size to use when loading data for inference.
Higher values increase inference speed at the cost of higher memory usage.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sleap.nn.inference.SingleInstancePredictor.from_trained_models">
<em class="property">classmethod </em><code class="sig-name descname">from_trained_models</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model_path</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">peak_threshold</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.2</span></em>, <em class="sig-param"><span class="n">integral_refinement</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">integral_patch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#sleap.nn.inference.SingleInstancePredictor" title="sleap.nn.inference.SingleInstancePredictor">sleap.nn.inference.SingleInstancePredictor</a><a class="reference internal" href="../_modules/sleap/nn/inference.html#SingleInstancePredictor.from_trained_models"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.SingleInstancePredictor.from_trained_models" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the predictor from a saved model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_path</strong> – Path to a model folder or training job JSON file inside a model
folder. This folder should contain <cite>training_config.json</cite> and
<cite>best_model.h5</cite> files for a trained model.</p></li>
<li><p><strong>peak_threshold</strong> – Minimum confidence map value to consider a global peak as
valid.</p></li>
<li><p><strong>integral_refinement</strong> – If <cite>True</cite>, peaks will be refined with integral
regression. If <cite>False</cite>, <cite>“local”</cite>, peaks will be refined with quarter
pixel local gradient offset. This has no effect if the model has an
offset regression head.</p></li>
<li><p><strong>integral_patch_size</strong> – Size of patches to crop around each rough peak for
integral refinement as an integer scalar.</p></li>
<li><p><strong>batch_size</strong> – The default batch size to use when loading data for inference.
Higher values increase inference speed at the cost of higher memory
usage.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An instance of`SingleInstancePredictor` with the models loaded.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sleap.nn.inference.TopDownInferenceModel">
<em class="property">class </em><code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">TopDownInferenceModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#TopDownInferenceModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.TopDownInferenceModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Top-down instance prediction model.</p>
<p>This model encapsulates the top-down approach where instances are first detected by
local peak detection of an anchor point and then cropped. These instance-centered
crops are then passed to an instance peak detector which is trained to detect all
remaining body parts for the instance that is centered within the crop.</p>
<dl class="py attribute">
<dt id="sleap.nn.inference.TopDownInferenceModel.centroid_crop">
<code class="sig-name descname">centroid_crop</code><a class="headerlink" href="#sleap.nn.inference.TopDownInferenceModel.centroid_crop" title="Permalink to this definition">¶</a></dt>
<dd><p>A centroid cropping layer. This can be either <cite>CentroidCrop</cite> or
<cite>CentroidCropGroundTruth</cite>. This layer takes the full image as input and
outputs a set of centroids and cropped boxes.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.TopDownInferenceModel.instance_peaks">
<code class="sig-name descname">instance_peaks</code><a class="headerlink" href="#sleap.nn.inference.TopDownInferenceModel.instance_peaks" title="Permalink to this definition">¶</a></dt>
<dd><p>A instance peak detection layer. This can be either
<cite>FindInstancePeaks</cite> or <cite>FindInstancePeaksGroundTruth</cite>. This layer takes as
input the output of the centroid cropper and outputs the detected peaks for
the instances within each crop.</p>
</dd></dl>

<dl class="py method">
<dt id="sleap.nn.inference.TopDownInferenceModel.call">
<code class="sig-name descname">call</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">example</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>Dict<span class="p">[</span>str<span class="p">, </span>tensorflow.python.framework.ops.Tensor<span class="p">]</span><span class="p">, </span>tensorflow.python.framework.ops.Tensor<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; Dict<span class="p">[</span>str<span class="p">, </span>tensorflow.python.framework.ops.Tensor<span class="p">]</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#TopDownInferenceModel.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.TopDownInferenceModel.call" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict instances for one batch of images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>example</strong> – This may be either a single batch of images as a 4-D tensor of
shape <cite>(batch_size, height, width, channels)</cite>, or a dictionary
containing the image batch in the <cite>“images”</cite> key. If using a ground
truth model for either centroid cropping or instance peaks, the full
example from a <cite>Pipeline</cite> is required for providing the metadata.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><cite>“centroids”: (batch_size, n_instances, 2)</cite>: Instance centroids.
<cite>“centroid_vals”: (batch_size, n_instances)</cite>: Instance centroid confidence</p>
<blockquote>
<div><p>values.</p>
</div></blockquote>
<dl class="simple">
<dt><cite>”instance_peaks”: (batch_size, n_instances, n_nodes, 2)</cite>: Instance skeleton</dt><dd><p>points.</p>
</dd>
<dt><cite>”instance_peak_vals”: (batch_size, n_instances, n_nodes)</cite>: Confidence</dt><dd><p>values for the instance skeleton points.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>The predicted instances as a dictionary of tensors with keys</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sleap.nn.inference.TopDownPredictor">
<em class="property">class </em><code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">TopDownPredictor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">centroid_config</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="sleap.nn.config.training_job.html#sleap.nn.config.training_job.TrainingJobConfig" title="sleap.nn.config.training_job.TrainingJobConfig">sleap.nn.config.training_job.TrainingJobConfig</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">centroid_model</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="sleap.nn.model.html#sleap.nn.model.Model" title="sleap.nn.model.Model">sleap.nn.model.Model</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">confmap_config</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="sleap.nn.config.training_job.html#sleap.nn.config.training_job.TrainingJobConfig" title="sleap.nn.config.training_job.TrainingJobConfig">sleap.nn.config.training_job.TrainingJobConfig</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">confmap_model</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="sleap.nn.model.html#sleap.nn.model.Model" title="sleap.nn.model.Model">sleap.nn.model.Model</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">inference_model</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="#sleap.nn.inference.TopDownInferenceModel" title="sleap.nn.inference.TopDownInferenceModel">sleap.nn.inference.TopDownInferenceModel</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="n">peak_threshold</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.2</span></em>, <em class="sig-param"><span class="n">integral_refinement</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">integral_patch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em>, <em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">verbosity</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'rich'</span></em>, <em class="sig-param"><span class="n">report_rate</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">2.0</span></em>, <em class="sig-param"><span class="n">model_paths</span><span class="p">:</span> <span class="n">List<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">NOTHING</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#TopDownPredictor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.TopDownPredictor" title="Permalink to this definition">¶</a></dt>
<dd><p>Top-down multi-instance predictor.</p>
<p>This high-level class handles initialization, preprocessing and tracking using a
trained top-down multi-instance SLEAP model.</p>
<p>This should be initialized using the <cite>from_trained_models()</cite> constructor or the
high-level API (<cite>sleap.load_model</cite>).</p>
<dl class="py attribute">
<dt id="sleap.nn.inference.TopDownPredictor.centroid_config">
<code class="sig-name descname">centroid_config</code><a class="headerlink" href="#sleap.nn.inference.TopDownPredictor.centroid_config" title="Permalink to this definition">¶</a></dt>
<dd><p>The <cite>sleap.nn.config.TrainingJobConfig</cite> containing the metadata
for the trained centroid model. If <cite>None</cite>, ground truth centroids will be
used if available from the data source.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[<a class="reference internal" href="sleap.nn.config.training_job.html#sleap.nn.config.training_job.TrainingJobConfig" title="sleap.nn.config.training_job.TrainingJobConfig">sleap.nn.config.training_job.TrainingJobConfig</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.TopDownPredictor.centroid_model">
<code class="sig-name descname">centroid_model</code><a class="headerlink" href="#sleap.nn.inference.TopDownPredictor.centroid_model" title="Permalink to this definition">¶</a></dt>
<dd><p>A <cite>sleap.nn.model.Model</cite> instance created from the trained
centroid model. If <cite>None</cite>, ground truth centroids will be used if available
from the data source.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[<a class="reference internal" href="sleap.nn.model.html#sleap.nn.model.Model" title="sleap.nn.model.Model">sleap.nn.model.Model</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.TopDownPredictor.confmap_config">
<code class="sig-name descname">confmap_config</code><a class="headerlink" href="#sleap.nn.inference.TopDownPredictor.confmap_config" title="Permalink to this definition">¶</a></dt>
<dd><p>The <cite>sleap.nn.config.TrainingJobConfig</cite> containing the metadata
for the trained centered instance model. If <cite>None</cite>, ground truth instances
will be used if available from the data source.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[<a class="reference internal" href="sleap.nn.config.training_job.html#sleap.nn.config.training_job.TrainingJobConfig" title="sleap.nn.config.training_job.TrainingJobConfig">sleap.nn.config.training_job.TrainingJobConfig</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.TopDownPredictor.confmap_model">
<code class="sig-name descname">confmap_model</code><a class="headerlink" href="#sleap.nn.inference.TopDownPredictor.confmap_model" title="Permalink to this definition">¶</a></dt>
<dd><p>A <cite>sleap.nn.model.Model</cite> instance created from the trained
centered-instance model. If <cite>None</cite>, ground truth instances will be used if
available from the data source.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[<a class="reference internal" href="sleap.nn.model.html#sleap.nn.model.Model" title="sleap.nn.model.Model">sleap.nn.model.Model</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.TopDownPredictor.inference_model">
<code class="sig-name descname">inference_model</code><a class="headerlink" href="#sleap.nn.inference.TopDownPredictor.inference_model" title="Permalink to this definition">¶</a></dt>
<dd><p>A <cite>sleap.nn.inference.TopDownInferenceModel</cite> that wraps a
trained <cite>tf.keras.Model</cite> to implement preprocessing, centroid detection,
cropping and peak finding.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[<a class="reference internal" href="#sleap.nn.inference.TopDownInferenceModel" title="sleap.nn.inference.TopDownInferenceModel">sleap.nn.inference.TopDownInferenceModel</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.TopDownPredictor.pipeline">
<code class="sig-name descname">pipeline</code><a class="headerlink" href="#sleap.nn.inference.TopDownPredictor.pipeline" title="Permalink to this definition">¶</a></dt>
<dd><p>A <cite>sleap.nn.data.Pipeline</cite> that loads the data and batches input data.
This will be updated dynamically if new data sources are used.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[<a class="reference internal" href="sleap.nn.data.pipelines.html#sleap.nn.data.pipelines.Pipeline" title="sleap.nn.data.pipelines.Pipeline">sleap.nn.data.pipelines.Pipeline</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.TopDownPredictor.tracker">
<code class="sig-name descname">tracker</code><a class="headerlink" href="#sleap.nn.inference.TopDownPredictor.tracker" title="Permalink to this definition">¶</a></dt>
<dd><p>A <cite>sleap.nn.tracking.Tracker</cite> that will be called to associate
detections over time. Predicted instances will not be assigned to tracks if
if this is <cite>None</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>Optional[<a class="reference internal" href="sleap.nn.tracking.html#sleap.nn.tracking.Tracker" title="sleap.nn.tracking.Tracker">sleap.nn.tracking.Tracker</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.TopDownPredictor.batch_size">
<code class="sig-name descname">batch_size</code><a class="headerlink" href="#sleap.nn.inference.TopDownPredictor.batch_size" title="Permalink to this definition">¶</a></dt>
<dd><p>The default batch size to use when loading data for inference.
Higher values increase inference speed at the cost of higher memory usage.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.TopDownPredictor.peak_threshold">
<code class="sig-name descname">peak_threshold</code><a class="headerlink" href="#sleap.nn.inference.TopDownPredictor.peak_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimum confidence map value to consider a local peak as valid.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.TopDownPredictor.integral_refinement">
<code class="sig-name descname">integral_refinement</code><a class="headerlink" href="#sleap.nn.inference.TopDownPredictor.integral_refinement" title="Permalink to this definition">¶</a></dt>
<dd><p>If <cite>True</cite>, peaks will be refined with integral regression.
If <cite>False</cite>, <cite>“local”</cite>, peaks will be refined with quarter pixel local
gradient offset. This has no effect if the model has an offset regression
head.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.TopDownPredictor.integral_patch_size">
<code class="sig-name descname">integral_patch_size</code><a class="headerlink" href="#sleap.nn.inference.TopDownPredictor.integral_patch_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of patches to crop around each rough peak for integral
refinement as an integer scalar.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sleap.nn.inference.TopDownPredictor.from_trained_models">
<em class="property">classmethod </em><code class="sig-name descname">from_trained_models</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">centroid_model_path</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">confmap_model_path</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="n">peak_threshold</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.2</span></em>, <em class="sig-param"><span class="n">integral_refinement</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">integral_patch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#sleap.nn.inference.TopDownPredictor" title="sleap.nn.inference.TopDownPredictor">sleap.nn.inference.TopDownPredictor</a><a class="reference internal" href="../_modules/sleap/nn/inference.html#TopDownPredictor.from_trained_models"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.TopDownPredictor.from_trained_models" title="Permalink to this definition">¶</a></dt>
<dd><p>Create predictor from saved models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>centroid_model_path</strong> – Path to a centroid model folder or training job JSON
file inside a model folder. This folder should contain
<cite>training_config.json</cite> and <cite>best_model.h5</cite> files for a trained model.</p></li>
<li><p><strong>confmap_model_path</strong> – Path to a centered instance model folder or training job
JSON file inside a model folder. This folder should contain
<cite>training_config.json</cite> and <cite>best_model.h5</cite> files for a trained model.</p></li>
<li><p><strong>batch_size</strong> – The default batch size to use when loading data for inference.
Higher values increase inference speed at the cost of higher memory
usage.</p></li>
<li><p><strong>peak_threshold</strong> – Minimum confidence map value to consider a local peak as
valid.</p></li>
<li><p><strong>integral_refinement</strong> – If <cite>True</cite>, peaks will be refined with integral
regression. If <cite>False</cite>, <cite>“local”</cite>, peaks will be refined with quarter
pixel local gradient offset. This has no effect if the model has an
offset regression head.</p></li>
<li><p><strong>integral_patch_size</strong> – Size of patches to crop around each rough peak for
integral refinement as an integer scalar.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>An instance of <cite>TopDownPredictor</cite> with the loaded models.</p>
<p>One of the two models can be left as <cite>None</cite> to perform inference with ground
truth data. This will only work with <cite>LabelsReader</cite> as the provider.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sleap.nn.inference.TopDownPredictor.make_pipeline">
<code class="sig-name descname">make_pipeline</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_provider</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Provider<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="sleap.nn.data.pipelines.html#sleap.nn.data.pipelines.Pipeline" title="sleap.nn.data.pipelines.Pipeline">sleap.nn.data.pipelines.Pipeline</a><a class="reference internal" href="../_modules/sleap/nn/inference.html#TopDownPredictor.make_pipeline"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.TopDownPredictor.make_pipeline" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a data loading pipeline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data_provider</strong> – If not <cite>None</cite>, the pipeline will be created with an instance
of a <cite>sleap.pipelines.Provider</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The created <cite>sleap.pipelines.Pipeline</cite> with batching and prefetching.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method also updates the class attribute for the pipeline and will be
called automatically when predicting on data from a new source.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sleap.nn.inference.VisualPredictor">
<em class="property">class </em><code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">VisualPredictor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">config</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sleap.nn.config.training_job.html#sleap.nn.config.training_job.TrainingJobConfig" title="sleap.nn.config.training_job.TrainingJobConfig">sleap.nn.config.training_job.TrainingJobConfig</a></span></em>, <em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sleap.nn.model.html#sleap.nn.model.Model" title="sleap.nn.model.Model">sleap.nn.model.Model</a></span></em>, <em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">verbosity</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'rich'</span></em>, <em class="sig-param"><span class="n">report_rate</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">2.0</span></em>, <em class="sig-param"><span class="n">model_paths</span><span class="p">:</span> <span class="n">List<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">NOTHING</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#VisualPredictor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.VisualPredictor" title="Permalink to this definition">¶</a></dt>
<dd><p>Predictor class for generating the visual output of model.</p>
<dl class="py method">
<dt id="sleap.nn.inference.VisualPredictor.make_pipeline">
<code class="sig-name descname">make_pipeline</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#VisualPredictor.make_pipeline"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.VisualPredictor.make_pipeline" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a data loading pipeline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data_provider</strong> – If not <cite>None</cite>, the pipeline will be created with an instance
of a <cite>sleap.pipelines.Provider</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The created <cite>sleap.pipelines.Pipeline</cite> with batching and prefetching.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method also updates the class attribute for the pipeline and will be
called automatically when predicting on data from a new source.</p>
</dd></dl>

<dl class="py method">
<dt id="sleap.nn.inference.VisualPredictor.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_provider</span><span class="p">:</span> <span class="n">Provider</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#VisualPredictor.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.VisualPredictor.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Run inference on a data source.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – A <cite>sleap.pipelines.Provider</cite>, <cite>sleap.Labels</cite> or <cite>sleap.Video</cite> to
run inference over.</p></li>
<li><p><strong>make_labels</strong> – If <cite>True</cite> (the default), returns a <cite>sleap.Labels</cite> instance with
<cite>sleap.PredictedInstance`s. If `False</cite>, just return a list of
dictionaries containing the raw arrays returned by the inference model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <cite>sleap.Labels</cite> with <cite>sleap.PredictedInstance`s if `make_labels</cite> is <cite>True</cite>,
otherwise a list of dictionaries containing batches of numpy arrays with the
raw results.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sleap.nn.inference.VisualPredictor.safely_generate">
<code class="sig-name descname">safely_generate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ds</span><span class="p">:</span> <span class="n">tensorflow.python.data.ops.dataset_ops.DatasetV2</span></em>, <em class="sig-param"><span class="n">progress</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#VisualPredictor.safely_generate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.VisualPredictor.safely_generate" title="Permalink to this definition">¶</a></dt>
<dd><p>Yields examples from dataset, catching and logging exceptions.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="sleap.nn.inference.find_head">
<code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">find_head</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">tensorflow.python.keras.engine.training.Model</span></em>, <em class="sig-param"><span class="n">name</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; Optional<span class="p">[</span>int<span class="p">]</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#find_head"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.find_head" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the index of a head in a model’s outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – A <cite>tf.keras.Model</cite> trained by SLEAP.</p></li>
<li><p><strong>name</strong> – A string that is contained in the model output tensor name.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The index of the first output with a matched name or <cite>None</cite> if none were found.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>SLEAP model heads are named:
- <cite>“SingleInstanceConfmapsHead”</cite>
- <cite>“CentroidConfmapsHead”</cite>
- <cite>“CenteredInstanceConfmapsHead”</cite>
- <cite>“MultiInstanceConfmapsHead”</cite>
- <cite>“PartAffinityFieldsHead”</cite>
- <cite>“OffsetRefinementHead”</cite></p>
</dd></dl>

<dl class="py function">
<dt id="sleap.nn.inference.get_keras_model_path">
<code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">get_keras_model_path</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="../_modules/sleap/nn/inference.html#get_keras_model_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.get_keras_model_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility method for finding the path to a saved Keras model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> – Path to a model run folder or job file.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Path to <cite>best_model.h5</cite> in the run folder.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sleap.nn.inference.get_model_output_stride">
<code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">get_model_output_stride</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">tensorflow.python.keras.engine.training.Model</span></em>, <em class="sig-param"><span class="n">input_ind</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">0</span></em>, <em class="sig-param"><span class="n">output_ind</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">- 1</span></em><span class="sig-paren">)</span> &#x2192; int<a class="reference internal" href="../_modules/sleap/nn/inference.html#get_model_output_stride"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.get_model_output_stride" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the stride (1/scale) of the model outputs relative to the input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – A <cite>tf.keras.Model</cite>.</p></li>
<li><p><strong>input_ind</strong> – The index of the input to use as reference. Defaults to 0, indicating
the first input for multi-output models.</p></li>
<li><p><strong>output_ind</strong> – The index of the output to compute the stride for. Defaults to -1,
indicating the last output for multi-output models.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>The output stride of the model computed as the integer ratio of the input’s
height relative to the output’s height, e.g., for a single input/output model:</p>
<blockquote>
<div><p><cite>model.input.shape[1] // model.output.shape[1]</cite></p>
</div></blockquote>
<p>Raises a warning if the shapes do not divide evenly.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sleap.nn.inference.load_model">
<code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">load_model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model_path</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>str<span class="p">, </span>List<span class="p">[</span>str<span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="n">peak_threshold</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.2</span></em>, <em class="sig-param"><span class="n">refinement</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'integral'</span></em>, <em class="sig-param"><span class="n">tracker</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tracker_window</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em>, <em class="sig-param"><span class="n">tracker_max_instances</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">disable_gpu_preallocation</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">progress_reporting</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'rich'</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#sleap.nn.inference.Predictor" title="sleap.nn.inference.Predictor">sleap.nn.inference.Predictor</a><a class="reference internal" href="../_modules/sleap/nn/inference.html#load_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.load_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a trained SLEAP model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_path</strong> – Path to model or list of path to models that were trained by SLEAP.
These should be the directories that contain <cite>training_job.json</cite> and
<cite>best_model.h5</cite>.</p></li>
<li><p><strong>batch_size</strong> – Number of frames to predict at a time. Larger values result in
faster inference speeds, but require more memory.</p></li>
<li><p><strong>peak_threshold</strong> – Minimum confidence map value to consider a peak as valid.</p></li>
<li><p><strong>refinement</strong> – If <cite>“integral”</cite>, peak locations will be refined with integral
regression. If <cite>“local”</cite>, peaks will be refined with quarter pixel local
gradient offset. This has no effect if the model has an offset regression
head.</p></li>
<li><p><strong>tracker</strong> – Name of the tracker to use with the inference model. Must be one of
<cite>“simple”</cite> or <cite>“flow”</cite>. If <cite>None</cite>, no identity tracking across frames will
be performed.</p></li>
<li><p><strong>tracker_window</strong> – Number of frames of history to use when tracking. No effect when
<cite>tracker</cite> is <cite>None</cite>.</p></li>
<li><p><strong>tracker_max_instances</strong> – If not <cite>None</cite>, discard instances beyond this count when
tracking. No effect when <cite>tracker</cite> is <cite>None</cite>.</p></li>
<li><p><strong>disable_gpu_preallocation</strong> – If <cite>True</cite> (the default), initialize the GPU and
disable preallocation of memory. This is necessary to prevent freezing on
some systems with low GPU memory and has negligible impact on performance.
If <cite>False</cite>, no GPU initialization is performed. No effect if running in
CPU-only mode.</p></li>
<li><p><strong>progress_reporting</strong> – Mode of inference progress reporting. If <cite>“rich”</cite> (the
default), an updating progress bar is displayed in the console or notebook.
If <cite>“json”</cite>, a JSON-serialized message is printed out which can be captured
for programmatic progress monitoring. If <cite>“none”</cite>, nothing is displayed
during inference – this is recommended when running on clusters or headless
machines where the output is captured to a log file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>An instance of a <cite>Predictor</cite> based on which model type was detected.</p>
<p>If this is a top-down model, paths to the centroids model as well as the
centered instance model must be provided. A <cite>TopDownPredictor</cite> instance will be
returned.</p>
<p>If this is a bottom-up model, a <cite>BottomUpPredictor</cite> will be returned.</p>
<p>If this is a single-instance model, a <cite>SingleInstancePredictor</cite> will be
returned.</p>
<p>If a <cite>tracker</cite> is specified, the predictor will also run identity tracking over
time.</p>
</p>
</dd>
</dl>
<p>See also: TopDownPredictor, BottomUpPredictor, SingleInstancePredictor</p>
</dd></dl>

<dl class="py function">
<dt id="sleap.nn.inference.main">
<code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">main</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.main" title="Permalink to this definition">¶</a></dt>
<dd><p>Entrypoint for <cite>sleap-track</cite> CLI for running inference.</p>
</dd></dl>

</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">SLEAP</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../guides/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/index.html">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/reference.html">Feature Reference</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="sleap.diagnostic.html">sleap.diagnostic</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.instance.html">sleap.instance</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.message.html">sleap.message</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.prefs.html">sleap.prefs</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.rangelist.html">sleap.rangelist</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.skeleton.html">sleap.skeleton</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.util.html">sleap.util</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.version.html">sleap.version</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.color.html">sleap.gui.color</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.commands.html">sleap.gui.commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.dataviews.html">sleap.gui.dataviews</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.release_checker.html">sleap.gui.release_checker</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.shortcuts.html">sleap.gui.shortcuts</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.state.html">sleap.gui.state</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.suggestions.html">sleap.gui.suggestions</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.overlays.anchors.html">sleap.gui.overlays.anchors</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.overlays.base.html">sleap.gui.overlays.base</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.overlays.confmaps.html">sleap.gui.overlays.confmaps</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.overlays.instance.html">sleap.gui.overlays.instance</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.overlays.pafs.html">sleap.gui.overlays.pafs</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.overlays.tracks.html">sleap.gui.overlays.tracks</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.learning.configs.html">sleap.gui.learning.configs</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.learning.datagen.html">sleap.gui.learning.datagen</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.learning.dialog.html">sleap.gui.learning.dialog</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.learning.receptivefield.html">sleap.gui.learning.receptivefield</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.learning.runners.html">sleap.gui.learning.runners</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.learning.scopedkeydict.html">sleap.gui.learning.scopedkeydict</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.dialogs.delete.html">sleap.gui.dialogs.delete</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.dialogs.export_clip.html">sleap.gui.dialogs.export_clip</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.dialogs.filedialog.html">sleap.gui.dialogs.filedialog</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.dialogs.formbuilder.html">sleap.gui.dialogs.formbuilder</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.dialogs.importvideos.html">sleap.gui.dialogs.importvideos</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.dialogs.merge.html">sleap.gui.dialogs.merge</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.dialogs.message.html">sleap.gui.dialogs.message</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.dialogs.missingfiles.html">sleap.gui.dialogs.missingfiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.dialogs.shortcuts.html">sleap.gui.dialogs.shortcuts</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.widgets.imagedir.html">sleap.gui.widgets.imagedir</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.widgets.multicheck.html">sleap.gui.widgets.multicheck</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.widgets.slider.html">sleap.gui.widgets.slider</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.widgets.video.html">sleap.gui.widgets.video</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.info.align.html">sleap.info.align</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.info.feature_suggestions.html">sleap.info.feature_suggestions</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.info.labels.html">sleap.info.labels</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.info.metrics.html">sleap.info.metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.info.summary.html">sleap.info.summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.info.trackcleaner.html">sleap.info.trackcleaner</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.info.write_tracking_h5.html">sleap.info.write_tracking_h5</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.asyncvideo.html">sleap.io.asyncvideo</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.convert.html">sleap.io.convert</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.dataset.html">sleap.io.dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.legacy.html">sleap.io.legacy</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.pathutils.html">sleap.io.pathutils</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.video.html">sleap.io.video</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.videowriter.html">sleap.io.videowriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.visuals.html">sleap.io.visuals</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.adaptor.html">sleap.io.format.adaptor</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.coco.html">sleap.io.format.coco</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.deeplabcut.html">sleap.io.format.deeplabcut</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.deepposekit.html">sleap.io.format.deepposekit</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.dispatch.html">sleap.io.format.dispatch</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.filehandle.html">sleap.io.format.filehandle</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.genericjson.html">sleap.io.format.genericjson</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.hdf5.html">sleap.io.format.hdf5</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.labels_json.html">sleap.io.format.labels_json</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.leap_matlab.html">sleap.io.format.leap_matlab</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.main.html">sleap.io.format.main</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.sleap_analysis.html">sleap.io.format.sleap_analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.text.html">sleap.io.format.text</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.callbacks.html">sleap.nn.callbacks</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.evals.html">sleap.nn.evals</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.heads.html">sleap.nn.heads</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">sleap.nn.inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.losses.html">sleap.nn.losses</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.model.html">sleap.nn.model</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.monitor.html">sleap.nn.monitor</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.paf_grouping.html">sleap.nn.paf_grouping</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.peak_finding.html">sleap.nn.peak_finding</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.system.html">sleap.nn.system</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.tracking.html">sleap.nn.tracking</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.training.html">sleap.nn.training</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.utils.html">sleap.nn.utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.viz.html">sleap.nn.viz</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.config.data.html">sleap.nn.config.data</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.config.model.html">sleap.nn.config.model</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.config.optimization.html">sleap.nn.config.optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.config.outputs.html">sleap.nn.config.outputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.config.training_job.html">sleap.nn.config.training_job</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.config.utils.html">sleap.nn.config.utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.architectures.common.html">sleap.nn.architectures.common</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.architectures.encoder_decoder.html">sleap.nn.architectures.encoder_decoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.architectures.hourglass.html">sleap.nn.architectures.hourglass</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.architectures.hrnet.html">sleap.nn.architectures.hrnet</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.architectures.leap.html">sleap.nn.architectures.leap</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.architectures.pretrained_encoders.html">sleap.nn.architectures.pretrained_encoders</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.architectures.resnet.html">sleap.nn.architectures.resnet</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.architectures.unet.html">sleap.nn.architectures.unet</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.architectures.upsampling.html">sleap.nn.architectures.upsampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.tracker.components.html">sleap.nn.tracker.components</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.tracker.kalman.html">sleap.nn.tracker.kalman</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.augmentation.html">sleap.nn.data.augmentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.confidence_maps.html">sleap.nn.data.confidence_maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.dataset_ops.html">sleap.nn.data.dataset_ops</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.edge_maps.html">sleap.nn.data.edge_maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.general.html">sleap.nn.data.general</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.grouping.html">sleap.nn.data.grouping</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.inference.html">sleap.nn.data.inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.instance_centroids.html">sleap.nn.data.instance_centroids</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.instance_cropping.html">sleap.nn.data.instance_cropping</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.normalization.html">sleap.nn.data.normalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.offset_regression.html">sleap.nn.data.offset_regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.pipelines.html">sleap.nn.data.pipelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.providers.html">sleap.nn.data.providers</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.resizing.html">sleap.nn.data.resizing</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.training.html">sleap.nn.data.training</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.utils.html">sleap.nn.data.utils</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../api.html">Developer API</a><ul>
      <li>Previous: <a href="sleap.nn.heads.html" title="previous chapter">sleap.nn.heads</a></li>
      <li>Next: <a href="sleap.nn.losses.html" title="next chapter">sleap.nn.losses</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019–2020, Murthy Lab @ Princeton.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.4.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/_autosummary/sleap.nn.inference.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>