
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>sleap.nn.inference &#8212; SLEAP  documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="sleap.nn.losses" href="sleap.nn.losses.html" />
    <link rel="prev" title="sleap.nn.heads" href="sleap.nn.heads.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="module-sleap.nn.inference">
<span id="sleap-nn-inference"></span><h1>sleap.nn.inference<a class="headerlink" href="#module-sleap.nn.inference" title="Permalink to this headline">¶</a></h1>
<p>Inference pipelines and utilities.</p>
<dl class="py class">
<dt id="sleap.nn.inference.BottomUpInferenceLayer">
<em class="property">class </em><code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">BottomUpInferenceLayer</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#BottomUpInferenceLayer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceLayer" title="Permalink to this definition">¶</a></dt>
<dd><p>Keras layer that predicts instances from images using a trained model.</p>
<p>This layer encapsulates all of the inference operations required for generating
predictions from a centered instance confidence map model. This includes
preprocessing, model forward pass, peak finding and coordinate adjustment.</p>
<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpInferenceLayer.keras_model">
<code class="sig-name descname">keras_model</code><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceLayer.keras_model" title="Permalink to this definition">¶</a></dt>
<dd><p>A <cite>tf.keras.Model</cite> that accepts rank-4 images as input and predicts
rank-4 confidence maps and part affinity fields as output.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpInferenceLayer.paf_scorer">
<code class="sig-name descname">paf_scorer</code><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceLayer.paf_scorer" title="Permalink to this definition">¶</a></dt>
<dd><p>A <cite>sleap.nn.paf_grouping.PAFScorer</cite> instance configured to group
instances based on peaks and PAFs produced by the model.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpInferenceLayer.input_scale">
<code class="sig-name descname">input_scale</code><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceLayer.input_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Float indicating if the images should be resized before being
passed to the model.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpInferenceLayer.cm_output_stride">
<code class="sig-name descname">cm_output_stride</code><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceLayer.cm_output_stride" title="Permalink to this definition">¶</a></dt>
<dd><p>Output stride of the model, denoting the scale of the output
confidence maps relative to the images (after input scaling). This is used
for adjusting the peak coordinates to the image grid. This will be inferred
from the model shapes if not provided.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpInferenceLayer.paf_output_stride">
<code class="sig-name descname">paf_output_stride</code><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceLayer.paf_output_stride" title="Permalink to this definition">¶</a></dt>
<dd><p>Output stride of the model, denoting the scale of the output
part affinity fields relative to the images (after input scaling). This is
used for adjusting the peak coordinates to the PAF grid. This will be
inferred from the model shapes if not provided.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpInferenceLayer.peak_threshold">
<code class="sig-name descname">peak_threshold</code><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceLayer.peak_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimum confidence map value to consider a global peak as valid.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpInferenceLayer.refinement">
<code class="sig-name descname">refinement</code><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceLayer.refinement" title="Permalink to this definition">¶</a></dt>
<dd><p>If <cite>None</cite>, returns the grid-aligned peaks with no refinement. If
<cite>“integral”</cite>, peaks will be refined with integral regression. If <cite>“local”</cite>,
peaks will be refined with quarter pixel local gradient offset.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpInferenceLayer.integral_patch_size">
<code class="sig-name descname">integral_patch_size</code><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceLayer.integral_patch_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of patches to crop around each rough peak for integral
refinement as an integer scalar.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpInferenceLayer.return_confmaps">
<code class="sig-name descname">return_confmaps</code><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceLayer.return_confmaps" title="Permalink to this definition">¶</a></dt>
<dd><p>If <cite>True</cite>, the confidence maps will be returned together with
the predicted instances. This will result in slower inference times since
the data must be copied off of the GPU, but is useful for visualizing the
raw output of the model.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpInferenceLayer.return_pafs">
<code class="sig-name descname">return_pafs</code><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceLayer.return_pafs" title="Permalink to this definition">¶</a></dt>
<dd><p>If <cite>True</cite>, the part affinity fields will be returned together with
the predicted instances. This will result in slower inference times since
the data must be copied off of the GPU, but is useful for visualizing the
raw output of the model.</p>
</dd></dl>

<dl class="py method">
<dt id="sleap.nn.inference.BottomUpInferenceLayer.call">
<code class="sig-name descname">call</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#BottomUpInferenceLayer.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceLayer.call" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict instances for one batch of images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – This may be either a single batch of images as a 4-D tensor of shape</p></li>
<li><p><strong>`</strong> (<em>batch_size</em><em>, </em><em>height</em><em>, </em><em>width</em><em>, </em><em>channels</em>) – </p></li>
<li><p><strong>batch in the &quot;images&quot; key.</strong> (<em>image</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><cite>“instance_peaks”: (batch_size, n_instances, n_nodes, 2)</cite>: Instance skeleton
points.</p>
<p><cite>”instance_peak_vals”: (batch_size, n_instances, n_nodes)</cite>: Confidence
values for the instance skeleton points.</p>
<p><cite>”instance_scores”: (batch_size, n_instances)</cite>: PAF matching score for each
instance.</p>
<p>If <cite>BottomUpInferenceLayer.return_confmaps</cite> is <cite>True</cite>, the predicted
confidence maps will be returned in the <cite>“confmaps”</cite> key.</p>
<p>If <cite>BottomUpInferenceLayer.return_pafs</cite> is <cite>True</cite>, the predicted PAFs will
be returned in the <cite>“part_affinity_fields”</cite> key.</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>The predicted instances as a dictionary of tensors with keys</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sleap.nn.inference.BottomUpInferenceModel">
<em class="property">class </em><code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">BottomUpInferenceModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#BottomUpInferenceModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bottom-up instance prediction model.</p>
<p>This model encapsulates the bottom-up approach where points are first detected by
local peak detection and then grouped into instances by connectivity scoring using
part affinity fields.</p>
<dl class="py attribute">
<dt id="sleap.nn.inference.BottomUpInferenceModel.bottomup_layer">
<code class="sig-name descname">bottomup_layer</code><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceModel.bottomup_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>A <cite>BottomUpInferenceLayer</cite>. This layer takes as input a full
image and outputs the predicted instances.</p>
</dd></dl>

<dl class="py method">
<dt id="sleap.nn.inference.BottomUpInferenceModel.call">
<code class="sig-name descname">call</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">example</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#BottomUpInferenceModel.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.BottomUpInferenceModel.call" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict instances for one batch of images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>example</strong> – This may be either a single batch of images as a 4-D tensor of
shape <cite>(batch_size, height, width, channels)</cite>, or a dictionary
containing the image batch in the <cite>“images”</cite> key.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt><cite>“instance_peaks”: (batch_size, n_instances, n_nodes, 2)</cite>: Instance skeleton</dt><dd><p>points.</p>
</dd>
<dt><cite>”instance_peak_vals”: (batch_size, n_instances, n_nodes)</cite>: Confidence</dt><dd><p>values for the instance skeleton points.</p>
</dd>
<dt><cite>”instance_scores”: (batch_size, n_instances)</cite>: PAF matching score for each</dt><dd><p>instance.</p>
</dd>
</dl>
<p>If <cite>BottomUpInferenceModel.bottomup_layer.return_confmaps</cite> is <cite>True</cite>, the
predicted confidence maps will be returned in the <cite>“confmaps”</cite> key.</p>
<p>If <cite>BottomUpInferenceModel.bottomup_layer.return_pafs</cite> is <cite>True</cite>, the
predicted PAFs will be returned in the <cite>“part_affinity_fields”</cite> key.</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>The predicted instances as a dictionary of tensors with keys</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sleap.nn.inference.BottomupPredictor">
<em class="property">class </em><code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">BottomupPredictor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bottomup_config</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sleap.nn.config.training_job.html#sleap.nn.config.training_job.TrainingJobConfig" title="sleap.nn.config.training_job.TrainingJobConfig">sleap.nn.config.training_job.TrainingJobConfig</a></span></em>, <em class="sig-param"><span class="n">bottomup_model</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sleap.nn.model.html#sleap.nn.model.Model" title="sleap.nn.model.Model">sleap.nn.model.Model</a></span></em>, <em class="sig-param"><span class="n">inference_model</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="#sleap.nn.inference.BottomUpInferenceModel" title="sleap.nn.inference.BottomUpInferenceModel">sleap.nn.inference.BottomUpInferenceModel</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">peak_threshold</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.2</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="n">integral_refinement</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">integral_patch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em>, <em class="sig-param"><span class="n">max_edge_length_ratio</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">paf_line_points</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">10</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#BottomupPredictor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.BottomupPredictor" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="sleap.nn.inference.BottomupPredictor.from_trained_models">
<em class="property">classmethod </em><code class="sig-name descname">from_trained_models</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bottomup_model_path</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="n">peak_threshold</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.2</span></em>, <em class="sig-param"><span class="n">integral_refinement</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">integral_patch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#sleap.nn.inference.BottomupPredictor" title="sleap.nn.inference.BottomupPredictor">sleap.nn.inference.BottomupPredictor</a><a class="reference internal" href="../_modules/sleap/nn/inference.html#BottomupPredictor.from_trained_models"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.BottomupPredictor.from_trained_models" title="Permalink to this definition">¶</a></dt>
<dd><p>Create predictor from saved models.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sleap.nn.inference.CentroidCrop">
<em class="property">class </em><code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">CentroidCrop</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#CentroidCrop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.CentroidCrop" title="Permalink to this definition">¶</a></dt>
<dd><p>Inference layer for applying centroid crop-based models.</p>
<p>This layer encapsulates all of the inference operations requires for generating
predictions from a centroid confidence map model. This includes preprocessing,
model forward pass, peak finding, coordinate adjustment and cropping.</p>
<dl class="py attribute">
<dt id="sleap.nn.inference.CentroidCrop.keras_model">
<code class="sig-name descname">keras_model</code><a class="headerlink" href="#sleap.nn.inference.CentroidCrop.keras_model" title="Permalink to this definition">¶</a></dt>
<dd><p>A <cite>tf.keras.Model</cite> that accepts rank-4 images as input and predicts
rank-4 confidence maps as output. This should be a model that is trained on
centroid/anchor confidence maps.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.CentroidCrop.crop_size">
<code class="sig-name descname">crop_size</code><a class="headerlink" href="#sleap.nn.inference.CentroidCrop.crop_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Integer scalar specifying the height/width of the centered crops.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.CentroidCrop.input_scale">
<code class="sig-name descname">input_scale</code><a class="headerlink" href="#sleap.nn.inference.CentroidCrop.input_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Float indicating if the images should be resized before being
passed to the model.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.CentroidCrop.pad_to_stride">
<code class="sig-name descname">pad_to_stride</code><a class="headerlink" href="#sleap.nn.inference.CentroidCrop.pad_to_stride" title="Permalink to this definition">¶</a></dt>
<dd><p>If not 1, input image will be paded to ensure that it is
divisible by this value (after scaling). This should be set to the max
stride of the model.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.CentroidCrop.output_stride">
<code class="sig-name descname">output_stride</code><a class="headerlink" href="#sleap.nn.inference.CentroidCrop.output_stride" title="Permalink to this definition">¶</a></dt>
<dd><p>Output stride of the model, denoting the scale of the output
confidence maps relative to the images (after input scaling). This is used
for adjusting the peak coordinates to the image grid. This will be inferred
from the model shapes if not provided.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.CentroidCrop.peak_threshold">
<code class="sig-name descname">peak_threshold</code><a class="headerlink" href="#sleap.nn.inference.CentroidCrop.peak_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimum confidence map value to consider a global peak as valid.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.CentroidCrop.refinement">
<code class="sig-name descname">refinement</code><a class="headerlink" href="#sleap.nn.inference.CentroidCrop.refinement" title="Permalink to this definition">¶</a></dt>
<dd><p>If <cite>None</cite>, returns the grid-aligned peaks with no refinement. If
<cite>“integral”</cite>, peaks will be refined with integral regression. If <cite>“local”</cite>,
peaks will be refined with quarter pixel local gradient offset.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.CentroidCrop.integral_patch_size">
<code class="sig-name descname">integral_patch_size</code><a class="headerlink" href="#sleap.nn.inference.CentroidCrop.integral_patch_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of patches to crop around each rough peak for integral
refinement as an integer scalar.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.CentroidCrop.return_confmaps">
<code class="sig-name descname">return_confmaps</code><a class="headerlink" href="#sleap.nn.inference.CentroidCrop.return_confmaps" title="Permalink to this definition">¶</a></dt>
<dd><p>If <cite>True</cite>, the confidence maps will be returned together with
the predicted peaks. This will result in slower inference times since the
data must be copied off of the GPU, but is useful for visualizing the raw
output of the model.</p>
</dd></dl>

<dl class="py method">
<dt id="sleap.nn.inference.CentroidCrop.call">
<code class="sig-name descname">call</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inputs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#CentroidCrop.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.CentroidCrop.call" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict centroid confidence maps and crop around peaks.</p>
<p>This layer can be chained with a <cite>FindInstancePeaks</cite> layer to create a top-down
inference function from full images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inputs</strong> – Full frame images as a <cite>tf.Tensor</cite> of shape
<cite>(samples, height, width, channels)</cite> or a dictionary with key:
<cite>“image”</cite>: Full frame images in the same format as above.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt><cite>“crops”</cite>: Cropped images of shape</dt><dd><p><cite>(samples, ?, crop_size, crop_size, channels)</cite>.</p>
</dd>
<dt><cite>”crop_offsets”</cite>: Coordinates of the top-left of the crops as <cite>(x, y)</cite></dt><dd><p>offsets of shape <cite>(samples, ?, 2)</cite> for adjusting the predicted peak
coordinates.</p>
</dd>
</dl>
<p><cite>”centroids”</cite>: The predicted centroids of shape <cite>(samples, ?, 2)</cite>.
<cite>“centroid_vals”: The centroid confidence values of shape `(samples, ?)</cite>.</p>
<p>If the <cite>return_confmaps</cite> attribute is set to <cite>True</cite>, the output will also
contain a key named <cite>“centroid_confmaps”</cite> containing a <cite>tf.RaggedTensor</cite> of
shape <cite>(samples, ?, output_height, output_width, 1)</cite> containing the
confidence maps predicted by the model.</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A dictionary of outputs grouped by sample with keys</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sleap.nn.inference.CentroidCropGroundTruth">
<em class="property">class </em><code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">CentroidCropGroundTruth</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#CentroidCropGroundTruth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.CentroidCropGroundTruth" title="Permalink to this definition">¶</a></dt>
<dd><p>Keras layer that simulates a centroid cropping model using ground truth.</p>
<p>This layer is useful for testing and evaluating centered instance models.</p>
<dl class="py attribute">
<dt id="sleap.nn.inference.CentroidCropGroundTruth.crop_size">
<code class="sig-name descname">crop_size</code><a class="headerlink" href="#sleap.nn.inference.CentroidCropGroundTruth.crop_size" title="Permalink to this definition">¶</a></dt>
<dd><p>The length of the square box to extract around each centroid.</p>
</dd></dl>

<dl class="py method">
<dt id="sleap.nn.inference.CentroidCropGroundTruth.call">
<code class="sig-name descname">call</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">example_gt</span><span class="p">:</span> <span class="n">Dict<span class="p">[</span>str<span class="p">, </span>tensorflow.python.framework.ops.Tensor<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; Dict<span class="p">[</span>str<span class="p">, </span>tensorflow.python.framework.ops.Tensor<span class="p">]</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#CentroidCropGroundTruth.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.CentroidCropGroundTruth.call" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the ground truth instance crops.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>example_gt</strong> – <p>Dictionary generated from a labels pipeline with the keys:
<cite>“image”: (batch_size, height, width, channels)</cite>
<cite>“centroids”: (batch_size, n_centroids, 2)</cite>: The input centroids.</p>
<blockquote>
<div><p>Axis 1 is expected to be ragged.</p>
</div></blockquote>
<p>These can be generated by the <cite>InstanceCentroidFinder</cite> transformer.</p>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><cite>“crops”: (batch_size, n_centroids, crop_size, crop_size, channels)</cite>
<cite>“crop_offsets”: (batch_size, n_centroids, crop_size, crop_size, channels)</cite></p>
<blockquote>
<div><p>These contain the top-left coordinates of each crop in the full images.</p>
</div></blockquote>
<p><cite>”centroids”: (batch_size, n_centroids, 2)</cite>
<cite>“centroid_vals”: (batch_size, n_centroids)</cite></p>
<p>Axis 1 of all keys are expected to be ragged.</p>
<p><cite>”centroids”</cite> are from the input example and <cite>“centroid_vals”</cite> will be
filled with ones.</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Dictionary containing the output of the instance cropping layer with keys</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sleap.nn.inference.FindInstancePeaks">
<em class="property">class </em><code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">FindInstancePeaks</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#FindInstancePeaks"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.FindInstancePeaks" title="Permalink to this definition">¶</a></dt>
<dd><p>Keras layer that predicts instance peaks from images using a trained model.</p>
<p>This layer encapsulates all of the inference operations required for generating
predictions from a centered instance confidence map model. This includes
preprocessing, model forward pass, peak finding and coordinate adjustment.</p>
<dl class="py attribute">
<dt id="sleap.nn.inference.FindInstancePeaks.keras_model">
<code class="sig-name descname">keras_model</code><a class="headerlink" href="#sleap.nn.inference.FindInstancePeaks.keras_model" title="Permalink to this definition">¶</a></dt>
<dd><p>A <cite>tf.keras.Model</cite> that accepts rank-4 images as input and predicts
rank-4 confidence maps as output. This should be a model that is trained on
centered instance confidence maps.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.FindInstancePeaks.input_scale">
<code class="sig-name descname">input_scale</code><a class="headerlink" href="#sleap.nn.inference.FindInstancePeaks.input_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Float indicating if the images should be resized before being
passed to the model.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.FindInstancePeaks.output_stride">
<code class="sig-name descname">output_stride</code><a class="headerlink" href="#sleap.nn.inference.FindInstancePeaks.output_stride" title="Permalink to this definition">¶</a></dt>
<dd><p>Output stride of the model, denoting the scale of the output
confidence maps relative to the images (after input scaling). This is used
for adjusting the peak coordinates to the image grid. This will be inferred
from the model shapes if not provided.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.FindInstancePeaks.peak_threshold">
<code class="sig-name descname">peak_threshold</code><a class="headerlink" href="#sleap.nn.inference.FindInstancePeaks.peak_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimum confidence map value to consider a global peak as valid.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.FindInstancePeaks.refinement">
<code class="sig-name descname">refinement</code><a class="headerlink" href="#sleap.nn.inference.FindInstancePeaks.refinement" title="Permalink to this definition">¶</a></dt>
<dd><p>If <cite>None</cite>, returns the grid-aligned peaks with no refinement. If
<cite>“integral”</cite>, peaks will be refined with integral regression. If <cite>“local”</cite>,
peaks will be refined with quarter pixel local gradient offset.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.FindInstancePeaks.integral_patch_size">
<code class="sig-name descname">integral_patch_size</code><a class="headerlink" href="#sleap.nn.inference.FindInstancePeaks.integral_patch_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of patches to crop around each rough peak for integral
refinement as an integer scalar.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.FindInstancePeaks.return_confmaps">
<code class="sig-name descname">return_confmaps</code><a class="headerlink" href="#sleap.nn.inference.FindInstancePeaks.return_confmaps" title="Permalink to this definition">¶</a></dt>
<dd><p>If <cite>True</cite>, the confidence maps will be returned together with
the predicted peaks. This will result in slower inference times since the
data must be copied off of the GPU, but is useful for visualizing the raw
output of the model.</p>
</dd></dl>

<dl class="py method">
<dt id="sleap.nn.inference.FindInstancePeaks.call">
<code class="sig-name descname">call</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inputs</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>Dict<span class="p">[</span>str<span class="p">, </span>tensorflow.python.framework.ops.Tensor<span class="p">]</span><span class="p">, </span>tensorflow.python.framework.ops.Tensor<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; Dict<span class="p">[</span>str<span class="p">, </span>tensorflow.python.framework.ops.Tensor<span class="p">]</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#FindInstancePeaks.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.FindInstancePeaks.call" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict confidence maps and infer peak coordinates.</p>
<p>This layer can be chained with a <cite>CentroidCrop</cite> layer to create a top-down
inference function from full images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inputs</strong> – <p>Instance-centered images as a <cite>tf.Tensor</cite> of shape
<cite>(samples, height, width, channels)</cite> or <cite>tf.RaggedTensor</cite> of shape
<cite>(samples, ?, height, width, channels)</cite> where images are grouped by
sample and may contain a variable number of crops, or a dictionary with
keys:
<cite>“crops”</cite>: Cropped images in either format above.
<cite>“crop_offsets”</cite>: (Optional) Coordinates of the top-left of the crops as</p>
<blockquote>
<div><p><cite>(x, y)</cite> offsets of shape <cite>(samples, ?, 2)</cite> for adjusting the
predicted peak coordinates. No adjustment is performed if not
provided.</p>
</div></blockquote>
<dl class="simple">
<dt><cite>”centroids”</cite>: (Optional) If provided, will be passed through to the</dt><dd><p>output.</p>
</dd>
<dt><cite>”centroid_vals”</cite>: (Optional) If provided, will be passed through to the</dt><dd><p>output.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt><cite>“instance_peaks”</cite>: The predicted peaks for each instance in the batch as a</dt><dd><p><cite>tf.RaggedTensor</cite> of shape <cite>(samples, ?, nodes, 2)</cite>.</p>
</dd>
<dt><cite>”instance_peak_vals”</cite>: The value of the confidence maps at the predicted</dt><dd><p>peaks for each instance in the batch as a <cite>tf.RaggedTensor</cite> of shape
<cite>(samples, ?, nodes)</cite>.</p>
</dd>
</dl>
<p>If provided (e.g., from an input <cite>CentroidCrop</cite> layer), the centroids that
generated the crops will also be included in the keys <cite>“centroids”</cite> and
<cite>“centroid_vals”</cite>.</p>
<p>If the <cite>return_confmaps</cite> attribute is set to <cite>True</cite>, the output will also
contain a key named <cite>“instance_confmaps”</cite> containing a <cite>tf.RaggedTensor</cite> of
shape <cite>(samples, ?, output_height, output_width, nodes)</cite> containing the
confidence maps predicted by the model.</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A dictionary of outputs with keys</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sleap.nn.inference.FindInstancePeaksGroundTruth">
<em class="property">class </em><code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">FindInstancePeaksGroundTruth</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#FindInstancePeaksGroundTruth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.FindInstancePeaksGroundTruth" title="Permalink to this definition">¶</a></dt>
<dd><p>Keras layer that simulates a centered instance peaks model.</p>
<p>This layer is useful for testing and evaluating centroid models.</p>
<dl class="py method">
<dt id="sleap.nn.inference.FindInstancePeaksGroundTruth.call">
<code class="sig-name descname">call</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">example_gt</span><span class="p">:</span> <span class="n">Dict<span class="p">[</span>str<span class="p">, </span>tensorflow.python.framework.ops.Tensor<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">crop_output</span><span class="p">:</span> <span class="n">Dict<span class="p">[</span>str<span class="p">, </span>tensorflow.python.framework.ops.Tensor<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; Dict<span class="p">[</span>str<span class="p">, </span>tensorflow.python.framework.ops.Tensor<span class="p">]</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#FindInstancePeaksGroundTruth.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.FindInstancePeaksGroundTruth.call" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the ground truth instance peaks given a set of crops.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>example_gt</strong> – <p>Dictionary generated from a labels pipeline with the key:
<cite>“instances”: (batch_size, n_instances_gt, n_nodes, 2)</cite></p>
<blockquote>
<div><p>Axes 1 and 2 are expected to be ragged dimensions.</p>
</div></blockquote>
</p></li>
<li><p><strong>crop_output</strong> – <p>Dictionary containing the output of the instance cropping layer
with keys:
<cite>“centroids”: (batch_size, n_centroids, 2)</cite>,
<cite>“centroid_vals”: (batch_size, n_centroids)</cite></p>
<blockquote>
<div><p>Axis 1 of both keys are expected to be ragged.</p>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>A dictionary with the instance peaks for each frame. The peaks are just the
ground truth instances matched to the crop output centroids via greedy
matching of the closest node point to each centroid.</p>
<dl>
<dt>The output will have keys:</dt><dd><p><cite>”centroids”: (batch_size, n_centroids, 2)</cite>: The input centroids.
<cite>“centroid_vals”: (batch_size, n_centroids)</cite>: The input centroid</p>
<blockquote>
<div><p>confidence values.</p>
</div></blockquote>
<dl class="simple">
<dt><cite>”instance_peaks”: (batch_size, n_centroids, n_nodes, 2)</cite>: The matched</dt><dd><p>instances.</p>
</dd>
<dt><cite>”instance_peak_vals”: (batch_size, n_centroids, n_nodes)</cite>: Peak</dt><dd><p>confidence values (all 1.0).</p>
</dd>
</dl>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sleap.nn.inference.InferenceLayer">
<em class="property">class </em><code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">InferenceLayer</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#InferenceLayer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.InferenceLayer" title="Permalink to this definition">¶</a></dt>
<dd><p>Base layer for wrapping a Keras model into a layer with preprocessing.</p>
<p>This layer is useful for wrapping input preprocessing operations that would
otherwise be handled by a separate pipeline.</p>
<p>This layer expects the same input as the model (rank-4 image) and automatically
converts the input to a float if it is in integer form. This can help improve
performance by enabling inference directly on <cite>uint8</cite> inputs.</p>
<p>The <cite>call()</cite> method can be overloaded to create custom inference routines that
take advantage of the <cite>preprocess()</cite> method.</p>
<dl class="py attribute">
<dt id="sleap.nn.inference.InferenceLayer.keras_model">
<code class="sig-name descname">keras_model</code><a class="headerlink" href="#sleap.nn.inference.InferenceLayer.keras_model" title="Permalink to this definition">¶</a></dt>
<dd><p>A <cite>tf.keras.Model</cite> that will be called on the input to this layer.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.InferenceLayer.input_scale">
<code class="sig-name descname">input_scale</code><a class="headerlink" href="#sleap.nn.inference.InferenceLayer.input_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>If not 1.0, input image will be resized by this factor.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.InferenceLayer.pad_to_stride">
<code class="sig-name descname">pad_to_stride</code><a class="headerlink" href="#sleap.nn.inference.InferenceLayer.pad_to_stride" title="Permalink to this definition">¶</a></dt>
<dd><p>If not 1, input image will be paded to ensure that it is
divisible by this value (after scaling).</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.InferenceLayer.ensure_grayscale">
<code class="sig-name descname">ensure_grayscale</code><a class="headerlink" href="#sleap.nn.inference.InferenceLayer.ensure_grayscale" title="Permalink to this definition">¶</a></dt>
<dd><p>If <cite>True</cite>, converts inputs to grayscale if not already. If
<cite>False</cite>, converts inputs to RGB if not already. If <cite>None</cite> (default), infer
from the shape of the input layer of the model.</p>
</dd></dl>

<dl class="py method">
<dt id="sleap.nn.inference.InferenceLayer.call">
<code class="sig-name descname">call</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span><span class="p">:</span> <span class="n">tensorflow.python.framework.ops.Tensor</span></em><span class="sig-paren">)</span> &#x2192; tensorflow.python.framework.ops.Tensor<a class="reference internal" href="../_modules/sleap/nn/inference.html#InferenceLayer.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.InferenceLayer.call" title="Permalink to this definition">¶</a></dt>
<dd><p>Call the model with preprocessed data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – Inputs to the model.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Output of the model after being called with preprocessing.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sleap.nn.inference.InferenceLayer.preprocess">
<code class="sig-name descname">preprocess</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">imgs</span><span class="p">:</span> <span class="n">tensorflow.python.framework.ops.Tensor</span></em><span class="sig-paren">)</span> &#x2192; tensorflow.python.framework.ops.Tensor<a class="reference internal" href="../_modules/sleap/nn/inference.html#InferenceLayer.preprocess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.InferenceLayer.preprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply all preprocessing operations configured for this layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>imgs</strong> – A batch of images as a tensor.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The input tensor after applying preprocessing operations. The tensor will
always be a <cite>tf.float32</cite>, which will be adjusted to the range <cite>[0, 1]</cite> if it
was previously an integer.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sleap.nn.inference.InferenceModel">
<em class="property">class </em><code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">InferenceModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#InferenceModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.InferenceModel" title="Permalink to this definition">¶</a></dt>
<dd><p>SLEAP inference model base class.</p>
<p>This class wraps the <cite>tf.keras.Model</cite> class to provide SLEAP-specific inference
utilities such as handling different input data types, preprocessing and variable
output shapes.</p>
<dl class="py method">
<dt id="sleap.nn.inference.InferenceModel.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>numpy.ndarray<span class="p">, </span>tensorflow.python.framework.ops.Tensor<span class="p">, </span>Dict<span class="p">[</span>str<span class="p">, </span>tensorflow.python.framework.ops.Tensor<span class="p">]</span><span class="p">, </span>tensorflow.python.data.ops.dataset_ops.DatasetV2<span class="p">, </span><a class="reference internal" href="sleap.nn.data.pipelines.html#sleap.nn.data.pipelines.Pipeline" title="sleap.nn.data.pipelines.Pipeline">sleap.nn.data.pipelines.Pipeline</a><span class="p">, </span><a class="reference internal" href="sleap.io.video.html#sleap.io.video.Video" title="sleap.io.video.Video">sleap.io.video.Video</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">numpy</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span> &#x2192; Union<span class="p">[</span>Dict<span class="p">[</span>str<span class="p">, </span>numpy.ndarray<span class="p">]</span><span class="p">, </span>Dict<span class="p">[</span>str<span class="p">, </span>Union<span class="p">[</span>tensorflow.python.framework.ops.Tensor<span class="p">, </span>tensorflow.python.ops.ragged.ragged_tensor.RaggedTensor<span class="p">]</span><span class="p">]</span><span class="p">]</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#InferenceModel.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.InferenceModel.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict instances in the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – <p>Input data in any form. Possible types:
- <cite>np.ndarray</cite>, <cite>tf.Tensor</cite>: Images of shape</p>
<blockquote>
<div><p><cite>(samples, height, width, channels)</cite></p>
</div></blockquote>
<ul>
<li><p><cite>dict</cite> with key <cite>“image”</cite> as a tensor</p></li>
<li><p><cite>tf.data.Dataset</cite> that generates examples in one of the above formats.</p></li>
<li><p><cite>sleap.Pipeline</cite> that generates examples in one of the above formats.</p></li>
<li><dl class="simple">
<dt><cite>sleap.Video</cite> which will be converted into a pipeline that generates</dt><dd><p>batches of <cite>batch_size</cite> frames.</p>
</dd>
</dl>
</li>
</ul>
</p></li>
<li><p><strong>numpy</strong> – If <cite>True</cite> (default), returned values will be converted to
<a href="#id1"><span class="problematic" id="id2">`</span></a>np.ndarray`s or Python primitives if scalars.</p></li>
<li><p><strong>batch_size</strong> – Batch size to use for inference. No effect if using a dataset or
pipeline as input since those are expected to generate batches.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>The model outputs as a dictionary of (potentially ragged) tensors or numpy
arrays if <cite>numpy</cite> is <cite>True</cite>.</p>
<p>If <cite>numpy</cite> is <cite>False</cite>, values of the dictionary may be <a href="#id3"><span class="problematic" id="id4">`</span></a>tf.RaggedTensor`s
with the same length for axis 0 (samples), but variable length axis 1
(instances).</p>
<p>If <cite>numpy</cite> is <cite>True</cite> and the output contained ragged tensors, they will be
NaN-padded to the bounding shape and an additional key <cite>“n_valid”</cite> will be
included to indicate the number of valid elements (before padding) in axis
1 of the tensors.</p>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sleap.nn.inference.MockPredictor">
<em class="property">class </em><code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">MockPredictor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">labels</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sleap.io.dataset.html#sleap.io.dataset.Labels" title="sleap.io.dataset.Labels">sleap.io.dataset.Labels</a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#MockPredictor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.MockPredictor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt id="sleap.nn.inference.Predictor">
<em class="property">class </em><code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">Predictor</code><a class="reference internal" href="../_modules/sleap/nn/inference.html#Predictor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.Predictor" title="Permalink to this definition">¶</a></dt>
<dd><p>Base interface class for predictors.</p>
</dd></dl>

<dl class="py class">
<dt id="sleap.nn.inference.SingleInstanceInferenceLayer">
<em class="property">class </em><code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">SingleInstanceInferenceLayer</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#SingleInstanceInferenceLayer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.SingleInstanceInferenceLayer" title="Permalink to this definition">¶</a></dt>
<dd><p>Inference layer for applying single instance models.</p>
<p>This layer encapsulates all of the inference operations requires for generating
predictions from a single instance confidence map model. This includes
preprocessing, model forward pass, peak finding and coordinate adjustment.</p>
<dl class="py attribute">
<dt id="sleap.nn.inference.SingleInstanceInferenceLayer.keras_model">
<code class="sig-name descname">keras_model</code><a class="headerlink" href="#sleap.nn.inference.SingleInstanceInferenceLayer.keras_model" title="Permalink to this definition">¶</a></dt>
<dd><p>A <cite>tf.keras.Model</cite> that accepts rank-4 images as input and predicts
rank-4 confidence maps as output. This should be a model that is trained on
single instance confidence maps.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.SingleInstanceInferenceLayer.input_scale">
<code class="sig-name descname">input_scale</code><a class="headerlink" href="#sleap.nn.inference.SingleInstanceInferenceLayer.input_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Float indicating if the images should be resized before being
passed to the model.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.SingleInstanceInferenceLayer.pad_to_stride">
<code class="sig-name descname">pad_to_stride</code><a class="headerlink" href="#sleap.nn.inference.SingleInstanceInferenceLayer.pad_to_stride" title="Permalink to this definition">¶</a></dt>
<dd><p>If not 1, input image will be paded to ensure that it is
divisible by this value (after scaling). This should be set to the max
stride of the model.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.SingleInstanceInferenceLayer.output_stride">
<code class="sig-name descname">output_stride</code><a class="headerlink" href="#sleap.nn.inference.SingleInstanceInferenceLayer.output_stride" title="Permalink to this definition">¶</a></dt>
<dd><p>Output stride of the model, denoting the scale of the output
confidence maps relative to the images (after input scaling). This is used
for adjusting the peak coordinates to the image grid. This will be inferred
from the model shapes if not provided.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.SingleInstanceInferenceLayer.peak_threshold">
<code class="sig-name descname">peak_threshold</code><a class="headerlink" href="#sleap.nn.inference.SingleInstanceInferenceLayer.peak_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimum confidence map value to consider a global peak as valid.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.SingleInstanceInferenceLayer.refinement">
<code class="sig-name descname">refinement</code><a class="headerlink" href="#sleap.nn.inference.SingleInstanceInferenceLayer.refinement" title="Permalink to this definition">¶</a></dt>
<dd><p>If <cite>None</cite>, returns the grid-aligned peaks with no refinement. If
<cite>“integral”</cite>, peaks will be refined with integral regression. If <cite>“local”</cite>,
peaks will be refined with quarter pixel local gradient offset.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.SingleInstanceInferenceLayer.integral_patch_size">
<code class="sig-name descname">integral_patch_size</code><a class="headerlink" href="#sleap.nn.inference.SingleInstanceInferenceLayer.integral_patch_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of patches to crop around each rough peak for integral
refinement as an integer scalar.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.SingleInstanceInferenceLayer.return_confmaps">
<code class="sig-name descname">return_confmaps</code><a class="headerlink" href="#sleap.nn.inference.SingleInstanceInferenceLayer.return_confmaps" title="Permalink to this definition">¶</a></dt>
<dd><p>If <cite>True</cite>, the confidence maps will be returned together with
the predicted peaks. This will result in slower inference times since the
data must be copied off of the GPU, but is useful for visualizing the raw
output of the model.</p>
</dd></dl>

<dl class="py method">
<dt id="sleap.nn.inference.SingleInstanceInferenceLayer.call">
<code class="sig-name descname">call</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#SingleInstanceInferenceLayer.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.SingleInstanceInferenceLayer.call" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict instance confidence maps and find peaks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inputs</strong> – Full frame images as a <cite>tf.Tensor</cite> of shape
<cite>(samples, height, width, channels)</cite> or a dictionary with key:
<cite>“image”</cite>: Full frame images in the same format as above.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><cite>“peaks”</cite>: The predicted peaks of shape <cite>(samples, nodes, 2)</cite>.
<cite>“peak_vals”: The peak confidence values of shape `(samples, nodes)</cite>.</p>
<p>If the <cite>return_confmaps</cite> attribute is set to <cite>True</cite>, the output will also
contain a key named <cite>“confmaps”</cite> containing a <cite>tf.Tensor</cite> of shape
<cite>(samples, output_height, output_width, 1)</cite> containing the confidence maps
predicted by the model.</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A dictionary of outputs grouped by sample with keys</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sleap.nn.inference.SingleInstanceInferenceModel">
<em class="property">class </em><code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">SingleInstanceInferenceModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#SingleInstanceInferenceModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.SingleInstanceInferenceModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Single instance prediction model.</p>
<p>This model encapsulates the basic single instance approach where it is assumed that
there is only one instance in the frame. The images are passed to a peak detector
which is trained to detect all body parts for the instance assuming a single peak
per body part.</p>
<dl class="py attribute">
<dt id="sleap.nn.inference.SingleInstanceInferenceModel.single_instance_layer">
<code class="sig-name descname">single_instance_layer</code><a class="headerlink" href="#sleap.nn.inference.SingleInstanceInferenceModel.single_instance_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>A single instance instance peak detection layer. This
layer takes as input full images and outputs the detected peaks.</p>
</dd></dl>

<dl class="py method">
<dt id="sleap.nn.inference.SingleInstanceInferenceModel.call">
<code class="sig-name descname">call</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">example</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#SingleInstanceInferenceModel.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.SingleInstanceInferenceModel.call" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict instances for one batch of images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>example</strong> – This may be either a single batch of images as a 4-D tensor of
shape <cite>(batch_size, height, width, channels)</cite>, or a dictionary
containing the image batch in the <cite>“images”</cite> key.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><cite>“peaks”: (batch_size, n_nodes, 2)</cite>: Instance skeleton points.
<cite>“peak_vals”: (batch_size, n_instances, n_nodes)</cite>: Confidence values for the</p>
<blockquote>
<div><p>instance skeleton points.</p>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>The predicted instances as a dictionary of tensors with keys</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sleap.nn.inference.SingleInstancePredictor">
<em class="property">class </em><code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">SingleInstancePredictor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">confmap_config</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sleap.nn.config.training_job.html#sleap.nn.config.training_job.TrainingJobConfig" title="sleap.nn.config.training_job.TrainingJobConfig">sleap.nn.config.training_job.TrainingJobConfig</a></span></em>, <em class="sig-param"><span class="n">confmap_model</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sleap.nn.model.html#sleap.nn.model.Model" title="sleap.nn.model.Model">sleap.nn.model.Model</a></span></em>, <em class="sig-param"><span class="n">inference_model</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="#sleap.nn.inference.SingleInstanceInferenceModel" title="sleap.nn.inference.SingleInstanceInferenceModel">sleap.nn.inference.SingleInstanceInferenceModel</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">peak_threshold</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.2</span></em>, <em class="sig-param"><span class="n">integral_refinement</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">integral_patch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#SingleInstancePredictor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.SingleInstancePredictor" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="sleap.nn.inference.SingleInstancePredictor.from_trained_models">
<em class="property">classmethod </em><code class="sig-name descname">from_trained_models</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">confmap_model_path</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">peak_threshold</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.2</span></em>, <em class="sig-param"><span class="n">integral_refinement</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">integral_patch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#sleap.nn.inference.SingleInstancePredictor" title="sleap.nn.inference.SingleInstancePredictor">sleap.nn.inference.SingleInstancePredictor</a><a class="reference internal" href="../_modules/sleap/nn/inference.html#SingleInstancePredictor.from_trained_models"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.SingleInstancePredictor.from_trained_models" title="Permalink to this definition">¶</a></dt>
<dd><p>Create predictor from saved models.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sleap.nn.inference.TopDownModel">
<em class="property">class </em><code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">TopDownModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#TopDownModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.TopDownModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Top-down instance prediction model.</p>
<p>This model encapsulates the top-down approach where instances are first detected by
local peak detection of an anchor point and then cropped. These instance-centered
crops are then passed to an instance peak detector which is trained to detect all
remaining body parts for the instance that is centered within the crop.</p>
<dl class="py attribute">
<dt id="sleap.nn.inference.TopDownModel.centroid_crop">
<code class="sig-name descname">centroid_crop</code><a class="headerlink" href="#sleap.nn.inference.TopDownModel.centroid_crop" title="Permalink to this definition">¶</a></dt>
<dd><p>A centroid cropping layer. This can be either <cite>CentroidCrop</cite> or
<cite>CentroidCropGroundTruth</cite>. This layer takes the full image as input and
outputs a set of centroids and cropped boxes.</p>
</dd></dl>

<dl class="py attribute">
<dt id="sleap.nn.inference.TopDownModel.instance_peaks">
<code class="sig-name descname">instance_peaks</code><a class="headerlink" href="#sleap.nn.inference.TopDownModel.instance_peaks" title="Permalink to this definition">¶</a></dt>
<dd><p>A instance peak detection layer. This can be either
<cite>FindInstancePeaks</cite> or <cite>FindInstancePeaksGroundTruth</cite>. This layer takes as
input the output of the centroid cropper and outputs the detected peaks for
the instances within each crop.</p>
</dd></dl>

<dl class="py method">
<dt id="sleap.nn.inference.TopDownModel.call">
<code class="sig-name descname">call</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">example</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>Dict<span class="p">[</span>str<span class="p">, </span>tensorflow.python.framework.ops.Tensor<span class="p">]</span><span class="p">, </span>tensorflow.python.framework.ops.Tensor<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; Dict<span class="p">[</span>str<span class="p">, </span>tensorflow.python.framework.ops.Tensor<span class="p">]</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#TopDownModel.call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.TopDownModel.call" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict instances for one batch of images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>example</strong> – This may be either a single batch of images as a 4-D tensor of
shape <cite>(batch_size, height, width, channels)</cite>, or a dictionary
containing the image batch in the <cite>“images”</cite> key. If using a ground
truth model for either centroid cropping or instance peaks, the full
example from a <cite>Pipeline</cite> is required for providing the metadata.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><cite>“centroids”: (batch_size, n_instances, 2)</cite>: Instance centroids.
<cite>“centroid_vals”: (batch_size, n_instances)</cite>: Instance centroid confidence</p>
<blockquote>
<div><p>values.</p>
</div></blockquote>
<dl class="simple">
<dt><cite>”instance_peaks”: (batch_size, n_instances, n_nodes, 2)</cite>: Instance skeleton</dt><dd><p>points.</p>
</dd>
<dt><cite>”instance_peak_vals”: (batch_size, n_instances, n_nodes)</cite>: Confidence</dt><dd><p>values for the instance skeleton points.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>The predicted instances as a dictionary of tensors with keys</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sleap.nn.inference.TopdownPredictor">
<em class="property">class </em><code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">TopdownPredictor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">centroid_config</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="sleap.nn.config.training_job.html#sleap.nn.config.training_job.TrainingJobConfig" title="sleap.nn.config.training_job.TrainingJobConfig">sleap.nn.config.training_job.TrainingJobConfig</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">centroid_model</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="sleap.nn.model.html#sleap.nn.model.Model" title="sleap.nn.model.Model">sleap.nn.model.Model</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">confmap_config</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="sleap.nn.config.training_job.html#sleap.nn.config.training_job.TrainingJobConfig" title="sleap.nn.config.training_job.TrainingJobConfig">sleap.nn.config.training_job.TrainingJobConfig</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">confmap_model</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="sleap.nn.model.html#sleap.nn.model.Model" title="sleap.nn.model.Model">sleap.nn.model.Model</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">inference_model</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="#sleap.nn.inference.TopDownModel" title="sleap.nn.inference.TopDownModel">sleap.nn.inference.TopDownModel</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="n">peak_threshold</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.2</span></em>, <em class="sig-param"><span class="n">integral_refinement</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">integral_patch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#TopdownPredictor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.TopdownPredictor" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="sleap.nn.inference.TopdownPredictor.from_trained_models">
<em class="property">classmethod </em><code class="sig-name descname">from_trained_models</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">centroid_model_path</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">confmap_model_path</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="n">peak_threshold</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.2</span></em>, <em class="sig-param"><span class="n">integral_refinement</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">integral_patch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#sleap.nn.inference.TopdownPredictor" title="sleap.nn.inference.TopdownPredictor">sleap.nn.inference.TopdownPredictor</a><a class="reference internal" href="../_modules/sleap/nn/inference.html#TopdownPredictor.from_trained_models"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.TopdownPredictor.from_trained_models" title="Permalink to this definition">¶</a></dt>
<dd><p>Create predictor from saved models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>centroid_model_path</strong> – Path to centroid model folder.</p></li>
<li><p><strong>confmap_model_path</strong> – Path to topdown confidence map model folder.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>An instance of TopdownPredictor with the loaded models.</p>
<p>One of the two models can be left as None to perform inference with ground
truth data. This will only work with LabelsReader as the provider.</p>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sleap.nn.inference.VisualPredictor">
<em class="property">class </em><code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">VisualPredictor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">config</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sleap.nn.config.training_job.html#sleap.nn.config.training_job.TrainingJobConfig" title="sleap.nn.config.training_job.TrainingJobConfig">sleap.nn.config.training_job.TrainingJobConfig</a></span></em>, <em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sleap.nn.model.html#sleap.nn.model.Model" title="sleap.nn.model.Model">sleap.nn.model.Model</a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#VisualPredictor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.VisualPredictor" title="Permalink to this definition">¶</a></dt>
<dd><p>Predictor class for generating the visual output of model.</p>
</dd></dl>

<dl class="py function">
<dt id="sleap.nn.inference.find_heads_for_model_paths">
<code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">find_heads_for_model_paths</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">paths</span></em><span class="sig-paren">)</span> &#x2192; Dict<span class="p">[</span>str<span class="p">, </span>str<span class="p">]</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#find_heads_for_model_paths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.find_heads_for_model_paths" title="Permalink to this definition">¶</a></dt>
<dd><p>Given list of models paths, returns dict with path keyed by head name.</p>
</dd></dl>

<dl class="py function">
<dt id="sleap.nn.inference.get_model_output_stride">
<code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">get_model_output_stride</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span><span class="p">:</span> <span class="n">tensorflow.python.keras.engine.training.Model</span></em>, <em class="sig-param"><span class="n">input_ind</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">0</span></em>, <em class="sig-param"><span class="n">output_ind</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">- 1</span></em><span class="sig-paren">)</span> &#x2192; int<a class="reference internal" href="../_modules/sleap/nn/inference.html#get_model_output_stride"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.get_model_output_stride" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the stride (1/scale) of the model outputs relative to the input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – A <cite>tf.keras.Model</cite>.</p></li>
<li><p><strong>input_ind</strong> – The index of the input to use as reference. Defaults to 0, indicating
the first input for multi-output models.</p></li>
<li><p><strong>output_ind</strong> – The index of the output to compute the stride for. Defaults to -1,
indicating the last output for multi-output models.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>The output stride of the model computed as the integer ratio of the input’s
height relative to the output’s height, e.g., for a single input/output model:</p>
<blockquote>
<div><p><cite>model.input.shape[1] // model.output.shape[1]</cite></p>
</div></blockquote>
<p>Raises a warning if the shapes do not divide evenly.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sleap.nn.inference.load_model">
<code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">load_model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model_path</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>str<span class="p">, </span>List<span class="p">[</span>str<span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="n">refinement</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'integral'</span></em>, <em class="sig-param"><span class="n">tracker</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tracker_window</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em>, <em class="sig-param"><span class="n">tracker_max_instances</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#sleap.nn.inference.Predictor" title="sleap.nn.inference.Predictor">sleap.nn.inference.Predictor</a><a class="reference internal" href="../_modules/sleap/nn/inference.html#load_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.load_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a trained SLEAP model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_path</strong> – Path to model or list of path to models that were trained by SLEAP.
These should be the directories that contain <cite>training_job.json</cite> and
<cite>best_model.h5</cite>.</p></li>
<li><p><strong>batch_size</strong> – Number of frames to predict at a time. Larger values result in
faster inference speeds, but require more memory.</p></li>
<li><p><strong>refinement</strong> – If <cite>“integral”</cite>, peak locations will be refined with integral
regression. If <cite>“local”</cite>, peaks will be refined with quarter pixel local
gradient offset.</p></li>
<li><p><strong>tracker</strong> – Name of the tracker to use with the inference model. Must be one of
<cite>“simple”</cite> or <cite>“flow”</cite>. If <cite>None</cite>, no identity tracking across frames will
be performed.</p></li>
<li><p><strong>tracker_window</strong> – Number of frames of history to use when tracking. No effect when
<cite>tracker</cite> is <cite>None</cite>.</p></li>
<li><p><strong>tracker_max_instances</strong> – If not <cite>None</cite>, discard instances beyond this count when
tracking. No effect when <cite>tracker</cite> is <cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>An instance of a <cite>Predictor</cite> based on which model type was detected.</p>
<p>If this is a top-down model, paths to the centroids model as well as the
centered instance model must be provided. A <cite>TopdownPredictor</cite> instance will be
returned.</p>
<p>If this is a bottom-up model, a <cite>BottomupPredictor</cite> will be returned.</p>
<p>If this is a single-instance model, a <cite>SingleInstancePredictor</cite> will be
returned.</p>
<p>If a <cite>tracker</cite> is specified, the predictor will also run identity tracking over
time.</p>
</p>
</dd>
</dl>
<p>See also: TopdownPredictor, BottomupPredictor, SingleInstancePredictor</p>
</dd></dl>

<dl class="py function">
<dt id="sleap.nn.inference.main">
<code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">main</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#main"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.main" title="Permalink to this definition">¶</a></dt>
<dd><p>CLI for running inference.</p>
</dd></dl>

<dl class="py function">
<dt id="sleap.nn.inference.make_predictor_from_models">
<code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">make_predictor_from_models</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">trained_model_paths</span><span class="p">:</span> <span class="n">Dict<span class="p">[</span>str<span class="p">, </span>str<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">labels_path</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">policy_args</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>dict<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#sleap.nn.inference.Predictor" title="sleap.nn.inference.Predictor">sleap.nn.inference.Predictor</a><a class="reference internal" href="../_modules/sleap/nn/inference.html#make_predictor_from_models"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.make_predictor_from_models" title="Permalink to this definition">¶</a></dt>
<dd><p>Given dict of paths keyed by head name, returns appropriate predictor.</p>
</dd></dl>

<dl class="py function">
<dt id="sleap.nn.inference.make_predictor_from_paths">
<code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">make_predictor_from_paths</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">paths</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#sleap.nn.inference.Predictor" title="sleap.nn.inference.Predictor">sleap.nn.inference.Predictor</a><a class="reference internal" href="../_modules/sleap/nn/inference.html#make_predictor_from_paths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.make_predictor_from_paths" title="Permalink to this definition">¶</a></dt>
<dd><p>Build predictor object from a list of model paths.</p>
</dd></dl>

<dl class="py function">
<dt id="sleap.nn.inference.safely_generate">
<code class="sig-prename descclassname">sleap.nn.inference.</code><code class="sig-name descname">safely_generate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ds</span><span class="p">:</span> <span class="n">tensorflow.python.data.ops.dataset_ops.DatasetV2</span></em>, <em class="sig-param"><span class="n">progress</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sleap/nn/inference.html#safely_generate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sleap.nn.inference.safely_generate" title="Permalink to this definition">¶</a></dt>
<dd><p>Yields examples from dataset, catching and logging exceptions.</p>
</dd></dl>

</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">SLEAP</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../guides/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/index.html">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guides/reference.html">Feature Reference</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="sleap.diagnostic.html">sleap.diagnostic</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.instance.html">sleap.instance</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.message.html">sleap.message</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.prefs.html">sleap.prefs</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.rangelist.html">sleap.rangelist</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.skeleton.html">sleap.skeleton</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.util.html">sleap.util</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.version.html">sleap.version</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.asyncvideo.html">sleap.io.asyncvideo</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.convert.html">sleap.io.convert</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.dataset.html">sleap.io.dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.legacy.html">sleap.io.legacy</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.pathutils.html">sleap.io.pathutils</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.video.html">sleap.io.video</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.videowriter.html">sleap.io.videowriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.visuals.html">sleap.io.visuals</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.adaptor.html">sleap.io.format.adaptor</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.coco.html">sleap.io.format.coco</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.deeplabcut.html">sleap.io.format.deeplabcut</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.deepposekit.html">sleap.io.format.deepposekit</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.dispatch.html">sleap.io.format.dispatch</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.filehandle.html">sleap.io.format.filehandle</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.genericjson.html">sleap.io.format.genericjson</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.hdf5.html">sleap.io.format.hdf5</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.labels_json.html">sleap.io.format.labels_json</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.leap_matlab.html">sleap.io.format.leap_matlab</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.main.html">sleap.io.format.main</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.sleap_analysis.html">sleap.io.format.sleap_analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.text.html">sleap.io.format.text</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.callbacks.html">sleap.nn.callbacks</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.evals.html">sleap.nn.evals</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.heads.html">sleap.nn.heads</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">sleap.nn.inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.losses.html">sleap.nn.losses</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.model.html">sleap.nn.model</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.monitor.html">sleap.nn.monitor</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.paf_grouping.html">sleap.nn.paf_grouping</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.peak_finding.html">sleap.nn.peak_finding</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.system.html">sleap.nn.system</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.tracking.html">sleap.nn.tracking</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.training.html">sleap.nn.training</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.utils.html">sleap.nn.utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.viz.html">sleap.nn.viz</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.tracker.components.html">sleap.nn.tracker.components</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.tracker.kalman.html">sleap.nn.tracker.kalman</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.architectures.common.html">sleap.nn.architectures.common</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.architectures.encoder_decoder.html">sleap.nn.architectures.encoder_decoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.architectures.hourglass.html">sleap.nn.architectures.hourglass</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.architectures.hrnet.html">sleap.nn.architectures.hrnet</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.architectures.leap.html">sleap.nn.architectures.leap</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.architectures.pretrained_encoders.html">sleap.nn.architectures.pretrained_encoders</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.architectures.resnet.html">sleap.nn.architectures.resnet</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.architectures.unet.html">sleap.nn.architectures.unet</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.architectures.upsampling.html">sleap.nn.architectures.upsampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.augmentation.html">sleap.nn.data.augmentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.confidence_maps.html">sleap.nn.data.confidence_maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.dataset_ops.html">sleap.nn.data.dataset_ops</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.edge_maps.html">sleap.nn.data.edge_maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.general.html">sleap.nn.data.general</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.grouping.html">sleap.nn.data.grouping</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.inference.html">sleap.nn.data.inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.instance_centroids.html">sleap.nn.data.instance_centroids</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.instance_cropping.html">sleap.nn.data.instance_cropping</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.normalization.html">sleap.nn.data.normalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.pipelines.html">sleap.nn.data.pipelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.providers.html">sleap.nn.data.providers</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.resizing.html">sleap.nn.data.resizing</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.training.html">sleap.nn.data.training</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.utils.html">sleap.nn.data.utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.config.data.html">sleap.nn.config.data</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.config.model.html">sleap.nn.config.model</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.config.optimization.html">sleap.nn.config.optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.config.outputs.html">sleap.nn.config.outputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.config.training_job.html">sleap.nn.config.training_job</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.config.utils.html">sleap.nn.config.utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.info.align.html">sleap.info.align</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.info.feature_suggestions.html">sleap.info.feature_suggestions</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.info.labels.html">sleap.info.labels</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.info.metrics.html">sleap.info.metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.info.summary.html">sleap.info.summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.info.trackcleaner.html">sleap.info.trackcleaner</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.info.write_tracking_h5.html">sleap.info.write_tracking_h5</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.color.html">sleap.gui.color</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.commands.html">sleap.gui.commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.dataviews.html">sleap.gui.dataviews</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.release_checker.html">sleap.gui.release_checker</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.shortcuts.html">sleap.gui.shortcuts</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.state.html">sleap.gui.state</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.suggestions.html">sleap.gui.suggestions</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.widgets.imagedir.html">sleap.gui.widgets.imagedir</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.widgets.multicheck.html">sleap.gui.widgets.multicheck</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.widgets.slider.html">sleap.gui.widgets.slider</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.widgets.video.html">sleap.gui.widgets.video</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.learning.configs.html">sleap.gui.learning.configs</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.learning.datagen.html">sleap.gui.learning.datagen</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.learning.dialog.html">sleap.gui.learning.dialog</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.learning.receptivefield.html">sleap.gui.learning.receptivefield</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.learning.runners.html">sleap.gui.learning.runners</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.learning.scopedkeydict.html">sleap.gui.learning.scopedkeydict</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.overlays.anchors.html">sleap.gui.overlays.anchors</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.overlays.base.html">sleap.gui.overlays.base</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.overlays.confmaps.html">sleap.gui.overlays.confmaps</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.overlays.instance.html">sleap.gui.overlays.instance</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.overlays.pafs.html">sleap.gui.overlays.pafs</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.overlays.tracks.html">sleap.gui.overlays.tracks</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.dialogs.delete.html">sleap.gui.dialogs.delete</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.dialogs.export_clip.html">sleap.gui.dialogs.export_clip</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.dialogs.filedialog.html">sleap.gui.dialogs.filedialog</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.dialogs.formbuilder.html">sleap.gui.dialogs.formbuilder</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.dialogs.importvideos.html">sleap.gui.dialogs.importvideos</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.dialogs.merge.html">sleap.gui.dialogs.merge</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.dialogs.message.html">sleap.gui.dialogs.message</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.dialogs.missingfiles.html">sleap.gui.dialogs.missingfiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.gui.dialogs.shortcuts.html">sleap.gui.dialogs.shortcuts</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../api.html">Developer API</a><ul>
      <li>Previous: <a href="sleap.nn.heads.html" title="previous chapter">sleap.nn.heads</a></li>
      <li>Next: <a href="sleap.nn.losses.html" title="next chapter">sleap.nn.losses</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019–2020, Murthy Lab @ Princeton.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.4.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/_autosummary/sleap.nn.inference.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>