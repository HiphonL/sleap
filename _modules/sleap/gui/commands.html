
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>sleap.gui.commands &#8212; SLEAP  documentation</title>
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for sleap.gui.commands</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Module for gui command context and commands objects.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">attr</span>
<span class="kn">import</span> <span class="nn">operator</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABC</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">PurePath</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Iterator</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Type</span><span class="p">,</span> <span class="n">Tuple</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">PySide2</span> <span class="kn">import</span> <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtWidgets</span>

<span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="kn">import</span> <span class="n">QMessageBox</span>

<span class="kn">from</span> <span class="nn">sleap.gui.dialogs.delete</span> <span class="kn">import</span> <span class="n">DeleteDialog</span>
<span class="kn">from</span> <span class="nn">sleap.skeleton</span> <span class="kn">import</span> <span class="n">Skeleton</span>
<span class="kn">from</span> <span class="nn">sleap.instance</span> <span class="kn">import</span> <span class="n">Instance</span><span class="p">,</span> <span class="n">PredictedInstance</span><span class="p">,</span> <span class="n">Point</span><span class="p">,</span> <span class="n">Track</span><span class="p">,</span> <span class="n">LabeledFrame</span>
<span class="kn">from</span> <span class="nn">sleap.io.video</span> <span class="kn">import</span> <span class="n">Video</span>
<span class="kn">from</span> <span class="nn">sleap.io.dataset</span> <span class="kn">import</span> <span class="n">Labels</span>
<span class="kn">from</span> <span class="nn">sleap.gui.dialogs.importvideos</span> <span class="kn">import</span> <span class="n">ImportVideos</span>
<span class="kn">from</span> <span class="nn">sleap.gui.dialogs.filedialog</span> <span class="kn">import</span> <span class="n">FileDialog</span>
<span class="kn">from</span> <span class="nn">sleap.gui.dialogs.missingfiles</span> <span class="kn">import</span> <span class="n">MissingFilesDialog</span>
<span class="kn">from</span> <span class="nn">sleap.gui.dialogs.merge</span> <span class="kn">import</span> <span class="n">MergeDialog</span>
<span class="kn">from</span> <span class="nn">sleap.gui.dialogs.message</span> <span class="kn">import</span> <span class="n">MessageDialog</span>
<span class="kn">from</span> <span class="nn">sleap.gui.suggestions</span> <span class="kn">import</span> <span class="n">VideoFrameSuggestions</span>
<span class="kn">from</span> <span class="nn">sleap.gui.state</span> <span class="kn">import</span> <span class="n">GuiState</span>


<span class="n">OPEN_IN_NEW</span> <span class="o">=</span> <span class="kc">True</span>


<div class="viewcode-block" id="UpdateTopic"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.UpdateTopic">[docs]</a><span class="k">class</span> <span class="nc">UpdateTopic</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="nb">all</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">video</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">skeleton</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">on_frame</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">suggestions</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="n">tracks</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="n">frame</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">project</span> <span class="o">=</span> <span class="mi">9</span>
    <span class="n">project_instances</span> <span class="o">=</span> <span class="mi">10</span></div>


<div class="viewcode-block" id="AppCommand"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.AppCommand">[docs]</a><span class="k">class</span> <span class="nc">AppCommand</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Abstract Base Class for Commands.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        topics: List of `UpdateTopic` items. Override this to indicate what</span>
<span class="sd">            should be updated after command is executed.</span>
<span class="sd">        does_edits: Whether command will modify data that could be saved.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">topics</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">does_edits</span> <span class="o">=</span> <span class="kc">False</span>

<div class="viewcode-block" id="AppCommand.execute"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.AppCommand.execute">[docs]</a>    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="s2">&quot;CommandContext&quot;</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Entry point for running command.</span>

<span class="sd">        This calls internal methods to gather information required for</span>
<span class="sd">        execution, perform the action, and notify about changes.</span>

<span class="sd">        Ideally, any information gathering should be performed in the `ask`</span>
<span class="sd">        method, and be added to the `params` dictionary which then gets</span>
<span class="sd">        passed to `do_action`. The `ask` method should not modify state.</span>

<span class="sd">        (This will make it easier to add support for undo,</span>
<span class="sd">        using an `undo_action` which will be given the same `params`</span>
<span class="sd">        dictionary.)</span>

<span class="sd">        If it&#39;s not possible to easily separate information gathering from</span>
<span class="sd">        performing the action, the child class should implement `ask_and_do`,</span>
<span class="sd">        which it turn should call `do_with_signal` to notify about changes.</span>

<span class="sd">        Args:</span>
<span class="sd">            context: This is the `CommandContext` in which the command will</span>
<span class="sd">                execute. Commands will use this to access `MainWindow`,</span>
<span class="sd">                `GuiState`, and `Labels`.</span>
<span class="sd">            params: Dictionary of any params for command.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">params</span> <span class="ow">or</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;ask_and_do&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ask_and_do</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">okay</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">okay</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">do_with_signal</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></div>

<div class="viewcode-block" id="AppCommand.ask"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.AppCommand.ask">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">ask</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="s2">&quot;CommandContext&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Method for information gathering.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Whether to perform action. By default returns True, but this is</span>
<span class="sd">            where we should return False if we prompt user for confirmation</span>
<span class="sd">            and they abort.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="AppCommand.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.AppCommand.do_action">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="s2">&quot;CommandContext&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Method for performing action.&quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="AppCommand.do_with_signal"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.AppCommand.do_with_signal">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">do_with_signal</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="s2">&quot;CommandContext&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wrapper to perform action and notify/track changes.</span>

<span class="sd">        Don&#39;t override this method!</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">do_action</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">topics</span><span class="p">:</span>
            <span class="n">context</span><span class="o">.</span><span class="n">signal_update</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">topics</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">does_edits</span><span class="p">:</span>
            <span class="n">context</span><span class="o">.</span><span class="n">changestack_push</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span></div></div>


<span class="nd">@attr</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="n">auto_attribs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">FakeApp</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">labels</span><span class="p">:</span> <span class="n">Labels</span>


<div class="viewcode-block" id="CommandContext"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext">[docs]</a><span class="nd">@attr</span><span class="o">.</span><span class="n">s</span><span class="p">(</span><span class="n">auto_attribs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">eq</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">CommandContext</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Context within in which commands are executed.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        state: The `GuiState` object used to store state and pass messages.</span>
<span class="sd">        app: The `MainWindow`, available for commands that modify the app.</span>
<span class="sd">        update_callback: A callback to receive update notifications.</span>
<span class="sd">            This function should accept a list of `UpdateTopic` items.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">state</span><span class="p">:</span> <span class="n">GuiState</span>
    <span class="n">app</span><span class="p">:</span> <span class="s2">&quot;MainWindow&quot;</span>

    <span class="n">update_callback</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_change_stack</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="n">attr</span><span class="o">.</span><span class="n">ib</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">attr</span><span class="o">.</span><span class="n">Factory</span><span class="p">(</span><span class="nb">list</span><span class="p">))</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_labels</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">labels</span><span class="p">:</span> <span class="n">Labels</span><span class="p">):</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">GuiState</span><span class="p">()</span>
        <span class="n">app</span> <span class="o">=</span> <span class="n">FakeApp</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">,</span> <span class="n">app</span><span class="o">=</span><span class="n">app</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">labels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Alias to app.labels.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">labels</span>

<div class="viewcode-block" id="CommandContext.signal_update"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.signal_update">[docs]</a>    <span class="k">def</span> <span class="nf">signal_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">what</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">UpdateTopic</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;Calls the update callback after data has been changed.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">update_callback</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_callback</span><span class="p">(</span><span class="n">what</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.changestack_push"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.changestack_push">[docs]</a>    <span class="k">def</span> <span class="nf">changestack_push</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">change</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds to stack of changes made by user.&quot;&quot;&quot;</span>
        <span class="c1"># Currently the change doesn&#39;t store any data, and we&#39;re only using this</span>
        <span class="c1"># to determine if there are unsaved changes. Eventually we could use this</span>
        <span class="c1"># to support undo/redo.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_change_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">change</span><span class="p">)</span>
        <span class="c1"># print(len(self._change_stack))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;has_changes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="CommandContext.changestack_savepoint"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.changestack_savepoint">[docs]</a>    <span class="k">def</span> <span class="nf">changestack_savepoint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Marks that project was just saved.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">changestack_push</span><span class="p">(</span><span class="s2">&quot;SAVE&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;has_changes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="CommandContext.changestack_clear"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.changestack_clear">[docs]</a>    <span class="k">def</span> <span class="nf">changestack_clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clears stack of changes.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_change_stack</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;has_changes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="CommandContext.execute"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.execute">[docs]</a>    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">Type</span><span class="p">[</span><span class="n">AppCommand</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Execute command in this context, passing named arguments.&quot;&quot;&quot;</span>
        <span class="n">command</span><span class="p">()</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span></div>

    <span class="c1"># File commands</span>

<div class="viewcode-block" id="CommandContext.newProject"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.newProject">[docs]</a>    <span class="k">def</span> <span class="nf">newProject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new project in a new window.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">NewProject</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.openProject"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.openProject">[docs]</a>    <span class="k">def</span> <span class="nf">openProject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first_open</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Allows use to select and then open a saved project.</span>

<span class="sd">        Args:</span>
<span class="sd">            first_open: Whether this is the first window opened. If True,</span>
<span class="sd">                then the new project is loaded into the current window</span>
<span class="sd">                rather than a new application window.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">OpenProject</span><span class="p">,</span> <span class="n">first_open</span><span class="o">=</span><span class="n">first_open</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.importDPK"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.importDPK">[docs]</a>    <span class="k">def</span> <span class="nf">importDPK</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Imports DeepPoseKit datasets.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">ImportDeepPoseKit</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.importCoco"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.importCoco">[docs]</a>    <span class="k">def</span> <span class="nf">importCoco</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Imports COCO datasets.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">ImportCoco</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.importDLC"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.importDLC">[docs]</a>    <span class="k">def</span> <span class="nf">importDLC</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Imports DeepLabCut datasets.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">ImportDeepLabCut</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.importLEAP"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.importLEAP">[docs]</a>    <span class="k">def</span> <span class="nf">importLEAP</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Imports LEAP matlab datasets.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">ImportLEAP</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.importAnalysisFile"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.importAnalysisFile">[docs]</a>    <span class="k">def</span> <span class="nf">importAnalysisFile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Imports SLEAP analysis hdf5 files.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">ImportAnalysisFile</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.saveProject"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.saveProject">[docs]</a>    <span class="k">def</span> <span class="nf">saveProject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Show gui to save project (or save as if not yet saved).&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">SaveProject</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.saveProjectAs"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.saveProjectAs">[docs]</a>    <span class="k">def</span> <span class="nf">saveProjectAs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Show gui to save project as a new file.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">SaveProjectAs</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.exportAnalysisFile"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.exportAnalysisFile">[docs]</a>    <span class="k">def</span> <span class="nf">exportAnalysisFile</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Shows gui for exporting analysis h5 file.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">ExportAnalysisFile</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.exportLabeledClip"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.exportLabeledClip">[docs]</a>    <span class="k">def</span> <span class="nf">exportLabeledClip</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Shows gui for exporting clip with visual annotations.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">ExportLabeledClip</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.exportDatasetWithImages"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.exportDatasetWithImages">[docs]</a>    <span class="k">def</span> <span class="nf">exportDatasetWithImages</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gui for exporting the training dataset of labels/frame images.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">ExportDatasetWithImages</span><span class="p">)</span></div>

    <span class="c1"># Navigation Commands</span>

<div class="viewcode-block" id="CommandContext.previousLabeledFrame"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.previousLabeledFrame">[docs]</a>    <span class="k">def</span> <span class="nf">previousLabeledFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Goes to labeled frame prior to current frame.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">GoPreviousLabeledFrame</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.nextLabeledFrame"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.nextLabeledFrame">[docs]</a>    <span class="k">def</span> <span class="nf">nextLabeledFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Goes to labeled frame after current frame.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">GoNextLabeledFrame</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.nextUserLabeledFrame"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.nextUserLabeledFrame">[docs]</a>    <span class="k">def</span> <span class="nf">nextUserLabeledFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Goes to next labeled frame with user instances.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">GoNextUserLabeledFrame</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.nextSuggestedFrame"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.nextSuggestedFrame">[docs]</a>    <span class="k">def</span> <span class="nf">nextSuggestedFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Goes to next suggested frame.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">GoNextSuggestedFrame</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.prevSuggestedFrame"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.prevSuggestedFrame">[docs]</a>    <span class="k">def</span> <span class="nf">prevSuggestedFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Goes to previous suggested frame.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">GoPrevSuggestedFrame</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.nextTrackFrame"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.nextTrackFrame">[docs]</a>    <span class="k">def</span> <span class="nf">nextTrackFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Goes to next frame on which a track starts.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">GoNextTrackFrame</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.gotoFrame"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.gotoFrame">[docs]</a>    <span class="k">def</span> <span class="nf">gotoFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Shows gui to go to frame by number.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">GoFrameGui</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.selectToFrame"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.selectToFrame">[docs]</a>    <span class="k">def</span> <span class="nf">selectToFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Shows gui to go to frame by number.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">SelectToFrameGui</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.gotoVideoAndFrame"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.gotoVideoAndFrame">[docs]</a>    <span class="k">def</span> <span class="nf">gotoVideoAndFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">video</span><span class="p">:</span> <span class="n">Video</span><span class="p">,</span> <span class="n">frame_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Activates video and goes to frame.&quot;&quot;&quot;</span>
        <span class="n">NavCommand</span><span class="o">.</span><span class="n">go_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame_idx</span><span class="p">,</span> <span class="n">video</span><span class="p">)</span></div>

    <span class="c1"># Editing Commands</span>

<div class="viewcode-block" id="CommandContext.addVideo"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.addVideo">[docs]</a>    <span class="k">def</span> <span class="nf">addVideo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Shows gui for adding videos to project.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">AddVideo</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.replaceVideo"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.replaceVideo">[docs]</a>    <span class="k">def</span> <span class="nf">replaceVideo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Shows gui for replacing videos to project.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">ReplaceVideo</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.removeVideo"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.removeVideo">[docs]</a>    <span class="k">def</span> <span class="nf">removeVideo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Removes selected video from project.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">RemoveVideo</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.openSkeleton"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.openSkeleton">[docs]</a>    <span class="k">def</span> <span class="nf">openSkeleton</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Shows gui for loading saved skeleton into project.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">OpenSkeleton</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.saveSkeleton"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.saveSkeleton">[docs]</a>    <span class="k">def</span> <span class="nf">saveSkeleton</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Shows gui for saving skeleton from project.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">SaveSkeleton</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.newNode"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.newNode">[docs]</a>    <span class="k">def</span> <span class="nf">newNode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds new node to skeleton.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">NewNode</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.deleteNode"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.deleteNode">[docs]</a>    <span class="k">def</span> <span class="nf">deleteNode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Removes (currently selected) node from skeleton.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">DeleteNode</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.setNodeName"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.setNodeName">[docs]</a>    <span class="k">def</span> <span class="nf">setNodeName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">skeleton</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Changes name of node in skeleton.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">SetNodeName</span><span class="p">,</span> <span class="n">skeleton</span><span class="o">=</span><span class="n">skeleton</span><span class="p">,</span> <span class="n">node</span><span class="o">=</span><span class="n">node</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.setNodeSymmetry"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.setNodeSymmetry">[docs]</a>    <span class="k">def</span> <span class="nf">setNodeSymmetry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">skeleton</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">symmetry</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets node symmetry in skeleton.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">SetNodeSymmetry</span><span class="p">,</span> <span class="n">skeleton</span><span class="o">=</span><span class="n">skeleton</span><span class="p">,</span> <span class="n">node</span><span class="o">=</span><span class="n">node</span><span class="p">,</span> <span class="n">symmetry</span><span class="o">=</span><span class="n">symmetry</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.updateEdges"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.updateEdges">[docs]</a>    <span class="k">def</span> <span class="nf">updateEdges</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Called when edges in skeleton have been changed.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">signal_update</span><span class="p">([</span><span class="n">UpdateTopic</span><span class="o">.</span><span class="n">skeleton</span><span class="p">])</span></div>

<div class="viewcode-block" id="CommandContext.newEdge"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.newEdge">[docs]</a>    <span class="k">def</span> <span class="nf">newEdge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">src_node</span><span class="p">,</span> <span class="n">dst_node</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds new edge to skeleton.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">NewEdge</span><span class="p">,</span> <span class="n">src_node</span><span class="o">=</span><span class="n">src_node</span><span class="p">,</span> <span class="n">dst_node</span><span class="o">=</span><span class="n">dst_node</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.deleteEdge"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.deleteEdge">[docs]</a>    <span class="k">def</span> <span class="nf">deleteEdge</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Removes (currently selected) edge from skeleton.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">DeleteEdge</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.deletePredictions"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.deletePredictions">[docs]</a>    <span class="k">def</span> <span class="nf">deletePredictions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deletes all predicted instances in project.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">DeleteAllPredictions</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.deleteFramePredictions"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.deleteFramePredictions">[docs]</a>    <span class="k">def</span> <span class="nf">deleteFramePredictions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deletes all predictions on current frame.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">DeleteFramePredictions</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.deleteClipPredictions"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.deleteClipPredictions">[docs]</a>    <span class="k">def</span> <span class="nf">deleteClipPredictions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deletes all predictions within selected range of video frames.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">DeleteClipPredictions</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.deleteAreaPredictions"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.deleteAreaPredictions">[docs]</a>    <span class="k">def</span> <span class="nf">deleteAreaPredictions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gui for deleting instances within some rect on frame images.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">DeleteAreaPredictions</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.deleteLowScorePredictions"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.deleteLowScorePredictions">[docs]</a>    <span class="k">def</span> <span class="nf">deleteLowScorePredictions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gui for deleting instances below some score threshold.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">DeleteLowScorePredictions</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.deleteFrameLimitPredictions"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.deleteFrameLimitPredictions">[docs]</a>    <span class="k">def</span> <span class="nf">deleteFrameLimitPredictions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gui for deleting instances beyond some number in each frame.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">DeleteFrameLimitPredictions</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.completeInstanceNodes"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.completeInstanceNodes">[docs]</a>    <span class="k">def</span> <span class="nf">completeInstanceNodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">:</span> <span class="n">Instance</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds missing nodes to given instance.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">AddMissingInstanceNodes</span><span class="p">,</span> <span class="n">instance</span><span class="o">=</span><span class="n">instance</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.newInstance"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.newInstance">[docs]</a>    <span class="k">def</span> <span class="nf">newInstance</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">copy_instance</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Instance</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">init_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;best&quot;</span><span class="p">,</span>
        <span class="n">location</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">QtCore</span><span class="o">.</span><span class="n">QPoint</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">mark_complete</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a new instance, copying node coordinates as appropriate.</span>

<span class="sd">        Args:</span>
<span class="sd">            copy_instance: The :class:`Instance` (or</span>
<span class="sd">                :class:`PredictedInstance`) which we want to copy.</span>
<span class="sd">            init_method: Method to use for positioning nodes.</span>
<span class="sd">            location: The location where instance should be added (if node init</span>
<span class="sd">                method supports custom location).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
            <span class="n">AddInstance</span><span class="p">,</span>
            <span class="n">copy_instance</span><span class="o">=</span><span class="n">copy_instance</span><span class="p">,</span>
            <span class="n">init_method</span><span class="o">=</span><span class="n">init_method</span><span class="p">,</span>
            <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">,</span>
            <span class="n">mark_complete</span><span class="o">=</span><span class="n">mark_complete</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.setPointLocations"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.setPointLocations">[docs]</a>    <span class="k">def</span> <span class="nf">setPointLocations</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">:</span> <span class="n">Instance</span><span class="p">,</span> <span class="n">nodes_locations</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="s2">&quot;Node&quot;</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets locations for node(s) for an instance.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
            <span class="n">SetInstancePointLocations</span><span class="p">,</span>
            <span class="n">instance</span><span class="o">=</span><span class="n">instance</span><span class="p">,</span>
            <span class="n">nodes_locations</span><span class="o">=</span><span class="n">nodes_locations</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.setInstancePointVisibility"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.setInstancePointVisibility">[docs]</a>    <span class="k">def</span> <span class="nf">setInstancePointVisibility</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">:</span> <span class="n">Instance</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="s2">&quot;Node&quot;</span><span class="p">,</span> <span class="n">visible</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Toggles visibility set for a node for an instance.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
            <span class="n">SetInstancePointVisibility</span><span class="p">,</span> <span class="n">instance</span><span class="o">=</span><span class="n">instance</span><span class="p">,</span> <span class="n">node</span><span class="o">=</span><span class="n">node</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="n">visible</span>
        <span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">addUserInstancesFromPredictions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">AddUserInstancesFromPredictions</span><span class="p">)</span>

<div class="viewcode-block" id="CommandContext.deleteSelectedInstance"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.deleteSelectedInstance">[docs]</a>    <span class="k">def</span> <span class="nf">deleteSelectedInstance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deletes currently selected instance.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">DeleteSelectedInstance</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.deleteSelectedInstanceTrack"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.deleteSelectedInstanceTrack">[docs]</a>    <span class="k">def</span> <span class="nf">deleteSelectedInstanceTrack</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deletes all instances from track of currently selected instance.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">DeleteSelectedInstanceTrack</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.deleteDialog"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.deleteDialog">[docs]</a>    <span class="k">def</span> <span class="nf">deleteDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deletes using options selected in a dialog.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">DeleteDialogCommand</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.addTrack"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.addTrack">[docs]</a>    <span class="k">def</span> <span class="nf">addTrack</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates new track and moves selected instance into this track.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">AddTrack</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.setInstanceTrack"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.setInstanceTrack">[docs]</a>    <span class="k">def</span> <span class="nf">setInstanceTrack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_track</span><span class="p">:</span> <span class="s2">&quot;Track&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets track for selected instance.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">SetSelectedInstanceTrack</span><span class="p">,</span> <span class="n">new_track</span><span class="o">=</span><span class="n">new_track</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.setTrackName"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.setTrackName">[docs]</a>    <span class="k">def</span> <span class="nf">setTrackName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">track</span><span class="p">:</span> <span class="s2">&quot;Track&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets name for track.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">SetTrackName</span><span class="p">,</span> <span class="n">track</span><span class="o">=</span><span class="n">track</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.transposeInstance"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.transposeInstance">[docs]</a>    <span class="k">def</span> <span class="nf">transposeInstance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Transposes tracks for two instances.</span>

<span class="sd">        If there are only two instances, then this swaps tracks.</span>
<span class="sd">        Otherwise, it allows user to select the instances for which we want</span>
<span class="sd">        to swap tracks.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">TransposeInstances</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.importPredictions"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.importPredictions">[docs]</a>    <span class="k">def</span> <span class="nf">importPredictions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Starts gui for importing another dataset into currently one.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">MergeProject</span><span class="p">)</span></div>

<div class="viewcode-block" id="CommandContext.generateSuggestions"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.CommandContext.generateSuggestions">[docs]</a>    <span class="k">def</span> <span class="nf">generateSuggestions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generates suggestions using given params dictionary.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">GenerateSuggestions</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span></div></div>


<span class="c1"># File Commands</span>


<div class="viewcode-block" id="NewProject"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.NewProject">[docs]</a><span class="k">class</span> <span class="nc">NewProject</span><span class="p">(</span><span class="n">AppCommand</span><span class="p">):</span>
<div class="viewcode-block" id="NewProject.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.NewProject.do_action">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">window</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="n">window</span><span class="o">.</span><span class="n">showMaximized</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="OpenProject"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.OpenProject">[docs]</a><span class="k">class</span> <span class="nc">OpenProject</span><span class="p">(</span><span class="n">AppCommand</span><span class="p">):</span>
<div class="viewcode-block" id="OpenProject.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.OpenProject.do_action">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="s2">&quot;CommandContext&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">OPEN_IN_NEW</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;first_open&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="n">new_window</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
            <span class="n">new_window</span><span class="o">.</span><span class="n">showMaximized</span><span class="p">()</span>
            <span class="n">new_window</span><span class="o">.</span><span class="n">loadProjectFile</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">loadProjectFile</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></div>

<div class="viewcode-block" id="OpenProject.ask"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.OpenProject.ask">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">ask</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="s2">&quot;CommandContext&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;SLEAP HDF5 dataset (*.slp *.h5 *.hdf5)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;JSON labels (*.json *.json.zip)&quot;</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="n">filename</span><span class="p">,</span> <span class="n">selected_filter</span> <span class="o">=</span> <span class="n">FileDialog</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
            <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="p">,</span>
            <span class="nb">dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">caption</span><span class="o">=</span><span class="s2">&quot;Import labeled data...&quot;</span><span class="p">,</span>
            <span class="nb">filter</span><span class="o">=</span><span class="s2">&quot;;;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filters</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="k">return</span> <span class="kc">True</span></div></div>


<div class="viewcode-block" id="ImportDeepPoseKit"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.ImportDeepPoseKit">[docs]</a><span class="k">class</span> <span class="nc">ImportDeepPoseKit</span><span class="p">(</span><span class="n">AppCommand</span><span class="p">):</span>
<div class="viewcode-block" id="ImportDeepPoseKit.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.ImportDeepPoseKit.do_action">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="s2">&quot;CommandContext&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>

        <span class="n">labels</span> <span class="o">=</span> <span class="n">Labels</span><span class="o">.</span><span class="n">from_deepposekit</span><span class="p">(</span>
            <span class="n">filename</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">],</span>
            <span class="n">video_path</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;video_path&quot;</span><span class="p">],</span>
            <span class="n">skeleton_path</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;skeleton_path&quot;</span><span class="p">],</span>
        <span class="p">)</span>

        <span class="n">new_window</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="n">new_window</span><span class="o">.</span><span class="n">showMaximized</span><span class="p">()</span>
        <span class="n">new_window</span><span class="o">.</span><span class="n">loadLabelsObject</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span></div>

<div class="viewcode-block" id="ImportDeepPoseKit.ask"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.ImportDeepPoseKit.ask">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">ask</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="s2">&quot;CommandContext&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;HDF5 (*.h5 *.hdf5)&quot;</span><span class="p">]</span>

        <span class="n">filename</span><span class="p">,</span> <span class="n">selected_filter</span> <span class="o">=</span> <span class="n">FileDialog</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
            <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="p">,</span>
            <span class="nb">dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">caption</span><span class="o">=</span><span class="s2">&quot;Import DeepPoseKit dataset...&quot;</span><span class="p">,</span>
            <span class="nb">filter</span><span class="o">=</span><span class="s2">&quot;;;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filters</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">file_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">paths</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">file_dir</span><span class="p">,</span> <span class="s2">&quot;video.mp4&quot;</span><span class="p">),</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">file_dir</span><span class="p">,</span> <span class="s2">&quot;skeleton.csv&quot;</span><span class="p">),</span>
        <span class="p">]</span>

        <span class="n">missing</span> <span class="o">=</span> <span class="p">[</span><span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">paths</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">missing</span><span class="p">):</span>
            <span class="n">okay</span> <span class="o">=</span> <span class="n">MissingFilesDialog</span><span class="p">(</span><span class="n">filenames</span><span class="o">=</span><span class="n">paths</span><span class="p">,</span> <span class="n">missing</span><span class="o">=</span><span class="n">missing</span><span class="p">)</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">okay</span> <span class="ow">or</span> <span class="nb">sum</span><span class="p">(</span><span class="n">missing</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;video_path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;skeleton_path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paths</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">return</span> <span class="kc">True</span></div></div>


<div class="viewcode-block" id="ImportLEAP"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.ImportLEAP">[docs]</a><span class="k">class</span> <span class="nc">ImportLEAP</span><span class="p">(</span><span class="n">AppCommand</span><span class="p">):</span>
<div class="viewcode-block" id="ImportLEAP.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.ImportLEAP.do_action">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="s2">&quot;CommandContext&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>

        <span class="n">labels</span> <span class="o">=</span> <span class="n">Labels</span><span class="o">.</span><span class="n">load_leap_matlab</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">],)</span>

        <span class="n">new_window</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="n">new_window</span><span class="o">.</span><span class="n">showMaximized</span><span class="p">()</span>
        <span class="n">new_window</span><span class="o">.</span><span class="n">loadLabelsObject</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span></div>

<div class="viewcode-block" id="ImportLEAP.ask"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.ImportLEAP.ask">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">ask</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="s2">&quot;CommandContext&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Matlab (*.mat)&quot;</span><span class="p">]</span>

        <span class="n">filename</span><span class="p">,</span> <span class="n">selected_filter</span> <span class="o">=</span> <span class="n">FileDialog</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
            <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="p">,</span>
            <span class="nb">dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">caption</span><span class="o">=</span><span class="s2">&quot;Import LEAP Matlab dataset...&quot;</span><span class="p">,</span>
            <span class="nb">filter</span><span class="o">=</span><span class="s2">&quot;;;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filters</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filename</span>

        <span class="k">return</span> <span class="kc">True</span></div></div>


<div class="viewcode-block" id="ImportCoco"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.ImportCoco">[docs]</a><span class="k">class</span> <span class="nc">ImportCoco</span><span class="p">(</span><span class="n">AppCommand</span><span class="p">):</span>
<div class="viewcode-block" id="ImportCoco.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.ImportCoco.do_action">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="s2">&quot;CommandContext&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>

        <span class="n">labels</span> <span class="o">=</span> <span class="n">Labels</span><span class="o">.</span><span class="n">load_coco</span><span class="p">(</span>
            <span class="n">filename</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">],</span> <span class="n">img_dir</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;img_dir&quot;</span><span class="p">],</span> <span class="n">use_missing_gui</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

        <span class="n">new_window</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="n">new_window</span><span class="o">.</span><span class="n">showMaximized</span><span class="p">()</span>
        <span class="n">new_window</span><span class="o">.</span><span class="n">loadLabelsObject</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span></div>

<div class="viewcode-block" id="ImportCoco.ask"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.ImportCoco.ask">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">ask</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="s2">&quot;CommandContext&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;JSON (*.json)&quot;</span><span class="p">]</span>

        <span class="n">filename</span><span class="p">,</span> <span class="n">selected_filter</span> <span class="o">=</span> <span class="n">FileDialog</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
            <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="p">,</span>
            <span class="nb">dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">caption</span><span class="o">=</span><span class="s2">&quot;Import COCO dataset...&quot;</span><span class="p">,</span>
            <span class="nb">filter</span><span class="o">=</span><span class="s2">&quot;;;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filters</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># QtWidgets.QMessageBox(</span>
        <span class="c1">#     text=&quot;Please locate the directory with image files for this dataset.&quot;</span>
        <span class="c1"># ).exec_()</span>
        <span class="c1">#</span>
        <span class="c1"># img_dir = FileDialog.openDir(</span>
        <span class="c1">#     None,</span>
        <span class="c1">#     directory=os.path.dirname(filename),</span>
        <span class="c1">#     caption=&quot;Open Image Directory&quot;</span>
        <span class="c1"># )</span>
        <span class="c1"># if len(img_dir) == 0:</span>
        <span class="c1">#     return False</span>

        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;img_dir&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

        <span class="k">return</span> <span class="kc">True</span></div></div>


<div class="viewcode-block" id="ImportDeepLabCut"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.ImportDeepLabCut">[docs]</a><span class="k">class</span> <span class="nc">ImportDeepLabCut</span><span class="p">(</span><span class="n">AppCommand</span><span class="p">):</span>
<div class="viewcode-block" id="ImportDeepLabCut.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.ImportDeepLabCut.do_action">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="s2">&quot;CommandContext&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>

        <span class="n">labels</span> <span class="o">=</span> <span class="n">Labels</span><span class="o">.</span><span class="n">load_deeplabcut</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">])</span>

        <span class="n">new_window</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="n">new_window</span><span class="o">.</span><span class="n">showMaximized</span><span class="p">()</span>
        <span class="n">new_window</span><span class="o">.</span><span class="n">loadLabelsObject</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span></div>

<div class="viewcode-block" id="ImportDeepLabCut.ask"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.ImportDeepLabCut.ask">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">ask</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="s2">&quot;CommandContext&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;DeepLabCut dataset (*.yaml *.csv)&quot;</span><span class="p">]</span>

        <span class="n">filename</span><span class="p">,</span> <span class="n">selected_filter</span> <span class="o">=</span> <span class="n">FileDialog</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
            <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="p">,</span>
            <span class="nb">dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">caption</span><span class="o">=</span><span class="s2">&quot;Import DeepLabCut dataset...&quot;</span><span class="p">,</span>
            <span class="nb">filter</span><span class="o">=</span><span class="s2">&quot;;;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filters</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filename</span>

        <span class="k">return</span> <span class="kc">True</span></div></div>


<div class="viewcode-block" id="ImportAnalysisFile"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.ImportAnalysisFile">[docs]</a><span class="k">class</span> <span class="nc">ImportAnalysisFile</span><span class="p">(</span><span class="n">AppCommand</span><span class="p">):</span>
<div class="viewcode-block" id="ImportAnalysisFile.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.ImportAnalysisFile.do_action">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="s2">&quot;CommandContext&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sleap.io.format</span> <span class="kn">import</span> <span class="n">read</span>

        <span class="n">labels</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">],</span>
            <span class="n">for_object</span><span class="o">=</span><span class="s2">&quot;labels&quot;</span><span class="p">,</span>
            <span class="n">as_format</span><span class="o">=</span><span class="s2">&quot;analysis&quot;</span><span class="p">,</span>
            <span class="n">video</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;video&quot;</span><span class="p">],</span>
        <span class="p">)</span>

        <span class="n">new_window</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="vm">__class__</span><span class="p">()</span>
        <span class="n">new_window</span><span class="o">.</span><span class="n">showMaximized</span><span class="p">()</span>
        <span class="n">new_window</span><span class="o">.</span><span class="n">loadLabelsObject</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span></div>

<div class="viewcode-block" id="ImportAnalysisFile.ask"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.ImportAnalysisFile.ask">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">ask</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="s2">&quot;CommandContext&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">filename</span><span class="p">,</span> <span class="n">selected_filter</span> <span class="o">=</span> <span class="n">FileDialog</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
            <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="p">,</span>
            <span class="nb">dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">caption</span><span class="o">=</span><span class="s2">&quot;Import SLEAP Analysis HDF5...&quot;</span><span class="p">,</span>
            <span class="nb">filter</span><span class="o">=</span><span class="s2">&quot;SLEAP Analysis HDF5 (*.h5 *.hdf5)&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMessageBox</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s2">&quot;Please locate the video for this dataset.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>

        <span class="n">video_param_list</span> <span class="o">=</span> <span class="n">ImportVideos</span><span class="p">()</span><span class="o">.</span><span class="n">ask</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">video_param_list</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;video&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ImportVideos</span><span class="o">.</span><span class="n">create_video</span><span class="p">(</span><span class="n">video_param_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="k">return</span> <span class="kc">True</span></div></div>


<div class="viewcode-block" id="SaveProjectAs"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.SaveProjectAs">[docs]</a><span class="k">class</span> <span class="nc">SaveProjectAs</span><span class="p">(</span><span class="n">AppCommand</span><span class="p">):</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_try_save</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">labels</span><span class="p">:</span> <span class="n">Labels</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Helper function which attempts save and handles errors.&quot;&quot;&quot;</span>
        <span class="n">success</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">Labels</span><span class="o">.</span><span class="n">save_file</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span>
            <span class="n">success</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="c1"># Mark savepoint in change stack</span>
            <span class="n">context</span><span class="o">.</span><span class="n">changestack_savepoint</span><span class="p">()</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;An error occured when attempting to save:</span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
            <span class="n">message</span> <span class="o">+=</span> <span class="s2">&quot;Try saving your project with a different filename or in a different format.&quot;</span>
            <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMessageBox</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">message</span><span class="p">)</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>

        <span class="c1"># Redraw. Not sure why, but sometimes we need to do this.</span>
        <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">plotFrame</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">success</span>

<div class="viewcode-block" id="SaveProjectAs.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.SaveProjectAs.do_action">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_try_save</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">]):</span>
            <span class="c1"># If save was successful</span>
            <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">]</span></div>

<div class="viewcode-block" id="SaveProjectAs.ask"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.SaveProjectAs.ask">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">ask</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">default_name</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="s2">&quot;untitled&quot;</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">PurePath</span><span class="p">(</span><span class="n">default_name</span><span class="p">)</span>
        <span class="n">default_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">with_name</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">p</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2"> copy</span><span class="si">{</span><span class="n">p</span><span class="o">.</span><span class="n">suffix</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>

        <span class="n">filters</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;SLEAP HDF5 dataset (*.slp)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;SLEAP JSON dataset (*.json)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Compressed JSON (*.zip)&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="n">filename</span><span class="p">,</span> <span class="n">selected_filter</span> <span class="o">=</span> <span class="n">FileDialog</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
            <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="p">,</span>
            <span class="n">caption</span><span class="o">=</span><span class="s2">&quot;Save As...&quot;</span><span class="p">,</span>
            <span class="nb">dir</span><span class="o">=</span><span class="n">default_name</span><span class="p">,</span>
            <span class="nb">filter</span><span class="o">=</span><span class="s2">&quot;;;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filters</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="k">return</span> <span class="kc">True</span></div></div>


<div class="viewcode-block" id="ExportAnalysisFile"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.ExportAnalysisFile">[docs]</a><span class="k">class</span> <span class="nc">ExportAnalysisFile</span><span class="p">(</span><span class="n">AppCommand</span><span class="p">):</span>
<div class="viewcode-block" id="ExportAnalysisFile.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.ExportAnalysisFile.do_action">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sleap.io.format.sleap_analysis</span> <span class="kn">import</span> <span class="n">SleapAnalysisAdaptor</span>

        <span class="n">SleapAnalysisAdaptor</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;output_path&quot;</span><span class="p">],</span> <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="p">)</span></div>

<div class="viewcode-block" id="ExportAnalysisFile.ask"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.ExportAnalysisFile.ask">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">ask</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">default_name</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="s2">&quot;untitled&quot;</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">PurePath</span><span class="p">(</span><span class="n">default_name</span><span class="p">)</span>
        <span class="n">default_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">with_name</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">p</span><span class="o">.</span><span class="n">stem</span><span class="si">}</span><span class="s2">.analysis.h5&quot;</span><span class="p">))</span>

        <span class="n">filename</span><span class="p">,</span> <span class="n">selected_filter</span> <span class="o">=</span> <span class="n">FileDialog</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
            <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="p">,</span>
            <span class="n">caption</span><span class="o">=</span><span class="s2">&quot;Export Analysis File...&quot;</span><span class="p">,</span>
            <span class="nb">dir</span><span class="o">=</span><span class="n">default_name</span><span class="p">,</span>
            <span class="nb">filter</span><span class="o">=</span><span class="s2">&quot;SLEAP Analysis HDF5 (*.h5)&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;output_path&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="k">return</span> <span class="kc">True</span></div></div>


<div class="viewcode-block" id="SaveProject"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.SaveProject">[docs]</a><span class="k">class</span> <span class="nc">SaveProject</span><span class="p">(</span><span class="n">SaveProjectAs</span><span class="p">):</span>
<div class="viewcode-block" id="SaveProject.ask"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.SaveProject.ask">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">ask</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">]</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="c1"># No filename (must be new project), so treat as &quot;Save as&quot;</span>
        <span class="k">return</span> <span class="n">SaveProjectAs</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="ExportLabeledClip"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.ExportLabeledClip">[docs]</a><span class="k">class</span> <span class="nc">ExportLabeledClip</span><span class="p">(</span><span class="n">AppCommand</span><span class="p">):</span>
<div class="viewcode-block" id="ExportLabeledClip.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.ExportLabeledClip.do_action">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sleap.io.visuals</span> <span class="kn">import</span> <span class="n">save_labeled_video</span>

        <span class="n">save_labeled_video</span><span class="p">(</span>
            <span class="n">filename</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">],</span>
            <span class="n">labels</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">],</span>
            <span class="n">video</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;video&quot;</span><span class="p">],</span>
            <span class="n">frames</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">*</span><span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;frame_range&quot;</span><span class="p">])),</span>
            <span class="n">fps</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;fps&quot;</span><span class="p">],</span>
            <span class="n">gui_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;open_when_done&quot;</span><span class="p">]:</span>
            <span class="c1"># Open the file using default video playing app</span>
            <span class="kn">from</span> <span class="nn">sleap.util</span> <span class="kn">import</span> <span class="n">open_file</span>

            <span class="n">open_file</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">])</span></div>

<div class="viewcode-block" id="ExportLabeledClip.ask"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.ExportLabeledClip.ask">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">ask</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;has_frame_range&quot;</span><span class="p">]:</span>

            <span class="kn">from</span> <span class="nn">sleap.gui.dialogs.export_clip</span> <span class="kn">import</span> <span class="n">ExportClipDialog</span>

            <span class="n">dialog</span> <span class="o">=</span> <span class="n">ExportClipDialog</span><span class="p">()</span>

            <span class="c1"># Set default fps from video (if video has fps attribute)</span>
            <span class="n">dialog</span><span class="o">.</span><span class="n">form_widget</span><span class="o">.</span><span class="n">set_form_data</span><span class="p">(</span>
                <span class="nb">dict</span><span class="p">(</span><span class="n">fps</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;video&quot;</span><span class="p">],</span> <span class="s2">&quot;fps&quot;</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
            <span class="p">)</span>

            <span class="c1"># Show modal dialog and get form results</span>
            <span class="n">export_options</span> <span class="o">=</span> <span class="n">dialog</span><span class="o">.</span><span class="n">get_results</span><span class="p">()</span>

            <span class="c1"># Check if user hit cancel</span>
            <span class="k">if</span> <span class="n">export_options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>

            <span class="c1"># Use VideoWriter to determine default video type to use</span>
            <span class="kn">from</span> <span class="nn">sleap.io.videowriter</span> <span class="kn">import</span> <span class="n">VideoWriter</span>

            <span class="c1"># For OpenCV we default to avi since the bundled ffmpeg</span>
            <span class="c1"># makes mp4&#39;s that most programs can&#39;t open (VLC can).</span>
            <span class="n">default_out_filename</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;.avi&quot;</span>

            <span class="c1"># But if we can write mpegs using sci-kit video, use .mp4</span>
            <span class="c1"># since it has trouble writing .avi files.</span>
            <span class="k">if</span> <span class="n">VideoWriter</span><span class="o">.</span><span class="n">can_use_skvideo</span><span class="p">():</span>
                <span class="n">default_out_filename</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;.mp4&quot;</span>

            <span class="c1"># Ask where use wants to save video file</span>
            <span class="n">filename</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">FileDialog</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
                <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="p">,</span>
                <span class="n">caption</span><span class="o">=</span><span class="s2">&quot;Save Video As...&quot;</span><span class="p">,</span>
                <span class="nb">dir</span><span class="o">=</span><span class="n">default_out_filename</span><span class="p">,</span>
                <span class="nb">filter</span><span class="o">=</span><span class="s2">&quot;Video (*.avi *mp4)&quot;</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="c1"># Check if user hit cancel</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>

            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filename</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;fps&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">export_options</span><span class="p">[</span><span class="s2">&quot;fps&quot;</span><span class="p">]</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;open_when_done&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">export_options</span><span class="p">[</span><span class="s2">&quot;open_when_done&quot;</span><span class="p">]</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;There is no selected clip. You can select a clip by &quot;</span>
                <span class="s2">&quot;shift-dragging over the range of frames in the video &quot;</span>
                <span class="s2">&quot;seekbar.&quot;</span>
            <span class="p">)</span>
            <span class="n">QMessageBox</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">message</span><span class="p">)</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
            <span class="k">return</span> <span class="kc">False</span></div></div>


<div class="viewcode-block" id="ExportDatasetWithImages"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.ExportDatasetWithImages">[docs]</a><span class="k">class</span> <span class="nc">ExportDatasetWithImages</span><span class="p">(</span><span class="n">AppCommand</span><span class="p">):</span>
<div class="viewcode-block" id="ExportDatasetWithImages.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.ExportDatasetWithImages.do_action">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">win</span> <span class="o">=</span> <span class="n">MessageDialog</span><span class="p">(</span><span class="s2">&quot;Exporting dataset with frame images...&quot;</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="p">)</span>

        <span class="n">Labels</span><span class="o">.</span><span class="n">save_file</span><span class="p">(</span>
            <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;labels&quot;</span><span class="p">],</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">],</span>
            <span class="n">default_suffix</span><span class="o">=</span><span class="s2">&quot;slp&quot;</span><span class="p">,</span>
            <span class="n">save_frame_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">win</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span></div>

<div class="viewcode-block" id="ExportDatasetWithImages.ask"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.ExportDatasetWithImages.ask">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">ask</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;SLEAP HDF5 dataset (*.slp *.h5)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Compressed JSON dataset (*.json *.json.zip)&quot;</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="n">dirname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">])</span>
        <span class="n">basename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">])</span>

        <span class="n">new_basename</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">basename</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">.pkg.slp&quot;</span>
        <span class="n">new_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirname</span><span class="p">,</span> <span class="n">new_basename</span><span class="p">)</span>

        <span class="n">filename</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">FileDialog</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
            <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="p">,</span>
            <span class="n">caption</span><span class="o">=</span><span class="s2">&quot;Save Labeled Frames As...&quot;</span><span class="p">,</span>
            <span class="nb">dir</span><span class="o">=</span><span class="n">new_filename</span><span class="p">,</span>
            <span class="n">filters</span><span class="o">=</span><span class="s2">&quot;;;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filters</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="k">return</span> <span class="kc">True</span></div></div>


<span class="c1"># Navigation Commands</span>


<div class="viewcode-block" id="GoIteratorCommand"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.GoIteratorCommand">[docs]</a><span class="k">class</span> <span class="nc">GoIteratorCommand</span><span class="p">(</span><span class="n">AppCommand</span><span class="p">):</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_plot_if_next</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">frame_iterator</span><span class="p">:</span> <span class="n">Iterator</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Plots next frame (if there is one) from iterator.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            frame_iterator: The iterator from which we&#39;ll try to get next</span>
<span class="sd">            :class:`LabeledFrame`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if we went to next frame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">next_lf</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">frame_iterator</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;frame_idx&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">next_lf</span><span class="o">.</span><span class="n">frame_idx</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_frame_iterator</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Call to virtual method.&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="GoIteratorCommand.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.GoIteratorCommand.do_action">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">frames</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_get_frame_iterator</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_plot_if_next</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">frames</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="GoPreviousLabeledFrame"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.GoPreviousLabeledFrame">[docs]</a><span class="k">class</span> <span class="nc">GoPreviousLabeledFrame</span><span class="p">(</span><span class="n">GoIteratorCommand</span><span class="p">):</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_frame_iterator</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">frames</span><span class="p">(</span>
            <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;video&quot;</span><span class="p">],</span>
            <span class="n">from_frame_idx</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;frame_idx&quot;</span><span class="p">],</span>
            <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="GoNextLabeledFrame"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.GoNextLabeledFrame">[docs]</a><span class="k">class</span> <span class="nc">GoNextLabeledFrame</span><span class="p">(</span><span class="n">GoIteratorCommand</span><span class="p">):</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_frame_iterator</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">frames</span><span class="p">(</span>
            <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;video&quot;</span><span class="p">],</span> <span class="n">from_frame_idx</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;frame_idx&quot;</span><span class="p">]</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="GoNextUserLabeledFrame"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.GoNextUserLabeledFrame">[docs]</a><span class="k">class</span> <span class="nc">GoNextUserLabeledFrame</span><span class="p">(</span><span class="n">GoIteratorCommand</span><span class="p">):</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_get_frame_iterator</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">):</span>
        <span class="n">frames</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">frames</span><span class="p">(</span>
            <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;video&quot;</span><span class="p">],</span> <span class="n">from_frame_idx</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;frame_idx&quot;</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="c1"># Filter to frames with user instances</span>
        <span class="n">frames</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">lf</span><span class="p">:</span> <span class="n">lf</span><span class="o">.</span><span class="n">has_user_instances</span><span class="p">,</span> <span class="n">frames</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">frames</span></div>


<div class="viewcode-block" id="NavCommand"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.NavCommand">[docs]</a><span class="k">class</span> <span class="nc">NavCommand</span><span class="p">(</span><span class="n">AppCommand</span><span class="p">):</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">go_to</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">frame_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">video</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Video</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">video</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;video&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">video</span>
        <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;frame_idx&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">frame_idx</span></div>


<div class="viewcode-block" id="GoNextSuggestedFrame"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.GoNextSuggestedFrame">[docs]</a><span class="k">class</span> <span class="nc">GoNextSuggestedFrame</span><span class="p">(</span><span class="n">NavCommand</span><span class="p">):</span>
    <span class="n">seek_direction</span> <span class="o">=</span> <span class="mi">1</span>

<div class="viewcode-block" id="GoNextSuggestedFrame.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.GoNextSuggestedFrame.do_action">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>

        <span class="n">next_suggestion_frame</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">get_next_suggestion</span><span class="p">(</span>
            <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;video&quot;</span><span class="p">],</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;frame_idx&quot;</span><span class="p">],</span> <span class="bp">cls</span><span class="o">.</span><span class="n">seek_direction</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">next_suggestion_frame</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">go_to</span><span class="p">(</span>
                <span class="n">context</span><span class="p">,</span> <span class="n">next_suggestion_frame</span><span class="o">.</span><span class="n">frame_idx</span><span class="p">,</span> <span class="n">next_suggestion_frame</span><span class="o">.</span><span class="n">video</span>
            <span class="p">)</span>
            <span class="n">selection_idx</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">get_suggestions</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span>
                <span class="n">next_suggestion_frame</span>
            <span class="p">)</span>
            <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;suggestion_idx&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">selection_idx</span></div></div>


<div class="viewcode-block" id="GoPrevSuggestedFrame"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.GoPrevSuggestedFrame">[docs]</a><span class="k">class</span> <span class="nc">GoPrevSuggestedFrame</span><span class="p">(</span><span class="n">GoNextSuggestedFrame</span><span class="p">):</span>
    <span class="n">seek_direction</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span></div>


<div class="viewcode-block" id="GoNextTrackFrame"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.GoNextTrackFrame">[docs]</a><span class="k">class</span> <span class="nc">GoNextTrackFrame</span><span class="p">(</span><span class="n">NavCommand</span><span class="p">):</span>
<div class="viewcode-block" id="GoNextTrackFrame.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.GoNextTrackFrame.do_action">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">video</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;video&quot;</span><span class="p">]</span>
        <span class="n">cur_idx</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;frame_idx&quot;</span><span class="p">]</span>
        <span class="n">track_ranges</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">get_track_occupancy</span><span class="p">(</span><span class="n">video</span><span class="p">)</span>

        <span class="n">later_tracks</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">track_range</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">track</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">track</span><span class="p">,</span> <span class="n">track_range</span> <span class="ow">in</span> <span class="n">track_ranges</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">track_range</span><span class="o">.</span><span class="n">start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">track_range</span><span class="o">.</span><span class="n">start</span> <span class="o">&gt;</span> <span class="n">cur_idx</span>
        <span class="p">]</span>

        <span class="n">later_tracks</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">operator</span><span class="o">.</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">later_tracks</span><span class="p">:</span>
            <span class="n">next_idx</span><span class="p">,</span> <span class="n">next_track</span> <span class="o">=</span> <span class="n">later_tracks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">go_to</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">next_idx</span><span class="p">)</span>

            <span class="c1"># Select the instance in the new track</span>
            <span class="n">lf</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">video</span><span class="p">,</span> <span class="n">next_idx</span><span class="p">,</span> <span class="n">return_new</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">track_instances</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">inst</span> <span class="k">for</span> <span class="n">inst</span> <span class="ow">in</span> <span class="n">lf</span><span class="o">.</span><span class="n">instances_to_show</span> <span class="k">if</span> <span class="n">inst</span><span class="o">.</span><span class="n">track</span> <span class="o">==</span> <span class="n">next_track</span>
            <span class="p">]</span>
            <span class="k">if</span> <span class="n">track_instances</span><span class="p">:</span>
                <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;instance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">track_instances</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div></div>


<div class="viewcode-block" id="GoFrameGui"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.GoFrameGui">[docs]</a><span class="k">class</span> <span class="nc">GoFrameGui</span><span class="p">(</span><span class="n">NavCommand</span><span class="p">):</span>
<div class="viewcode-block" id="GoFrameGui.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.GoFrameGui.do_action">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="s2">&quot;CommandContext&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">go_to</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;frame_idx&quot;</span><span class="p">])</span></div>

<div class="viewcode-block" id="GoFrameGui.ask"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.GoFrameGui.ask">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">ask</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="s2">&quot;CommandContext&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">frame_number</span><span class="p">,</span> <span class="n">okay</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QInputDialog</span><span class="o">.</span><span class="n">getInt</span><span class="p">(</span>
            <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="p">,</span>
            <span class="s2">&quot;Go To Frame...&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Frame Number:&quot;</span><span class="p">,</span>
            <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;frame_idx&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
            <span class="mi">1</span><span class="p">,</span>
            <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;video&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">frames</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;frame_idx&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">frame_number</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">okay</span></div></div>


<div class="viewcode-block" id="SelectToFrameGui"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.SelectToFrameGui">[docs]</a><span class="k">class</span> <span class="nc">SelectToFrameGui</span><span class="p">(</span><span class="n">NavCommand</span><span class="p">):</span>
<div class="viewcode-block" id="SelectToFrameGui.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.SelectToFrameGui.do_action">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="s2">&quot;CommandContext&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">setSeekbarSelection</span><span class="p">(</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;from_frame_idx&quot;</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;to_frame_idx&quot;</span><span class="p">]</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="SelectToFrameGui.ask"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.SelectToFrameGui.ask">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">ask</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="s2">&quot;CommandContext&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">frame_number</span><span class="p">,</span> <span class="n">okay</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QInputDialog</span><span class="o">.</span><span class="n">getInt</span><span class="p">(</span>
            <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="p">,</span>
            <span class="s2">&quot;Select To Frame...&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Frame Number:&quot;</span><span class="p">,</span>
            <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;frame_idx&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
            <span class="mi">1</span><span class="p">,</span>
            <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;video&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">frames</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;from_frame_idx&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;frame_idx&quot;</span><span class="p">]</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;to_frame_idx&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">frame_number</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">okay</span></div></div>


<span class="c1"># Editing Commands</span>


<div class="viewcode-block" id="EditCommand"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.EditCommand">[docs]</a><span class="k">class</span> <span class="nc">EditCommand</span><span class="p">(</span><span class="n">AppCommand</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Class for commands which change data in project.&quot;&quot;&quot;</span>

    <span class="n">does_edits</span> <span class="o">=</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="AddVideo"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.AddVideo">[docs]</a><span class="k">class</span> <span class="nc">AddVideo</span><span class="p">(</span><span class="n">EditCommand</span><span class="p">):</span>
    <span class="n">topics</span> <span class="o">=</span> <span class="p">[</span><span class="n">UpdateTopic</span><span class="o">.</span><span class="n">video</span><span class="p">]</span>

<div class="viewcode-block" id="AddVideo.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.AddVideo.do_action">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">import_list</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;import_list&quot;</span><span class="p">]</span>

        <span class="n">new_videos</span> <span class="o">=</span> <span class="n">ImportVideos</span><span class="o">.</span><span class="n">create_videos</span><span class="p">(</span><span class="n">import_list</span><span class="p">)</span>
        <span class="n">video</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">video</span> <span class="ow">in</span> <span class="n">new_videos</span><span class="p">:</span>
            <span class="c1"># Add to labels</span>
            <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">add_video</span><span class="p">(</span><span class="n">video</span><span class="p">)</span>
            <span class="n">context</span><span class="o">.</span><span class="n">changestack_push</span><span class="p">(</span><span class="s2">&quot;add video&quot;</span><span class="p">)</span>

        <span class="c1"># Load if no video currently loaded</span>
        <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;video&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;video&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">video</span></div>

<div class="viewcode-block" id="AddVideo.ask"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.AddVideo.ask">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">ask</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Shows gui for adding video to project.&quot;&quot;&quot;</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;import_list&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ImportVideos</span><span class="p">()</span><span class="o">.</span><span class="n">ask</span><span class="p">()</span>

        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;import_list&quot;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span></div></div>


<div class="viewcode-block" id="ReplaceVideo"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.ReplaceVideo">[docs]</a><span class="k">class</span> <span class="nc">ReplaceVideo</span><span class="p">(</span><span class="n">EditCommand</span><span class="p">):</span>
    <span class="n">topics</span> <span class="o">=</span> <span class="p">[</span><span class="n">UpdateTopic</span><span class="o">.</span><span class="n">video</span><span class="p">]</span>

<div class="viewcode-block" id="ReplaceVideo.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.ReplaceVideo.do_action">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">new_paths</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;new_video_paths&quot;</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">video</span><span class="p">,</span> <span class="n">new_path</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">videos</span><span class="p">,</span> <span class="n">new_paths</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">new_path</span> <span class="o">!=</span> <span class="n">video</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">filename</span><span class="p">:</span>
                <span class="n">video</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">new_path</span>
                <span class="n">video</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span></div>

<div class="viewcode-block" id="ReplaceVideo.ask"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.ReplaceVideo.ask">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">ask</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Shows gui for replacing videos in project.&quot;&quot;&quot;</span>
        <span class="n">paths</span> <span class="o">=</span> <span class="p">[</span><span class="n">video</span><span class="o">.</span><span class="n">backend</span><span class="o">.</span><span class="n">filename</span> <span class="k">for</span> <span class="n">video</span> <span class="ow">in</span> <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">videos</span><span class="p">]</span>

        <span class="n">okay</span> <span class="o">=</span> <span class="n">MissingFilesDialog</span><span class="p">(</span><span class="n">filenames</span><span class="o">=</span><span class="n">paths</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">okay</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;new_video_paths&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paths</span>

        <span class="k">return</span> <span class="kc">True</span></div></div>


<div class="viewcode-block" id="RemoveVideo"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.RemoveVideo">[docs]</a><span class="k">class</span> <span class="nc">RemoveVideo</span><span class="p">(</span><span class="n">EditCommand</span><span class="p">):</span>
    <span class="n">topics</span> <span class="o">=</span> <span class="p">[</span><span class="n">UpdateTopic</span><span class="o">.</span><span class="n">video</span><span class="p">]</span>

<div class="viewcode-block" id="RemoveVideo.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.RemoveVideo.do_action">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">video</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;video&quot;</span><span class="p">]</span>
        <span class="c1"># Remove video</span>
        <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">remove_video</span><span class="p">(</span><span class="n">video</span><span class="p">)</span>

        <span class="c1"># Update view if this was the current video</span>
        <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;video&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">video</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">videos</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;video&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">videos</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;video&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="RemoveVideo.ask"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.RemoveVideo.ask">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">ask</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">video</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;selected_video&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">video</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># Count labeled frames for this video</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">video</span><span class="p">))</span>

        <span class="c1"># Warn if there are labels that will be deleted</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span>
                <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="p">,</span>
                <span class="s2">&quot;Removing video with labels&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2"> labeled frames in this video will be deleted, &quot;</span>
                <span class="s2">&quot;are you sure you want to remove this video?&quot;</span><span class="p">,</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span><span class="p">,</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">No</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">response</span> <span class="o">==</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">No</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;video&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">video</span>
        <span class="k">return</span> <span class="kc">True</span></div></div>


<div class="viewcode-block" id="OpenSkeleton"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.OpenSkeleton">[docs]</a><span class="k">class</span> <span class="nc">OpenSkeleton</span><span class="p">(</span><span class="n">EditCommand</span><span class="p">):</span>
    <span class="n">topics</span> <span class="o">=</span> <span class="p">[</span><span class="n">UpdateTopic</span><span class="o">.</span><span class="n">skeleton</span><span class="p">]</span>

<div class="viewcode-block" id="OpenSkeleton.ask"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.OpenSkeleton.ask">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">ask</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;JSON skeleton (*.json)&quot;</span><span class="p">,</span> <span class="s2">&quot;HDF5 skeleton (*.h5 *.hdf5)&quot;</span><span class="p">]</span>
        <span class="n">filename</span><span class="p">,</span> <span class="n">selected_filter</span> <span class="o">=</span> <span class="n">FileDialog</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
            <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">caption</span><span class="o">=</span><span class="s2">&quot;Open skeleton...&quot;</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="s2">&quot;;;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filters</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="OpenSkeleton.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.OpenSkeleton.do_action">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.json&quot;</span><span class="p">):</span>
            <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;skeleton&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Skeleton</span><span class="o">.</span><span class="n">load_json</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s2">&quot;.h5&quot;</span><span class="p">,</span> <span class="s2">&quot;.hdf5&quot;</span><span class="p">)):</span>
            <span class="n">sk_list</span> <span class="o">=</span> <span class="n">Skeleton</span><span class="o">.</span><span class="n">load_all_hdf5</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sk_list</span><span class="p">):</span>
                <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;skeleton&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sk_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;skeleton&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="p">:</span>
            <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">skeletons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;skeleton&quot;</span><span class="p">])</span></div></div>


<div class="viewcode-block" id="SaveSkeleton"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.SaveSkeleton">[docs]</a><span class="k">class</span> <span class="nc">SaveSkeleton</span><span class="p">(</span><span class="n">AppCommand</span><span class="p">):</span>
<div class="viewcode-block" id="SaveSkeleton.ask"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.SaveSkeleton.ask">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">ask</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">default_name</span> <span class="o">=</span> <span class="s2">&quot;skeleton.json&quot;</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;JSON skeleton (*.json)&quot;</span><span class="p">,</span> <span class="s2">&quot;HDF5 skeleton (*.h5 *.hdf5)&quot;</span><span class="p">]</span>
        <span class="n">filename</span><span class="p">,</span> <span class="n">selected_filter</span> <span class="o">=</span> <span class="n">FileDialog</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
            <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="p">,</span>
            <span class="n">caption</span><span class="o">=</span><span class="s2">&quot;Save As...&quot;</span><span class="p">,</span>
            <span class="nb">dir</span><span class="o">=</span><span class="n">default_name</span><span class="p">,</span>
            <span class="nb">filter</span><span class="o">=</span><span class="s2">&quot;;;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filters</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="SaveSkeleton.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.SaveSkeleton.do_action">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;filename&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.json&quot;</span><span class="p">):</span>
            <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;skeleton&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">save_json</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s2">&quot;.h5&quot;</span><span class="p">,</span> <span class="s2">&quot;.hdf5&quot;</span><span class="p">)):</span>
            <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;skeleton&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">save_hdf5</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="NewNode"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.NewNode">[docs]</a><span class="k">class</span> <span class="nc">NewNode</span><span class="p">(</span><span class="n">EditCommand</span><span class="p">):</span>
    <span class="n">topics</span> <span class="o">=</span> <span class="p">[</span><span class="n">UpdateTopic</span><span class="o">.</span><span class="n">skeleton</span><span class="p">]</span>

<div class="viewcode-block" id="NewNode.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.NewNode.do_action">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="c1"># Find new part name</span>
        <span class="n">part_name</span> <span class="o">=</span> <span class="s2">&quot;new_part&quot;</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="n">part_name</span> <span class="ow">in</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;skeleton&quot;</span><span class="p">]:</span>
            <span class="n">part_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;new_part_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># Add the node to the skeleton</span>
        <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;skeleton&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">part_name</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="DeleteNode"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.DeleteNode">[docs]</a><span class="k">class</span> <span class="nc">DeleteNode</span><span class="p">(</span><span class="n">EditCommand</span><span class="p">):</span>
    <span class="n">topics</span> <span class="o">=</span> <span class="p">[</span><span class="n">UpdateTopic</span><span class="o">.</span><span class="n">skeleton</span><span class="p">]</span>

<div class="viewcode-block" id="DeleteNode.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.DeleteNode.do_action">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;selected_node&quot;</span><span class="p">]</span>
        <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;skeleton&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">delete_node</span><span class="p">(</span><span class="n">node</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="SetNodeName"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.SetNodeName">[docs]</a><span class="k">class</span> <span class="nc">SetNodeName</span><span class="p">(</span><span class="n">EditCommand</span><span class="p">):</span>
    <span class="n">topics</span> <span class="o">=</span> <span class="p">[</span><span class="n">UpdateTopic</span><span class="o">.</span><span class="n">skeleton</span><span class="p">]</span>

<div class="viewcode-block" id="SetNodeName.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.SetNodeName.do_action">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;node&quot;</span><span class="p">]</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
        <span class="n">skeleton</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;skeleton&quot;</span><span class="p">]</span>
        <span class="n">skeleton</span><span class="o">.</span><span class="n">relabel_node</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="SetNodeSymmetry"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.SetNodeSymmetry">[docs]</a><span class="k">class</span> <span class="nc">SetNodeSymmetry</span><span class="p">(</span><span class="n">EditCommand</span><span class="p">):</span>
    <span class="n">topics</span> <span class="o">=</span> <span class="p">[</span><span class="n">UpdateTopic</span><span class="o">.</span><span class="n">skeleton</span><span class="p">]</span>

<div class="viewcode-block" id="SetNodeSymmetry.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.SetNodeSymmetry.do_action">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;node&quot;</span><span class="p">]</span>
        <span class="n">symmetry</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;symmetry&quot;</span><span class="p">]</span>
        <span class="n">skeleton</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;skeleton&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">symmetry</span><span class="p">:</span>
            <span class="n">skeleton</span><span class="o">.</span><span class="n">add_symmetry</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">symmetry</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Value was cleared by user, so delete symmetry</span>
            <span class="n">symmetric_to</span> <span class="o">=</span> <span class="n">skeleton</span><span class="o">.</span><span class="n">get_symmetry</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="n">skeleton</span><span class="o">.</span><span class="n">delete_symmetry</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">symmetric_to</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="NewEdge"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.NewEdge">[docs]</a><span class="k">class</span> <span class="nc">NewEdge</span><span class="p">(</span><span class="n">EditCommand</span><span class="p">):</span>
    <span class="n">topics</span> <span class="o">=</span> <span class="p">[</span><span class="n">UpdateTopic</span><span class="o">.</span><span class="n">skeleton</span><span class="p">]</span>

<div class="viewcode-block" id="NewEdge.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.NewEdge.do_action">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">src_node</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;src_node&quot;</span><span class="p">]</span>
        <span class="n">dst_node</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;dst_node&quot;</span><span class="p">]</span>

        <span class="c1"># Check if they&#39;re in the graph</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">src_node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;skeleton&quot;</span><span class="p">]</span>
            <span class="ow">or</span> <span class="n">dst_node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;skeleton&quot;</span><span class="p">]</span>
        <span class="p">):</span>
            <span class="k">return</span>

        <span class="c1"># Add edge</span>
        <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;skeleton&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">src_node</span><span class="p">,</span> <span class="n">destination</span><span class="o">=</span><span class="n">dst_node</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="DeleteEdge"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.DeleteEdge">[docs]</a><span class="k">class</span> <span class="nc">DeleteEdge</span><span class="p">(</span><span class="n">EditCommand</span><span class="p">):</span>
    <span class="n">topics</span> <span class="o">=</span> <span class="p">[</span><span class="n">UpdateTopic</span><span class="o">.</span><span class="n">skeleton</span><span class="p">]</span>

<div class="viewcode-block" id="DeleteEdge.ask"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.DeleteEdge.ask">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">ask</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="s2">&quot;CommandContext&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;edge&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;selected_edge&quot;</span><span class="p">]</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="DeleteEdge.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.DeleteEdge.do_action">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">edge</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;edge&quot;</span><span class="p">]</span>
        <span class="c1"># Delete edge</span>
        <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;skeleton&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">delete_edge</span><span class="p">(</span><span class="o">**</span><span class="n">edge</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="InstanceDeleteCommand"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.InstanceDeleteCommand">[docs]</a><span class="k">class</span> <span class="nc">InstanceDeleteCommand</span><span class="p">(</span><span class="n">EditCommand</span><span class="p">):</span>
    <span class="n">topics</span> <span class="o">=</span> <span class="p">[</span><span class="n">UpdateTopic</span><span class="o">.</span><span class="n">project_instances</span><span class="p">]</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_frame_instance_list</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Call to virtual method.&quot;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_confirm_deletion</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">lf_inst_list</span><span class="p">:</span> <span class="n">List</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Helper function to confirm before deleting instances.</span>

<span class="sd">        Args:</span>
<span class="sd">            lf_inst_list: A list of (labeled frame, instance) tuples.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Deleting instances&quot;</span>
        <span class="n">message</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;There are </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">lf_inst_list</span><span class="p">)</span><span class="si">}</span><span class="s2"> instances which &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;would be deleted. Are you sure you want to delete these?&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Confirm that we want to delete</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span>
            <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span><span class="p">,</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">No</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">resp</span> <span class="o">==</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">No</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_do_deletion</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">lf_inst_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]):</span>
        <span class="c1"># Delete the instances</span>
        <span class="k">for</span> <span class="n">lf</span><span class="p">,</span> <span class="n">inst</span> <span class="ow">in</span> <span class="n">lf_inst_list</span><span class="p">:</span>
            <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">remove_instance</span><span class="p">(</span><span class="n">lf</span><span class="p">,</span> <span class="n">inst</span><span class="p">,</span> <span class="n">in_transaction</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">lf</span><span class="o">.</span><span class="n">instances</span><span class="p">:</span>
                <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">lf</span><span class="p">)</span>

        <span class="c1"># Update caches since we skipped doing this after each deletion</span>
        <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">update_cache</span><span class="p">()</span>

        <span class="c1"># Update visuals</span>
        <span class="n">context</span><span class="o">.</span><span class="n">changestack_push</span><span class="p">(</span><span class="s2">&quot;delete instances&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="InstanceDeleteCommand.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.InstanceDeleteCommand.do_action">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_do_deletion</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;lf_instance_list&quot;</span><span class="p">])</span></div>

<div class="viewcode-block" id="InstanceDeleteCommand.ask"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.InstanceDeleteCommand.ask">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">ask</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">lf_inst_list</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_frame_instance_list</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="n">params</span><span class="p">[</span><span class="s2">&quot;lf_instance_list&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lf_inst_list</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_confirm_deletion</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">lf_inst_list</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="DeleteAllPredictions"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.DeleteAllPredictions">[docs]</a><span class="k">class</span> <span class="nc">DeleteAllPredictions</span><span class="p">(</span><span class="n">InstanceDeleteCommand</span><span class="p">):</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_frame_instance_list</span><span class="p">(</span>
        <span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">LabeledFrame</span><span class="p">,</span> <span class="n">Instance</span><span class="p">]]:</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">lf</span><span class="p">,</span> <span class="n">inst</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">lf</span> <span class="ow">in</span> <span class="n">context</span><span class="o">.</span><span class="n">labels</span>
            <span class="k">for</span> <span class="n">inst</span> <span class="ow">in</span> <span class="n">lf</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">inst</span><span class="p">)</span> <span class="o">==</span> <span class="n">PredictedInstance</span>
        <span class="p">]</span></div>


<div class="viewcode-block" id="DeleteFramePredictions"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.DeleteFramePredictions">[docs]</a><span class="k">class</span> <span class="nc">DeleteFramePredictions</span><span class="p">(</span><span class="n">InstanceDeleteCommand</span><span class="p">):</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_confirm_deletion</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># Don&#39;t require confirmation when deleting from current frame</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_frame_instance_list</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">predicted_instances</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">lf</span><span class="p">,</span> <span class="n">inst</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">lf</span> <span class="ow">in</span> <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">find</span><span class="p">(</span>
                <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;video&quot;</span><span class="p">],</span> <span class="n">frame_idx</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;frame_idx&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">inst</span> <span class="ow">in</span> <span class="n">lf</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">inst</span><span class="p">)</span> <span class="o">==</span> <span class="n">PredictedInstance</span>
        <span class="p">]</span>

        <span class="k">return</span> <span class="n">predicted_instances</span></div>


<div class="viewcode-block" id="DeleteClipPredictions"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.DeleteClipPredictions">[docs]</a><span class="k">class</span> <span class="nc">DeleteClipPredictions</span><span class="p">(</span><span class="n">InstanceDeleteCommand</span><span class="p">):</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_frame_instance_list</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">predicted_instances</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">lf</span><span class="p">,</span> <span class="n">inst</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">lf</span> <span class="ow">in</span> <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">find</span><span class="p">(</span>
                <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;video&quot;</span><span class="p">],</span> <span class="n">frame_idx</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="o">*</span><span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;frame_range&quot;</span><span class="p">])</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">inst</span> <span class="ow">in</span> <span class="n">lf</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">inst</span><span class="p">)</span> <span class="o">==</span> <span class="n">PredictedInstance</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="n">predicted_instances</span></div>


<div class="viewcode-block" id="DeleteAreaPredictions"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.DeleteAreaPredictions">[docs]</a><span class="k">class</span> <span class="nc">DeleteAreaPredictions</span><span class="p">(</span><span class="n">InstanceDeleteCommand</span><span class="p">):</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_frame_instance_list</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">min_corner</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;min_corner&quot;</span><span class="p">]</span>
        <span class="n">max_corner</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;max_corner&quot;</span><span class="p">]</span>

        <span class="k">def</span> <span class="nf">is_bounded</span><span class="p">(</span><span class="n">inst</span><span class="p">):</span>
            <span class="n">points_array</span> <span class="o">=</span> <span class="n">inst</span><span class="o">.</span><span class="n">points_array</span>
            <span class="n">valid_points</span> <span class="o">=</span> <span class="n">points_array</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">points_array</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>

            <span class="n">is_gt_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">valid_points</span> <span class="o">&gt;=</span> <span class="n">min_corner</span><span class="p">)</span>
            <span class="n">is_lt_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">valid_points</span> <span class="o">&lt;=</span> <span class="n">max_corner</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">is_gt_min</span> <span class="ow">and</span> <span class="n">is_lt_max</span>

        <span class="c1"># Find all instances contained in selected area</span>
        <span class="n">predicted_instances</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">lf</span><span class="p">,</span> <span class="n">inst</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">lf</span> <span class="ow">in</span> <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;video&quot;</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">inst</span> <span class="ow">in</span> <span class="n">lf</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">inst</span><span class="p">)</span> <span class="o">==</span> <span class="n">PredictedInstance</span> <span class="ow">and</span> <span class="n">is_bounded</span><span class="p">(</span><span class="n">inst</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="k">return</span> <span class="n">predicted_instances</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">ask_and_do</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="c1"># Callback to delete after area has been selected</span>
        <span class="k">def</span> <span class="nf">delete_area_callback</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">):</span>
            <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">updateStatusMessage</span><span class="p">()</span>

            <span class="c1"># Make sure there was an area selected</span>
            <span class="k">if</span> <span class="n">x0</span> <span class="o">==</span> <span class="n">x1</span> <span class="ow">or</span> <span class="n">y0</span> <span class="o">==</span> <span class="n">y1</span><span class="p">:</span>
                <span class="k">return</span>

            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;min_corner&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">)</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;max_corner&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>

            <span class="n">predicted_instances</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_frame_instance_list</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_confirm_deletion</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">predicted_instances</span><span class="p">):</span>
                <span class="n">params</span><span class="p">[</span><span class="s2">&quot;lf_instance_list&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">predicted_instances</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">do_with_signal</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="c1"># Prompt the user to select area</span>
        <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">updateStatusMessage</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Please select the area from which to remove instances. This will be applied to all frames.&quot;</span>
        <span class="p">)</span>
        <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">onAreaSelection</span><span class="p">(</span><span class="n">delete_area_callback</span><span class="p">)</span></div>


<div class="viewcode-block" id="DeleteLowScorePredictions"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.DeleteLowScorePredictions">[docs]</a><span class="k">class</span> <span class="nc">DeleteLowScorePredictions</span><span class="p">(</span><span class="n">InstanceDeleteCommand</span><span class="p">):</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_frame_instance_list</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">score_thresh</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;score_threshold&quot;</span><span class="p">]</span>
        <span class="n">predicted_instances</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">lf</span><span class="p">,</span> <span class="n">inst</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">lf</span> <span class="ow">in</span> <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;video&quot;</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">inst</span> <span class="ow">in</span> <span class="n">lf</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">inst</span><span class="p">)</span> <span class="o">==</span> <span class="n">PredictedInstance</span> <span class="ow">and</span> <span class="n">inst</span><span class="o">.</span><span class="n">score</span> <span class="o">&lt;</span> <span class="n">score_thresh</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="n">predicted_instances</span>

<div class="viewcode-block" id="DeleteLowScorePredictions.ask"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.DeleteLowScorePredictions.ask">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">ask</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">score_thresh</span><span class="p">,</span> <span class="n">okay</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QInputDialog</span><span class="o">.</span><span class="n">getDouble</span><span class="p">(</span>
            <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="p">,</span> <span class="s2">&quot;Delete Instances with Low Score...&quot;</span><span class="p">,</span> <span class="s2">&quot;Score Below:&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">okay</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;score_threshold&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">score_thresh</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="DeleteFrameLimitPredictions"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.DeleteFrameLimitPredictions">[docs]</a><span class="k">class</span> <span class="nc">DeleteFrameLimitPredictions</span><span class="p">(</span><span class="n">InstanceDeleteCommand</span><span class="p">):</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_frame_instance_list</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">count_thresh</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;count_threshold&quot;</span><span class="p">]</span>
        <span class="n">predicted_instances</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Find all instances contained in selected area</span>
        <span class="k">for</span> <span class="n">lf</span> <span class="ow">in</span> <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;video&quot;</span><span class="p">]):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lf</span><span class="o">.</span><span class="n">predicted_instances</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">count_thresh</span><span class="p">:</span>
                <span class="c1"># Get all but the count_thresh many instances with the highest score</span>
                <span class="n">extra_instances</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
                    <span class="n">lf</span><span class="o">.</span><span class="n">predicted_instances</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">operator</span><span class="o">.</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;score&quot;</span><span class="p">)</span>
                <span class="p">)[:</span><span class="o">-</span><span class="n">count_thresh</span><span class="p">]</span>
                <span class="n">predicted_instances</span><span class="o">.</span><span class="n">extend</span><span class="p">([(</span><span class="n">lf</span><span class="p">,</span> <span class="n">inst</span><span class="p">)</span> <span class="k">for</span> <span class="n">inst</span> <span class="ow">in</span> <span class="n">extra_instances</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">predicted_instances</span>

<div class="viewcode-block" id="DeleteFrameLimitPredictions.ask"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.DeleteFrameLimitPredictions.ask">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">ask</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">count_thresh</span><span class="p">,</span> <span class="n">okay</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QInputDialog</span><span class="o">.</span><span class="n">getInt</span><span class="p">(</span>
            <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="p">,</span>
            <span class="s2">&quot;Limit Instances in Frame...&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Maximum instances in a frame:&quot;</span><span class="p">,</span>
            <span class="mi">3</span><span class="p">,</span>
            <span class="mi">1</span><span class="p">,</span>
            <span class="mi">100</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">okay</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;count_threshold&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">count_thresh</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="TransposeInstances"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.TransposeInstances">[docs]</a><span class="k">class</span> <span class="nc">TransposeInstances</span><span class="p">(</span><span class="n">EditCommand</span><span class="p">):</span>
    <span class="n">topics</span> <span class="o">=</span> <span class="p">[</span><span class="n">UpdateTopic</span><span class="o">.</span><span class="n">project_instances</span><span class="p">,</span> <span class="n">UpdateTopic</span><span class="o">.</span><span class="n">tracks</span><span class="p">]</span>

<div class="viewcode-block" id="TransposeInstances.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.TransposeInstances.do_action">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">instances</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;instances&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># Swap tracks for current and subsequent frames when we have tracks</span>
        <span class="n">old_track</span><span class="p">,</span> <span class="n">new_track</span> <span class="o">=</span> <span class="n">instances</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">track</span><span class="p">,</span> <span class="n">instances</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">track</span>
        <span class="k">if</span> <span class="n">old_track</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">new_track</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">frame_range</span> <span class="o">=</span> <span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;frame_idx&quot;</span><span class="p">],</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;video&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">frames</span><span class="p">)</span>
            <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">track_swap</span><span class="p">(</span>
                <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;video&quot;</span><span class="p">],</span> <span class="n">new_track</span><span class="p">,</span> <span class="n">old_track</span><span class="p">,</span> <span class="n">frame_range</span>
            <span class="p">)</span></div>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">ask_and_do</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">on_each</span><span class="p">(</span><span class="n">instances</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">word</span> <span class="o">=</span> <span class="s2">&quot;next&quot;</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;first&quot;</span>
            <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">updateStatusMessage</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Please select the </span><span class="si">{</span><span class="n">word</span><span class="si">}</span><span class="s2"> instance to transpose...&quot;</span>
            <span class="p">)</span>

        <span class="k">def</span> <span class="nf">on_success</span><span class="p">(</span><span class="n">instances</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;instances&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">instances</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">do_with_signal</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;labeled_frame&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">instances</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="c1"># If there are just two instances, transpose them.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;labeled_frame&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">instances</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;instances&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;labeled_frame&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">instances</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">do_with_signal</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="c1"># If there are more than two, then we need the user to select the instances.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">onSequenceSelect</span><span class="p">(</span>
                <span class="n">seq_len</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">on_success</span><span class="o">=</span><span class="n">on_success</span><span class="p">,</span>
                <span class="n">on_each</span><span class="o">=</span><span class="n">on_each</span><span class="p">,</span>
                <span class="n">on_failure</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">updateStatusMessage</span><span class="p">(),</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="DeleteSelectedInstance"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.DeleteSelectedInstance">[docs]</a><span class="k">class</span> <span class="nc">DeleteSelectedInstance</span><span class="p">(</span><span class="n">EditCommand</span><span class="p">):</span>
    <span class="n">topics</span> <span class="o">=</span> <span class="p">[</span><span class="n">UpdateTopic</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="n">UpdateTopic</span><span class="o">.</span><span class="n">project_instances</span><span class="p">,</span> <span class="n">UpdateTopic</span><span class="o">.</span><span class="n">suggestions</span><span class="p">]</span>

<div class="viewcode-block" id="DeleteSelectedInstance.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.DeleteSelectedInstance.do_action">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">selected_inst</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;instance&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">selected_inst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">remove_instance</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;labeled_frame&quot;</span><span class="p">],</span> <span class="n">selected_inst</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="DeleteSelectedInstanceTrack"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.DeleteSelectedInstanceTrack">[docs]</a><span class="k">class</span> <span class="nc">DeleteSelectedInstanceTrack</span><span class="p">(</span><span class="n">EditCommand</span><span class="p">):</span>
    <span class="n">topics</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">UpdateTopic</span><span class="o">.</span><span class="n">project_instances</span><span class="p">,</span>
        <span class="n">UpdateTopic</span><span class="o">.</span><span class="n">tracks</span><span class="p">,</span>
        <span class="n">UpdateTopic</span><span class="o">.</span><span class="n">suggestions</span><span class="p">,</span>
    <span class="p">]</span>

<div class="viewcode-block" id="DeleteSelectedInstanceTrack.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.DeleteSelectedInstanceTrack.do_action">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">selected_inst</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;instance&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">selected_inst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">track</span> <span class="o">=</span> <span class="n">selected_inst</span><span class="o">.</span><span class="n">track</span>
        <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">remove_instance</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;labeled_frame&quot;</span><span class="p">],</span> <span class="n">selected_inst</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">track</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># remove any instance on this track</span>
            <span class="k">for</span> <span class="n">lf</span> <span class="ow">in</span> <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;video&quot;</span><span class="p">]):</span>
                <span class="n">track_instances</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">inst</span><span class="p">:</span> <span class="n">inst</span><span class="o">.</span><span class="n">track</span> <span class="o">==</span> <span class="n">track</span><span class="p">,</span> <span class="n">lf</span><span class="o">.</span><span class="n">instances</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">inst</span> <span class="ow">in</span> <span class="n">track_instances</span><span class="p">:</span>
                    <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">remove_instance</span><span class="p">(</span><span class="n">lf</span><span class="p">,</span> <span class="n">inst</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="DeleteDialogCommand"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.DeleteDialogCommand">[docs]</a><span class="k">class</span> <span class="nc">DeleteDialogCommand</span><span class="p">(</span><span class="n">EditCommand</span><span class="p">):</span>
    <span class="n">topics</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">UpdateTopic</span><span class="o">.</span><span class="n">project_instances</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">ask_and_do</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">DeleteDialog</span><span class="p">(</span><span class="n">context</span><span class="p">)</span><span class="o">.</span><span class="n">exec_</span><span class="p">():</span>
            <span class="n">context</span><span class="o">.</span><span class="n">signal_update</span><span class="p">([</span><span class="n">UpdateTopic</span><span class="o">.</span><span class="n">project_instances</span><span class="p">])</span></div>


<div class="viewcode-block" id="AddTrack"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.AddTrack">[docs]</a><span class="k">class</span> <span class="nc">AddTrack</span><span class="p">(</span><span class="n">EditCommand</span><span class="p">):</span>
    <span class="n">topics</span> <span class="o">=</span> <span class="p">[</span><span class="n">UpdateTopic</span><span class="o">.</span><span class="n">tracks</span><span class="p">]</span>

<div class="viewcode-block" id="AddTrack.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.AddTrack.do_action">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">track_numbers_used</span> <span class="o">=</span> <span class="p">[</span>
            <span class="nb">int</span><span class="p">(</span><span class="n">track</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">tracks</span> <span class="k">if</span> <span class="n">track</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">()</span>
        <span class="p">]</span>
        <span class="n">next_number</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">track_numbers_used</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">new_track</span> <span class="o">=</span> <span class="n">Track</span><span class="p">(</span><span class="n">spawned_on</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;frame_idx&quot;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">next_number</span><span class="p">))</span>

        <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">add_track</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;video&quot;</span><span class="p">],</span> <span class="n">new_track</span><span class="p">)</span>

        <span class="n">context</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">SetSelectedInstanceTrack</span><span class="p">,</span> <span class="n">new_track</span><span class="o">=</span><span class="n">new_track</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="SetSelectedInstanceTrack"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.SetSelectedInstanceTrack">[docs]</a><span class="k">class</span> <span class="nc">SetSelectedInstanceTrack</span><span class="p">(</span><span class="n">EditCommand</span><span class="p">):</span>
    <span class="n">topics</span> <span class="o">=</span> <span class="p">[</span><span class="n">UpdateTopic</span><span class="o">.</span><span class="n">tracks</span><span class="p">]</span>

<div class="viewcode-block" id="SetSelectedInstanceTrack.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.SetSelectedInstanceTrack.do_action">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">selected_instance</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;instance&quot;</span><span class="p">]</span>
        <span class="n">new_track</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;new_track&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">selected_instance</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">old_track</span> <span class="o">=</span> <span class="n">selected_instance</span><span class="o">.</span><span class="n">track</span>

        <span class="c1"># When setting track for an instance that doesn&#39;t already have a track set,</span>
        <span class="c1"># just set for selected instance.</span>
        <span class="k">if</span> <span class="n">old_track</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Move anything already in the new track out of it</span>
            <span class="n">new_track_instances</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">find_track_occupancy</span><span class="p">(</span>
                <span class="n">video</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;video&quot;</span><span class="p">],</span>
                <span class="n">track</span><span class="o">=</span><span class="n">new_track</span><span class="p">,</span>
                <span class="n">frame_range</span><span class="o">=</span><span class="p">(</span>
                    <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;frame_idx&quot;</span><span class="p">],</span>
                    <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;frame_idx&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                <span class="p">),</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">new_track_instances</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">track</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="c1"># Move selected instance into new track</span>
            <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">track_set_instance</span><span class="p">(</span>
                <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;labeled_frame&quot;</span><span class="p">],</span> <span class="n">selected_instance</span><span class="p">,</span> <span class="n">new_track</span>
            <span class="p">)</span>

        <span class="c1"># When the instance does already have a track, then we want to update</span>
        <span class="c1"># the track for a range of frames.</span>
        <span class="k">else</span><span class="p">:</span>

            <span class="c1"># Determine range that should be affected</span>
            <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;has_frame_range&quot;</span><span class="p">]:</span>
                <span class="c1"># If range is selected in seekbar, use that</span>
                <span class="n">frame_range</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;frame_range&quot;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Otherwise, range is current to last frame</span>
                <span class="n">frame_range</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;frame_idx&quot;</span><span class="p">],</span>
                    <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;video&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">frames</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="c1"># Do the swap</span>
            <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">track_swap</span><span class="p">(</span>
                <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;video&quot;</span><span class="p">],</span> <span class="n">new_track</span><span class="p">,</span> <span class="n">old_track</span><span class="p">,</span> <span class="n">frame_range</span>
            <span class="p">)</span>

        <span class="c1"># Make sure the originally selected instance is still selected</span>
        <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;instance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">selected_instance</span></div></div>


<div class="viewcode-block" id="SetTrackName"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.SetTrackName">[docs]</a><span class="k">class</span> <span class="nc">SetTrackName</span><span class="p">(</span><span class="n">EditCommand</span><span class="p">):</span>
    <span class="n">topics</span> <span class="o">=</span> <span class="p">[</span><span class="n">UpdateTopic</span><span class="o">.</span><span class="n">tracks</span><span class="p">,</span> <span class="n">UpdateTopic</span><span class="o">.</span><span class="n">frame</span><span class="p">]</span>

<div class="viewcode-block" id="SetTrackName.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.SetTrackName.do_action">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">track</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;track&quot;</span><span class="p">]</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
        <span class="n">track</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span></div></div>


<div class="viewcode-block" id="GenerateSuggestions"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.GenerateSuggestions">[docs]</a><span class="k">class</span> <span class="nc">GenerateSuggestions</span><span class="p">(</span><span class="n">EditCommand</span><span class="p">):</span>
    <span class="n">topics</span> <span class="o">=</span> <span class="p">[</span><span class="n">UpdateTopic</span><span class="o">.</span><span class="n">suggestions</span><span class="p">]</span>

<div class="viewcode-block" id="GenerateSuggestions.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.GenerateSuggestions.do_action">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>

        <span class="n">win</span> <span class="o">=</span> <span class="n">MessageDialog</span><span class="p">(</span><span class="s2">&quot;Generating list of suggested frames...&quot;</span><span class="p">,</span> <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="p">)</span>

        <span class="n">new_suggestions</span> <span class="o">=</span> <span class="n">VideoFrameSuggestions</span><span class="o">.</span><span class="n">suggest</span><span class="p">(</span>
            <span class="n">labels</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span>
        <span class="p">)</span>

        <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">set_suggestions</span><span class="p">(</span><span class="n">new_suggestions</span><span class="p">)</span>

        <span class="n">win</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="MergeProject"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.MergeProject">[docs]</a><span class="k">class</span> <span class="nc">MergeProject</span><span class="p">(</span><span class="n">EditCommand</span><span class="p">):</span>
    <span class="n">topics</span> <span class="o">=</span> <span class="p">[</span><span class="n">UpdateTopic</span><span class="o">.</span><span class="n">all</span><span class="p">]</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">ask_and_do</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;SLEAP HDF5 dataset (*.slp *.h5 *.hdf5)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;SLEAP JSON dataset (*.json *.json.zip)&quot;</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="n">filenames</span><span class="p">,</span> <span class="n">selected_filter</span> <span class="o">=</span> <span class="n">FileDialog</span><span class="o">.</span><span class="n">openMultiple</span><span class="p">(</span>
            <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="p">,</span>
            <span class="nb">dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">caption</span><span class="o">=</span><span class="s2">&quot;Import labeled data...&quot;</span><span class="p">,</span>
            <span class="nb">filter</span><span class="o">=</span><span class="s2">&quot;;;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filters</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
            <span class="n">gui_video_callback</span> <span class="o">=</span> <span class="n">Labels</span><span class="o">.</span><span class="n">make_gui_video_callback</span><span class="p">(</span>
                <span class="n">search_paths</span><span class="o">=</span><span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">filename</span><span class="p">)]</span>
            <span class="p">)</span>

            <span class="n">new_labels</span> <span class="o">=</span> <span class="n">Labels</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">video_search</span><span class="o">=</span><span class="n">gui_video_callback</span><span class="p">)</span>

            <span class="c1"># Merging data is handled by MergeDialog</span>
            <span class="n">MergeDialog</span><span class="p">(</span><span class="n">base_labels</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="n">new_labels</span><span class="o">=</span><span class="n">new_labels</span><span class="p">)</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>

        <span class="bp">cls</span><span class="o">.</span><span class="n">do_with_signal</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span></div>


<div class="viewcode-block" id="AddInstance"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.AddInstance">[docs]</a><span class="k">class</span> <span class="nc">AddInstance</span><span class="p">(</span><span class="n">EditCommand</span><span class="p">):</span>
    <span class="n">topics</span> <span class="o">=</span> <span class="p">[</span><span class="n">UpdateTopic</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="n">UpdateTopic</span><span class="o">.</span><span class="n">project_instances</span><span class="p">,</span> <span class="n">UpdateTopic</span><span class="o">.</span><span class="n">suggestions</span><span class="p">]</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_previous_frame_index</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="n">frames</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">frames</span><span class="p">(</span>
            <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;video&quot;</span><span class="p">],</span>
            <span class="n">from_frame_idx</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;frame_idx&quot;</span><span class="p">],</span>
            <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">next_idx</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span><span class="o">.</span><span class="n">frame_idx</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">return</span> <span class="n">next_idx</span>

<div class="viewcode-block" id="AddInstance.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.AddInstance.do_action">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">copy_instance</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;copy_instance&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">init_method</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;init_method&quot;</span><span class="p">,</span> <span class="s2">&quot;best&quot;</span><span class="p">)</span>
        <span class="n">location</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;location&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">mark_complete</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mark_complete&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;labeled_frame&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># FIXME: filter by skeleton type</span>

        <span class="n">from_predicted</span> <span class="o">=</span> <span class="n">copy_instance</span>
        <span class="n">from_prev_frame</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">init_method</span> <span class="o">==</span> <span class="s2">&quot;best&quot;</span> <span class="ow">and</span> <span class="n">copy_instance</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">selected_inst</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;instance&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">selected_inst</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># If the user has selected an instance, copy that one.</span>
                <span class="n">copy_instance</span> <span class="o">=</span> <span class="n">selected_inst</span>
                <span class="n">from_predicted</span> <span class="o">=</span> <span class="n">copy_instance</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="n">init_method</span> <span class="o">==</span> <span class="s2">&quot;best&quot;</span> <span class="ow">and</span> <span class="n">copy_instance</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="p">)</span> <span class="ow">or</span> <span class="n">init_method</span> <span class="o">==</span> <span class="s2">&quot;prediction&quot;</span><span class="p">:</span>
            <span class="n">unused_predictions</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;labeled_frame&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unused_predictions</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unused_predictions</span><span class="p">):</span>
                <span class="c1"># If there are predicted instances that don&#39;t correspond to an instance</span>
                <span class="c1"># in this frame, use the first predicted instance without matching instance.</span>
                <span class="n">copy_instance</span> <span class="o">=</span> <span class="n">unused_predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">from_predicted</span> <span class="o">=</span> <span class="n">copy_instance</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="n">init_method</span> <span class="o">==</span> <span class="s2">&quot;best&quot;</span> <span class="ow">and</span> <span class="n">copy_instance</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="p">)</span> <span class="ow">or</span> <span class="n">init_method</span> <span class="o">==</span> <span class="s2">&quot;prior_frame&quot;</span><span class="p">:</span>
            <span class="c1"># Otherwise, if there are instances in previous frames,</span>
            <span class="c1"># copy the points from one of those instances.</span>
            <span class="n">prev_idx</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_previous_frame_index</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">prev_idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">prev_instances</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">find</span><span class="p">(</span>
                    <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;video&quot;</span><span class="p">],</span> <span class="n">prev_idx</span><span class="p">,</span> <span class="n">return_new</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">instances</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">prev_instances</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;labeled_frame&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">instances</span><span class="p">):</span>
                    <span class="c1"># If more instances in previous frame than current, then use the</span>
                    <span class="c1"># first unmatched instance.</span>
                    <span class="n">copy_instance</span> <span class="o">=</span> <span class="n">prev_instances</span><span class="p">[</span>
                        <span class="nb">len</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;labeled_frame&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">instances</span><span class="p">)</span>
                    <span class="p">]</span>
                    <span class="n">from_prev_frame</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">elif</span> <span class="n">init_method</span> <span class="o">==</span> <span class="s2">&quot;best&quot;</span> <span class="ow">and</span> <span class="p">(</span>
                    <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;labeled_frame&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">instances</span>
                <span class="p">):</span>
                    <span class="c1"># Otherwise, if there are already instances in current frame,</span>
                    <span class="c1"># copy the points from the last instance added to frame.</span>
                    <span class="n">copy_instance</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;labeled_frame&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">instances</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">prev_instances</span><span class="p">):</span>
                    <span class="c1"># Otherwise use the last instance added to previous frame.</span>
                    <span class="n">copy_instance</span> <span class="o">=</span> <span class="n">prev_instances</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">from_prev_frame</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">from_predicted</span> <span class="o">=</span> <span class="n">from_predicted</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">from_predicted</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="c1"># Now create the new instance</span>
        <span class="n">new_instance</span> <span class="o">=</span> <span class="n">Instance</span><span class="p">(</span>
            <span class="n">skeleton</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;skeleton&quot;</span><span class="p">],</span>
            <span class="n">from_predicted</span><span class="o">=</span><span class="n">from_predicted</span><span class="p">,</span>
            <span class="n">frame</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;labeled_frame&quot;</span><span class="p">],</span>
        <span class="p">)</span>

        <span class="n">has_missing_nodes</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># go through each node in skeleton</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;skeleton&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">node_names</span><span class="p">:</span>
            <span class="c1"># if we&#39;re copying from a skeleton that has this node</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">copy_instance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="ow">and</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">copy_instance</span>
                <span class="ow">and</span> <span class="ow">not</span> <span class="n">copy_instance</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">.</span><span class="n">isnan</span><span class="p">()</span>
            <span class="p">):</span>
                <span class="c1"># just copy x, y, and visible</span>
                <span class="c1"># we don&#39;t want to copy a PredictedPoint or score attribute</span>
                <span class="n">new_instance</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">copy_instance</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">copy_instance</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
                    <span class="n">visible</span><span class="o">=</span><span class="n">copy_instance</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">.</span><span class="n">visible</span><span class="p">,</span>
                    <span class="n">complete</span><span class="o">=</span><span class="n">mark_complete</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">has_missing_nodes</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">has_missing_nodes</span><span class="p">:</span>
            <span class="c1"># mark the node as not &quot;visible&quot; if we&#39;re copying from a predicted instance without this node</span>
            <span class="n">is_visible</span> <span class="o">=</span> <span class="n">copy_instance</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">copy_instance</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">init_method</span> <span class="o">==</span> <span class="s2">&quot;force_directed&quot;</span><span class="p">:</span>
                <span class="n">AddMissingInstanceNodes</span><span class="o">.</span><span class="n">add_force_directed_nodes</span><span class="p">(</span>
                    <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">,</span>
                    <span class="n">instance</span><span class="o">=</span><span class="n">new_instance</span><span class="p">,</span>
                    <span class="n">visible</span><span class="o">=</span><span class="n">is_visible</span><span class="p">,</span>
                    <span class="n">center_point</span><span class="o">=</span><span class="n">location</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">init_method</span> <span class="o">==</span> <span class="s2">&quot;random&quot;</span><span class="p">:</span>
                <span class="n">AddMissingInstanceNodes</span><span class="o">.</span><span class="n">add_random_nodes</span><span class="p">(</span>
                    <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">,</span> <span class="n">instance</span><span class="o">=</span><span class="n">new_instance</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="n">is_visible</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">init_method</span> <span class="o">==</span> <span class="s2">&quot;template&quot;</span><span class="p">:</span>
                <span class="n">AddMissingInstanceNodes</span><span class="o">.</span><span class="n">add_nodes_from_template</span><span class="p">(</span>
                    <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">,</span>
                    <span class="n">instance</span><span class="o">=</span><span class="n">new_instance</span><span class="p">,</span>
                    <span class="n">visible</span><span class="o">=</span><span class="n">is_visible</span><span class="p">,</span>
                    <span class="n">center_point</span><span class="o">=</span><span class="n">location</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">AddMissingInstanceNodes</span><span class="o">.</span><span class="n">add_best_nodes</span><span class="p">(</span>
                    <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">,</span> <span class="n">instance</span><span class="o">=</span><span class="n">new_instance</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="n">is_visible</span>
                <span class="p">)</span>

        <span class="c1"># If we&#39;re copying a predicted instance or from another frame, copy the track</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">copy_instance</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">from_prev_frame</span><span class="p">:</span>
            <span class="n">new_instance</span><span class="o">.</span><span class="n">track</span> <span class="o">=</span> <span class="n">copy_instance</span><span class="o">.</span><span class="n">track</span>

        <span class="c1"># Add the instance</span>
        <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">add_instance</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;labeled_frame&quot;</span><span class="p">],</span> <span class="n">new_instance</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;labeled_frame&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">labels</span><span class="p">:</span>
            <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;labeled_frame&quot;</span><span class="p">])</span></div></div>


<div class="viewcode-block" id="SetInstancePointLocations"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.SetInstancePointLocations">[docs]</a><span class="k">class</span> <span class="nc">SetInstancePointLocations</span><span class="p">(</span><span class="n">EditCommand</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Sets locations for node(s) for an instance.</span>

<span class="sd">    Note: It&#39;s important that this command does *not* update the visual</span>
<span class="sd">    scene, since this would redraw the frame and create new visual objects.</span>
<span class="sd">    The calling code is responsible for updating the visual scene.</span>

<span class="sd">    Params:</span>
<span class="sd">        instance: The instance</span>
<span class="sd">        nodes_locations: A dictionary of data to set</span>
<span class="sd">        * keys are nodes (or node names)</span>
<span class="sd">        * values are (x, y) coordinate tuples.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">topics</span> <span class="o">=</span> <span class="p">[]</span>

<div class="viewcode-block" id="SetInstancePointLocations.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.SetInstancePointLocations.do_action">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="s2">&quot;CommandContext&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">instance</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;instance&quot;</span><span class="p">]</span>
        <span class="n">nodes_locations</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;nodes_locations&quot;</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="ow">in</span> <span class="n">nodes_locations</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">:</span>
                <span class="n">instance</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
                <span class="n">instance</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span></div></div>


<div class="viewcode-block" id="SetInstancePointVisibility"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.SetInstancePointVisibility">[docs]</a><span class="k">class</span> <span class="nc">SetInstancePointVisibility</span><span class="p">(</span><span class="n">EditCommand</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Toggles visibility set for a node for an instance.</span>

<span class="sd">    Note: It&#39;s important that this command does *not* update the visual</span>
<span class="sd">    scene, since this would redraw the frame and create new visual objects.</span>
<span class="sd">    The calling code is responsible for updating the visual scene.</span>

<span class="sd">    Params:</span>
<span class="sd">        instance: The instance</span>
<span class="sd">        node: The `Node` (or name string)</span>
<span class="sd">        visible: Whether to set or clear visibility for node</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">topics</span> <span class="o">=</span> <span class="p">[]</span>

<div class="viewcode-block" id="SetInstancePointVisibility.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.SetInstancePointVisibility.do_action">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="s2">&quot;CommandContext&quot;</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">instance</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;instance&quot;</span><span class="p">]</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;node&quot;</span><span class="p">]</span>
        <span class="n">visible</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;visible&quot;</span><span class="p">]</span>

        <span class="n">instance</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="n">visible</span></div></div>


<div class="viewcode-block" id="AddMissingInstanceNodes"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.AddMissingInstanceNodes">[docs]</a><span class="k">class</span> <span class="nc">AddMissingInstanceNodes</span><span class="p">(</span><span class="n">EditCommand</span><span class="p">):</span>
    <span class="n">topics</span> <span class="o">=</span> <span class="p">[</span><span class="n">UpdateTopic</span><span class="o">.</span><span class="n">frame</span><span class="p">]</span>

<div class="viewcode-block" id="AddMissingInstanceNodes.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.AddMissingInstanceNodes.do_action">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">instance</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;instance&quot;</span><span class="p">]</span>
        <span class="n">visible</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;visible&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

        <span class="bp">cls</span><span class="o">.</span><span class="n">add_best_nodes</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">visible</span><span class="p">)</span></div>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">add_best_nodes</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">visible</span><span class="p">):</span>
        <span class="c1"># Try placing missing nodes using a &quot;template&quot; instance</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">add_nodes_from_template</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">visible</span><span class="p">)</span>

        <span class="c1"># If the &quot;template&quot; instance has missing nodes (i.e., a node that isn&#39;t</span>
        <span class="c1"># labeled on any of the instances we used to generate the template),</span>
        <span class="c1"># then adding nodes from the template may still result in missing nodes.</span>
        <span class="c1"># So we&#39;ll use random placement for anything that&#39;s still missing.</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">add_random_nodes</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">visible</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">add_random_nodes</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">visible</span><span class="p">):</span>
        <span class="c1"># the rect that&#39;s currently visible in the window view</span>
        <span class="n">in_view_rect</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">getVisibleRect</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;skeleton&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">instance</span><span class="o">.</span><span class="n">nodes</span> <span class="ow">or</span> <span class="n">instance</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">.</span><span class="n">isnan</span><span class="p">():</span>
                <span class="c1"># pick random points within currently zoomed view</span>
                <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_xy_in_rect</span><span class="p">(</span><span class="n">in_view_rect</span><span class="p">)</span>
                <span class="c1"># set point for node</span>
                <span class="n">instance</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="n">visible</span><span class="p">)</span>

<div class="viewcode-block" id="AddMissingInstanceNodes.get_xy_in_rect"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.AddMissingInstanceNodes.get_xy_in_rect">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_xy_in_rect</span><span class="p">(</span><span class="n">rect</span><span class="p">:</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QRectF</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns random x, y coordinates within given rect.&quot;&quot;&quot;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">rect</span><span class="o">.</span><span class="n">x</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="n">rect</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">*</span> <span class="n">rect</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">rect</span><span class="o">.</span><span class="n">y</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="n">rect</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">*</span> <span class="n">rect</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span></div>

<div class="viewcode-block" id="AddMissingInstanceNodes.get_rect_center_xy"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.AddMissingInstanceNodes.get_rect_center_xy">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_rect_center_xy</span><span class="p">(</span><span class="n">rect</span><span class="p">:</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QRectF</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns x, y at center of rect.&quot;&quot;&quot;</span></div>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">add_nodes_from_template</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">context</span><span class="p">,</span>
        <span class="n">instance</span><span class="p">,</span>
        <span class="n">visible</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">center_point</span><span class="p">:</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPoint</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="kn">from</span> <span class="nn">sleap.info</span> <span class="kn">import</span> <span class="n">align</span>

        <span class="c1"># Get the &quot;template&quot; instance</span>
        <span class="n">template_points</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">get_template_instance_points</span><span class="p">(</span>
            <span class="n">skeleton</span><span class="o">=</span><span class="n">instance</span><span class="o">.</span><span class="n">skeleton</span>
        <span class="p">)</span>

        <span class="c1"># Align the template on to the current instance with missing points</span>
        <span class="k">if</span> <span class="n">instance</span><span class="o">.</span><span class="n">points</span><span class="p">:</span>
            <span class="n">aligned_template</span> <span class="o">=</span> <span class="n">align</span><span class="o">.</span><span class="n">align_instance_points</span><span class="p">(</span>
                <span class="n">source_points_array</span><span class="o">=</span><span class="n">template_points</span><span class="p">,</span>
                <span class="n">target_points_array</span><span class="o">=</span><span class="n">instance</span><span class="o">.</span><span class="n">points_array</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">template_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">template_points</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

            <span class="n">center_point</span> <span class="o">=</span> <span class="n">center_point</span> <span class="ow">or</span> <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">getVisibleRect</span><span class="p">()</span><span class="o">.</span><span class="n">center</span><span class="p">()</span>
            <span class="n">center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">center_point</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span> <span class="n">center_point</span><span class="o">.</span><span class="n">y</span><span class="p">()])</span>

            <span class="n">aligned_template</span> <span class="o">=</span> <span class="n">template_points</span> <span class="o">+</span> <span class="p">(</span><span class="n">center</span> <span class="o">-</span> <span class="n">template_mean</span><span class="p">)</span>

        <span class="c1"># Make missing points from the aligned template</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">skeleton</span><span class="o">.</span><span class="n">nodes</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">:</span>
                <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">aligned_template</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">instance</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="n">visible</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">add_force_directed_nodes</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">visible</span><span class="p">,</span> <span class="n">center_point</span><span class="p">:</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QPoint</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">):</span>
        <span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>

        <span class="n">center_point</span> <span class="o">=</span> <span class="n">center_point</span> <span class="ow">or</span> <span class="n">context</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">getVisibleRect</span><span class="p">()</span><span class="o">.</span><span class="n">center</span><span class="p">()</span>
        <span class="n">center_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="n">center_point</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span> <span class="n">center_point</span><span class="o">.</span><span class="n">y</span><span class="p">())</span>

        <span class="n">node_positions</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">spring_layout</span><span class="p">(</span>
            <span class="n">G</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;skeleton&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">graph</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="n">center_tuple</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">50</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">node_positions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">instance</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">visible</span><span class="o">=</span><span class="n">visible</span><span class="p">)</span></div>


<div class="viewcode-block" id="AddUserInstancesFromPredictions"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.AddUserInstancesFromPredictions">[docs]</a><span class="k">class</span> <span class="nc">AddUserInstancesFromPredictions</span><span class="p">(</span><span class="n">EditCommand</span><span class="p">):</span>
    <span class="n">topics</span> <span class="o">=</span> <span class="p">[</span><span class="n">UpdateTopic</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span> <span class="n">UpdateTopic</span><span class="o">.</span><span class="n">project_instances</span><span class="p">]</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">make_instance_from_predicted_instance</span><span class="p">(</span>
        <span class="n">copy_instance</span><span class="p">:</span> <span class="n">PredictedInstance</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Instance</span><span class="p">:</span>
        <span class="c1"># create the new instance</span>
        <span class="n">new_instance</span> <span class="o">=</span> <span class="n">Instance</span><span class="p">(</span>
            <span class="n">skeleton</span><span class="o">=</span><span class="n">copy_instance</span><span class="o">.</span><span class="n">skeleton</span><span class="p">,</span>
            <span class="n">from_predicted</span><span class="o">=</span><span class="n">copy_instance</span><span class="p">,</span>
            <span class="n">frame</span><span class="o">=</span><span class="n">copy_instance</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># go through each node in skeleton</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">new_instance</span><span class="o">.</span><span class="n">skeleton</span><span class="o">.</span><span class="n">node_names</span><span class="p">:</span>
            <span class="c1"># if we&#39;re copying from a skeleton that has this node</span>
            <span class="k">if</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">copy_instance</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">copy_instance</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">.</span><span class="n">isnan</span><span class="p">():</span>
                <span class="c1"># just copy x, y, and visible</span>
                <span class="c1"># we don&#39;t want to copy a PredictedPoint or score attribute</span>
                <span class="n">new_instance</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">copy_instance</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">copy_instance</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
                    <span class="n">visible</span><span class="o">=</span><span class="n">copy_instance</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">.</span><span class="n">visible</span><span class="p">,</span>
                    <span class="n">complete</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="c1"># copy the track</span>
        <span class="n">new_instance</span><span class="o">.</span><span class="n">track</span> <span class="o">=</span> <span class="n">copy_instance</span><span class="o">.</span><span class="n">track</span>

        <span class="k">return</span> <span class="n">new_instance</span>

<div class="viewcode-block" id="AddUserInstancesFromPredictions.do_action"><a class="viewcode-back" href="../../../_autosummary/sleap.gui.commands.html#sleap.gui.commands.AddUserInstancesFromPredictions.do_action">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">do_action</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="n">CommandContext</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;labeled_frame&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">new_instances</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">unused_predictions</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;labeled_frame&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unused_predictions</span>
        <span class="k">for</span> <span class="n">predicted_instance</span> <span class="ow">in</span> <span class="n">unused_predictions</span><span class="p">:</span>
            <span class="n">new_instances</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">make_instance_from_predicted_instance</span><span class="p">(</span><span class="n">predicted_instance</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="c1"># Add the instances</span>
        <span class="k">for</span> <span class="n">new_instance</span> <span class="ow">in</span> <span class="n">new_instances</span><span class="p">:</span>
            <span class="n">context</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">add_instance</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="s2">&quot;labeled_frame&quot;</span><span class="p">],</span> <span class="n">new_instance</span><span class="p">)</span></div></div>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">SLEAP</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../guides/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../guides/index.html">Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../guides/reference.html">Feature Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api.html">API</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019–2020, Murthy Lab @ Princeton.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.0.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>