

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>sleap.gui.app &mdash; SLEAP  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> SLEAP
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">SLEAP Package</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../skeleton.html">Skeleton</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../video.html">Video</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../instance.html">Instance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dataset.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../training.html">Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../inference.html">Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gui.html">GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../misc.html">Misc</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">SLEAP</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>sleap.gui.app</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for sleap.gui.app</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Main GUI application for labeling, active learning, and proofreading.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">PySide2</span> <span class="k">import</span> <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtWidgets</span>
<span class="kn">from</span> <span class="nn">PySide2.QtCore</span> <span class="k">import</span> <span class="n">Qt</span><span class="p">,</span> <span class="n">QEvent</span>

<span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="k">import</span> <span class="n">QApplication</span><span class="p">,</span> <span class="n">QMainWindow</span><span class="p">,</span> <span class="n">QWidget</span><span class="p">,</span> <span class="n">QDockWidget</span>
<span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="k">import</span> <span class="n">QVBoxLayout</span><span class="p">,</span> <span class="n">QHBoxLayout</span><span class="p">,</span> <span class="n">QGroupBox</span>
<span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="k">import</span> <span class="n">QLabel</span><span class="p">,</span> <span class="n">QPushButton</span><span class="p">,</span> <span class="n">QComboBox</span>
<span class="kn">from</span> <span class="nn">PySide2.QtWidgets</span> <span class="k">import</span> <span class="n">QMessageBox</span>

<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">operator</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">from</span> <span class="nn">pkg_resources</span> <span class="k">import</span> <span class="n">Requirement</span><span class="p">,</span> <span class="n">resource_filename</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="k">import</span> <span class="n">PurePath</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="k">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Iterator</span><span class="p">,</span> <span class="n">Optional</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">sleap.skeleton</span> <span class="k">import</span> <span class="n">Skeleton</span>
<span class="kn">from</span> <span class="nn">sleap.instance</span> <span class="k">import</span> <span class="n">Instance</span><span class="p">,</span> <span class="n">PredictedInstance</span><span class="p">,</span> <span class="n">Point</span><span class="p">,</span> <span class="n">Track</span>
<span class="kn">from</span> <span class="nn">sleap.io.video</span> <span class="k">import</span> <span class="n">Video</span>
<span class="kn">from</span> <span class="nn">sleap.io.dataset</span> <span class="k">import</span> <span class="n">Labels</span>
<span class="kn">from</span> <span class="nn">sleap.info.summary</span> <span class="k">import</span> <span class="n">StatisticSeries</span>
<span class="kn">from</span> <span class="nn">sleap.gui.video</span> <span class="k">import</span> <span class="n">QtVideoPlayer</span>
<span class="kn">from</span> <span class="nn">sleap.gui.dataviews</span> <span class="k">import</span> <span class="p">(</span>
    <span class="n">VideosTable</span><span class="p">,</span>
    <span class="n">SkeletonNodesTable</span><span class="p">,</span>
    <span class="n">SkeletonEdgesTable</span><span class="p">,</span>
    <span class="n">LabeledFrameTable</span><span class="p">,</span>
    <span class="n">SkeletonNodeModel</span><span class="p">,</span>
    <span class="n">SuggestionsTable</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">sleap.gui.importvideos</span> <span class="k">import</span> <span class="n">ImportVideos</span>
<span class="kn">from</span> <span class="nn">sleap.gui.filedialog</span> <span class="k">import</span> <span class="n">FileDialog</span>
<span class="kn">from</span> <span class="nn">sleap.gui.formbuilder</span> <span class="k">import</span> <span class="n">YamlFormWidget</span>
<span class="kn">from</span> <span class="nn">sleap.gui.merge</span> <span class="k">import</span> <span class="n">MergeDialog</span>
<span class="kn">from</span> <span class="nn">sleap.gui.shortcuts</span> <span class="k">import</span> <span class="n">Shortcuts</span><span class="p">,</span> <span class="n">ShortcutDialog</span>
<span class="kn">from</span> <span class="nn">sleap.gui.suggestions</span> <span class="k">import</span> <span class="n">VideoFrameSuggestions</span>

<span class="kn">from</span> <span class="nn">sleap.gui.overlays.tracks</span> <span class="k">import</span> <span class="p">(</span>
    <span class="n">TrackColorManager</span><span class="p">,</span>
    <span class="n">TrackTrailOverlay</span><span class="p">,</span>
    <span class="n">TrackListOverlay</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">sleap.gui.overlays.instance</span> <span class="k">import</span> <span class="n">InstanceOverlay</span>
<span class="kn">from</span> <span class="nn">sleap.gui.overlays.anchors</span> <span class="k">import</span> <span class="n">NegativeAnchorOverlay</span>

<span class="n">OPEN_IN_NEW</span> <span class="o">=</span> <span class="kc">True</span>


<div class="viewcode-block" id="MainWindow"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow">[docs]</a><span class="k">class</span> <span class="nc">MainWindow</span><span class="p">(</span><span class="n">QMainWindow</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The SLEAP GUI application.</span>

<span class="sd">    Each project (`Labels` dataset) that you have loaded in the GUI will</span>
<span class="sd">    have its own `MainWindow` object.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        labels: The :class:`Labels` dataset. If None, a new, empty project</span>
<span class="sd">            (i.e., :class:`Labels` object) will be created.</span>
<span class="sd">        skeleton: The active :class:`Skeleton` for the project in the gui</span>
<span class="sd">        video: The active :class:`Video` in view in the gui</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">labels</span><span class="p">:</span> <span class="n">Labels</span>
    <span class="n">skeleton</span><span class="p">:</span> <span class="n">Skeleton</span>
    <span class="n">video</span><span class="p">:</span> <span class="n">Video</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">labels_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize the app.</span>

<span class="sd">        Args:</span>
<span class="sd">            labels_path: Path to saved :class:`Labels` dataset.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MainWindow</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="n">Labels</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span> <span class="o">=</span> <span class="n">Skeleton</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labeled_frame</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">video</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">video_idx</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_menu_actions</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buttons</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_child_windows</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_color_palette</span> <span class="o">=</span> <span class="s2">&quot;standard&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_color_manager</span> <span class="o">=</span> <span class="n">TrackColorManager</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_color_palette</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">overlays</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_show_labels</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_show_edges</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_auto_zoom</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">changestack_clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initialize_gui</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">labels_path</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loadProject</span><span class="p">(</span><span class="n">labels_path</span><span class="p">)</span>

<div class="viewcode-block" id="MainWindow.event"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.event">[docs]</a>    <span class="k">def</span> <span class="nf">event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span> <span class="n">QEvent</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Custom event handler.</span>

<span class="sd">        We use this to ignore events that would clear status bar.</span>

<span class="sd">        Args:</span>
<span class="sd">            e: The event.</span>
<span class="sd">        Returns:</span>
<span class="sd">            True if we ignore event, otherwise returns whatever the usual</span>
<span class="sd">            event handler would return.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">type</span><span class="p">()</span> <span class="o">==</span> <span class="n">QEvent</span><span class="o">.</span><span class="n">StatusTip</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">tip</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">event</span><span class="p">(</span><span class="n">e</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.changestack_push"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.changestack_push">[docs]</a>    <span class="k">def</span> <span class="nf">changestack_push</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">change</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds to stack of changes made by user.&quot;&quot;&quot;</span>
        <span class="c1"># Currently the change doesn&#39;t store any data, and we&#39;re only using this</span>
        <span class="c1"># to determine if there are unsaved changes. Eventually we could use this</span>
        <span class="c1"># to support undo/redo.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_change_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">change</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.changestack_savepoint"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.changestack_savepoint">[docs]</a>    <span class="k">def</span> <span class="nf">changestack_savepoint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Marks that project was just saved.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">changestack_push</span><span class="p">(</span><span class="s2">&quot;SAVE&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.changestack_clear"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.changestack_clear">[docs]</a>    <span class="k">def</span> <span class="nf">changestack_clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Clears stack of changes.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_change_stack</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.changestack_start_atomic"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.changestack_start_atomic">[docs]</a>    <span class="k">def</span> <span class="nf">changestack_start_atomic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Marks that we want to track a set of changes as a single change.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">changestack_push</span><span class="p">(</span><span class="s2">&quot;ATOMIC_START&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.changestack_end_atomic"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.changestack_end_atomic">[docs]</a>    <span class="k">def</span> <span class="nf">changestack_end_atomic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Marks that we want finished the set of changes to track together.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">changestack_push</span><span class="p">(</span><span class="s2">&quot;ATOMIC_END&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.changestack_has_changes"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.changestack_has_changes">[docs]</a>    <span class="k">def</span> <span class="nf">changestack_has_changes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Returns whether there are any unsaved changes.&quot;&quot;&quot;</span>
        <span class="c1"># True iff there are no unsaved changed</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_change_stack</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_change_stack</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;SAVE&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">filename</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns filename for current project.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filename</span>

    <span class="nd">@filename</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">filename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets filename for current project. Doesn&#39;t load file.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_filename</span> <span class="o">=</span> <span class="n">x</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_initialize_gui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates menus, dock windows, starts timers to update gui state.&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_create_video_player</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_overlays</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_create_menus</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_create_dock_windows</span><span class="p">()</span>

        <span class="c1"># Create timer to update state of gui at regular intervals</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_gui_timer</span> <span class="o">=</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QTimer</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_gui_timer</span><span class="o">.</span><span class="n">timeout</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_update_gui_state</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_gui_timer</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_create_video_player</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates and connects :class:`QtVideoPlayer` for gui.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">player</span> <span class="o">=</span> <span class="n">QtVideoPlayer</span><span class="p">(</span><span class="n">color_manager</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_color_manager</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">changedPlot</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_after_plot_update</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">changedData</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">inst</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">changestack_push</span><span class="p">(</span><span class="s2">&quot;viewer change&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">instanceDoubleClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doubleClickInstance</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">seekbar</span><span class="o">.</span><span class="n">selectionChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">updateStatusMessage</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setCentralWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_create_menus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates main application menus.&quot;&quot;&quot;</span>
        <span class="n">shortcuts</span> <span class="o">=</span> <span class="n">Shortcuts</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">_menu_item</span><span class="p">(</span><span class="n">menu</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">action</span><span class="p">:</span> <span class="n">Callable</span><span class="p">):</span>
            <span class="n">menu_item</span> <span class="o">=</span> <span class="n">menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">shortcuts</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_menu_actions</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">menu_item</span>

        <span class="c1">### File Menu ###</span>

        <span class="n">fileMenu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuBar</span><span class="p">()</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="s2">&quot;File&quot;</span><span class="p">)</span>
        <span class="n">_menu_item</span><span class="p">(</span><span class="n">fileMenu</span><span class="p">,</span> <span class="s2">&quot;new&quot;</span><span class="p">,</span> <span class="s2">&quot;New Project&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">newProject</span><span class="p">)</span>
        <span class="n">_menu_item</span><span class="p">(</span><span class="n">fileMenu</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">,</span> <span class="s2">&quot;Open Project...&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">openProject</span><span class="p">)</span>
        <span class="n">_menu_item</span><span class="p">(</span>
            <span class="n">fileMenu</span><span class="p">,</span> <span class="s2">&quot;import predictions&quot;</span><span class="p">,</span> <span class="s2">&quot;Import Labels...&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">importPredictions</span>
        <span class="p">)</span>

        <span class="n">fileMenu</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
        <span class="n">_menu_item</span><span class="p">(</span><span class="n">fileMenu</span><span class="p">,</span> <span class="s2">&quot;add videos&quot;</span><span class="p">,</span> <span class="s2">&quot;Add Videos...&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">addVideo</span><span class="p">)</span>

        <span class="n">fileMenu</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
        <span class="n">_menu_item</span><span class="p">(</span><span class="n">fileMenu</span><span class="p">,</span> <span class="s2">&quot;save&quot;</span><span class="p">,</span> <span class="s2">&quot;Save&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">saveProject</span><span class="p">)</span>
        <span class="n">_menu_item</span><span class="p">(</span><span class="n">fileMenu</span><span class="p">,</span> <span class="s2">&quot;save as&quot;</span><span class="p">,</span> <span class="s2">&quot;Save As...&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">saveProjectAs</span><span class="p">)</span>

        <span class="n">fileMenu</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
        <span class="n">_menu_item</span><span class="p">(</span><span class="n">fileMenu</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">,</span> <span class="s2">&quot;Quit&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>

        <span class="c1">### Go Menu ###</span>

        <span class="n">goMenu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuBar</span><span class="p">()</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="s2">&quot;Go&quot;</span><span class="p">)</span>

        <span class="n">_menu_item</span><span class="p">(</span>
            <span class="n">goMenu</span><span class="p">,</span> <span class="s2">&quot;goto next labeled&quot;</span><span class="p">,</span> <span class="s2">&quot;Next Labeled Frame&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nextLabeledFrame</span>
        <span class="p">)</span>
        <span class="n">_menu_item</span><span class="p">(</span>
            <span class="n">goMenu</span><span class="p">,</span>
            <span class="s2">&quot;goto prev labeled&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Previous Labeled Frame&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">previousLabeledFrame</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">_menu_item</span><span class="p">(</span>
            <span class="n">goMenu</span><span class="p">,</span>
            <span class="s2">&quot;goto next user&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Next User Labeled Frame&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nextUserLabeledFrame</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">_menu_item</span><span class="p">(</span>
            <span class="n">goMenu</span><span class="p">,</span> <span class="s2">&quot;goto next suggestion&quot;</span><span class="p">,</span> <span class="s2">&quot;Next Suggestion&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nextSuggestedFrame</span>
        <span class="p">)</span>
        <span class="n">_menu_item</span><span class="p">(</span>
            <span class="n">goMenu</span><span class="p">,</span>
            <span class="s2">&quot;goto prev suggestion&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Previous Suggestion&quot;</span><span class="p">,</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">nextSuggestedFrame</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">_menu_item</span><span class="p">(</span>
            <span class="n">goMenu</span><span class="p">,</span>
            <span class="s2">&quot;goto next track spawn&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Next Track Spawn Frame&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nextTrackFrame</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">goMenu</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>

        <span class="n">_menu_item</span><span class="p">(</span><span class="n">goMenu</span><span class="p">,</span> <span class="s2">&quot;next video&quot;</span><span class="p">,</span> <span class="s2">&quot;Next Video&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nextVideo</span><span class="p">)</span>
        <span class="n">_menu_item</span><span class="p">(</span><span class="n">goMenu</span><span class="p">,</span> <span class="s2">&quot;prev video&quot;</span><span class="p">,</span> <span class="s2">&quot;Previous Video&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">previousVideo</span><span class="p">)</span>

        <span class="n">goMenu</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>

        <span class="n">_menu_item</span><span class="p">(</span><span class="n">goMenu</span><span class="p">,</span> <span class="s2">&quot;goto frame&quot;</span><span class="p">,</span> <span class="s2">&quot;Go to Frame...&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">gotoFrame</span><span class="p">)</span>

        <span class="c1">### View Menu ###</span>

        <span class="n">viewMenu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuBar</span><span class="p">()</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="s2">&quot;View&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">viewMenu</span> <span class="o">=</span> <span class="n">viewMenu</span>  <span class="c1"># store as attribute so docks can add items</span>

        <span class="n">viewMenu</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
        <span class="n">_menu_item</span><span class="p">(</span>
            <span class="n">viewMenu</span><span class="p">,</span>
            <span class="s2">&quot;color predicted&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Color Predicted Instances&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toggleColorPredicted</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">paletteMenu</span> <span class="o">=</span> <span class="n">viewMenu</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="s2">&quot;Color Palette&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">palette_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_color_manager</span><span class="o">.</span><span class="n">palette_names</span><span class="p">:</span>
            <span class="n">menu_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">paletteMenu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span>
                <span class="n">f</span><span class="s2">&quot;</span><span class="si">{palette_name}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="o">=</span><span class="n">palette_name</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">setPalette</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">menu_item</span><span class="o">.</span><span class="n">setCheckable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setPalette</span><span class="p">(</span><span class="s2">&quot;standard&quot;</span><span class="p">)</span>

        <span class="n">viewMenu</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">seekbarHeaderMenu</span> <span class="o">=</span> <span class="n">viewMenu</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="s2">&quot;Seekbar Header&quot;</span><span class="p">)</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;None&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Point Displacement (sum)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Point Displacement (max)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Instance Score (sum)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Instance Score (min)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Point Score (sum)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Point Score (min)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Number of predicted points&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">header</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">:</span>
            <span class="n">menu_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">seekbarHeaderMenu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span>
                <span class="n">header</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="o">=</span><span class="n">header</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">setSeekbarHeader</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">menu_item</span><span class="o">.</span><span class="n">setCheckable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSeekbarHeader</span><span class="p">(</span><span class="s2">&quot;None&quot;</span><span class="p">)</span>

        <span class="n">viewMenu</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>

        <span class="n">_menu_item</span><span class="p">(</span><span class="n">viewMenu</span><span class="p">,</span> <span class="s2">&quot;show labels&quot;</span><span class="p">,</span> <span class="s2">&quot;Show Node Names&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toggleLabels</span><span class="p">)</span>
        <span class="n">_menu_item</span><span class="p">(</span><span class="n">viewMenu</span><span class="p">,</span> <span class="s2">&quot;show edges&quot;</span><span class="p">,</span> <span class="s2">&quot;Show Edges&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toggleEdges</span><span class="p">)</span>
        <span class="n">_menu_item</span><span class="p">(</span><span class="n">viewMenu</span><span class="p">,</span> <span class="s2">&quot;show trails&quot;</span><span class="p">,</span> <span class="s2">&quot;Show Trails&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toggleTrails</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">trailLengthMenu</span> <span class="o">=</span> <span class="n">viewMenu</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="s2">&quot;Trail Length&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">length_option</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">):</span>
            <span class="n">menu_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trailLengthMenu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span>
                <span class="n">f</span><span class="s2">&quot;</span><span class="si">{length_option}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="o">=</span><span class="n">length_option</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">setTrailLength</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">menu_item</span><span class="o">.</span><span class="n">setCheckable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">viewMenu</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>

        <span class="n">_menu_item</span><span class="p">(</span><span class="n">viewMenu</span><span class="p">,</span> <span class="s2">&quot;fit&quot;</span><span class="p">,</span> <span class="s2">&quot;Fit Instances to View&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">toggleAutoZoom</span><span class="p">)</span>

        <span class="n">viewMenu</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>

        <span class="c1"># set menu checkmarks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_menu_actions</span><span class="p">[</span><span class="s2">&quot;show labels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setCheckable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_menu_actions</span><span class="p">[</span><span class="s2">&quot;show labels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_show_labels</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_menu_actions</span><span class="p">[</span><span class="s2">&quot;show edges&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setCheckable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_menu_actions</span><span class="p">[</span><span class="s2">&quot;show edges&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_show_edges</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_menu_actions</span><span class="p">[</span><span class="s2">&quot;show trails&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setCheckable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_menu_actions</span><span class="p">[</span><span class="s2">&quot;show trails&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">overlays</span><span class="p">[</span><span class="s2">&quot;trails&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_menu_actions</span><span class="p">[</span><span class="s2">&quot;color predicted&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setCheckable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_menu_actions</span><span class="p">[</span><span class="s2">&quot;color predicted&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">overlays</span><span class="p">[</span><span class="s2">&quot;instance&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">color_predicted</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_menu_actions</span><span class="p">[</span><span class="s2">&quot;fit&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setCheckable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1">### Label Menu ###</span>

        <span class="n">labelMenu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuBar</span><span class="p">()</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="s2">&quot;Labels&quot;</span><span class="p">)</span>
        <span class="n">_menu_item</span><span class="p">(</span><span class="n">labelMenu</span><span class="p">,</span> <span class="s2">&quot;add instance&quot;</span><span class="p">,</span> <span class="s2">&quot;Add Instance&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">newInstance</span><span class="p">)</span>
        <span class="n">_menu_item</span><span class="p">(</span>
            <span class="n">labelMenu</span><span class="p">,</span> <span class="s2">&quot;delete instance&quot;</span><span class="p">,</span> <span class="s2">&quot;Delete Instance&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">deleteSelectedInstance</span>
        <span class="p">)</span>

        <span class="n">labelMenu</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">track_menu</span> <span class="o">=</span> <span class="n">labelMenu</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="s2">&quot;Set Instance Track&quot;</span><span class="p">)</span>
        <span class="n">_menu_item</span><span class="p">(</span>
            <span class="n">labelMenu</span><span class="p">,</span> <span class="s2">&quot;transpose&quot;</span><span class="p">,</span> <span class="s2">&quot;Transpose Instance Tracks&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">transposeInstance</span>
        <span class="p">)</span>
        <span class="n">_menu_item</span><span class="p">(</span>
            <span class="n">labelMenu</span><span class="p">,</span>
            <span class="s2">&quot;delete track&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Delete Instance and Track&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deleteSelectedInstanceTrack</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">labelMenu</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>

        <span class="n">_menu_item</span><span class="p">(</span>
            <span class="n">labelMenu</span><span class="p">,</span>
            <span class="s2">&quot;select next&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Select Next Instance&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">nextSelection</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">_menu_item</span><span class="p">(</span>
            <span class="n">labelMenu</span><span class="p">,</span>
            <span class="s2">&quot;clear selection&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Clear Selection&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">clearSelection</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">labelMenu</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>

        <span class="c1">### Predict Menu ###</span>

        <span class="n">predictionMenu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuBar</span><span class="p">()</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="s2">&quot;Predict&quot;</span><span class="p">)</span>

        <span class="n">_menu_item</span><span class="p">(</span>
            <span class="n">predictionMenu</span><span class="p">,</span>
            <span class="s2">&quot;active learning&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Run Active Learning...&quot;</span><span class="p">,</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">showLearningDialog</span><span class="p">(</span><span class="s2">&quot;learning&quot;</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">_menu_item</span><span class="p">(</span>
            <span class="n">predictionMenu</span><span class="p">,</span>
            <span class="s2">&quot;inference&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Run Inference...&quot;</span><span class="p">,</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">showLearningDialog</span><span class="p">(</span><span class="s2">&quot;inference&quot;</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="n">_menu_item</span><span class="p">(</span>
            <span class="n">predictionMenu</span><span class="p">,</span>
            <span class="s2">&quot;learning expert&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Expert Controls...&quot;</span><span class="p">,</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">showLearningDialog</span><span class="p">(</span><span class="s2">&quot;expert&quot;</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="n">predictionMenu</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
        <span class="n">_menu_item</span><span class="p">(</span>
            <span class="n">predictionMenu</span><span class="p">,</span>
            <span class="s2">&quot;negative sample&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Mark Negative Training Sample...&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">markNegativeAnchor</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">_menu_item</span><span class="p">(</span>
            <span class="n">predictionMenu</span><span class="p">,</span>
            <span class="s2">&quot;clear negative samples&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Clear Current Frame Negative Samples&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clearFrameNegativeAnchors</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">predictionMenu</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
        <span class="n">_menu_item</span><span class="p">(</span>
            <span class="n">predictionMenu</span><span class="p">,</span>
            <span class="s2">&quot;visualize models&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Visualize Model Outputs...&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">visualizeOutputs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">predictionMenu</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
        <span class="n">_menu_item</span><span class="p">(</span>
            <span class="n">predictionMenu</span><span class="p">,</span>
            <span class="s2">&quot;remove predictions&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Delete All Predictions...&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deletePredictions</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">_menu_item</span><span class="p">(</span>
            <span class="n">predictionMenu</span><span class="p">,</span>
            <span class="s2">&quot;remove clip predictions&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Delete Predictions from Clip...&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deleteClipPredictions</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">_menu_item</span><span class="p">(</span>
            <span class="n">predictionMenu</span><span class="p">,</span>
            <span class="s2">&quot;remove area predictions&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Delete Predictions from Area...&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deleteAreaPredictions</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">_menu_item</span><span class="p">(</span>
            <span class="n">predictionMenu</span><span class="p">,</span>
            <span class="s2">&quot;remove score predictions&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Delete Predictions with Low Score...&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deleteLowScorePredictions</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">_menu_item</span><span class="p">(</span>
            <span class="n">predictionMenu</span><span class="p">,</span>
            <span class="s2">&quot;remove frame limit predictions&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Delete Predictions beyond Frame Limit...&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deleteFrameLimitPredictions</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">predictionMenu</span><span class="o">.</span><span class="n">addSeparator</span><span class="p">()</span>
        <span class="n">_menu_item</span><span class="p">(</span>
            <span class="n">predictionMenu</span><span class="p">,</span>
            <span class="s2">&quot;export frames&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Export Training Package...&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">exportLabeledFrames</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">_menu_item</span><span class="p">(</span>
            <span class="n">predictionMenu</span><span class="p">,</span>
            <span class="s2">&quot;export clip&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Export Labeled Clip...&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">exportLabeledClip</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1">############</span>

        <span class="n">helpMenu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuBar</span><span class="p">()</span><span class="o">.</span><span class="n">addMenu</span><span class="p">(</span><span class="s2">&quot;Help&quot;</span><span class="p">)</span>
        <span class="n">helpMenu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="s2">&quot;Keyboard Reference&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">openKeyRef</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_create_dock_windows</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create dock windows and connects them to gui.&quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">_make_dock</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">widgets</span><span class="o">=</span><span class="p">[],</span> <span class="n">tab_with</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
            <span class="n">dock</span> <span class="o">=</span> <span class="n">QDockWidget</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="n">dock</span><span class="o">.</span><span class="n">setAllowedAreas</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">LeftDockWidgetArea</span> <span class="o">|</span> <span class="n">Qt</span><span class="o">.</span><span class="n">RightDockWidgetArea</span><span class="p">)</span>
            <span class="n">dock_widget</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
            <span class="n">layout</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">widget</span> <span class="ow">in</span> <span class="n">widgets</span><span class="p">:</span>
                <span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span>
            <span class="n">dock_widget</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>
            <span class="n">dock</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="n">dock_widget</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addDockWidget</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">RightDockWidgetArea</span><span class="p">,</span> <span class="n">dock</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">viewMenu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">dock</span><span class="o">.</span><span class="n">toggleViewAction</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">tab_with</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tabifyDockWidget</span><span class="p">(</span><span class="n">tab_with</span><span class="p">,</span> <span class="n">dock</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">layout</span>

        <span class="c1">####### Videos #######</span>
        <span class="n">videos_layout</span> <span class="o">=</span> <span class="n">_make_dock</span><span class="p">(</span><span class="s2">&quot;Videos&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">videosTable</span> <span class="o">=</span> <span class="n">VideosTable</span><span class="p">()</span>
        <span class="n">videos_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">videosTable</span><span class="p">)</span>
        <span class="n">hb</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">btn</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Show video&quot;</span><span class="p">)</span>
        <span class="n">btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">activateSelectedVideo</span><span class="p">)</span>
        <span class="n">hb</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">btn</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buttons</span><span class="p">[</span><span class="s2">&quot;show video&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">btn</span>
        <span class="n">btn</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Add videos&quot;</span><span class="p">)</span>
        <span class="n">btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">addVideo</span><span class="p">)</span>
        <span class="n">hb</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">btn</span><span class="p">)</span>
        <span class="n">btn</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Remove video&quot;</span><span class="p">)</span>
        <span class="n">btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">removeVideo</span><span class="p">)</span>
        <span class="n">hb</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">btn</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buttons</span><span class="p">[</span><span class="s2">&quot;remove video&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">btn</span>
        <span class="n">hbw</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
        <span class="n">hbw</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">hb</span><span class="p">)</span>
        <span class="n">videos_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">hbw</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">videosTable</span><span class="o">.</span><span class="n">doubleClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">activateSelectedVideo</span><span class="p">)</span>

        <span class="c1">####### Skeleton #######</span>
        <span class="n">skeleton_layout</span> <span class="o">=</span> <span class="n">_make_dock</span><span class="p">(</span>
            <span class="s2">&quot;Skeleton&quot;</span><span class="p">,</span> <span class="n">tab_with</span><span class="o">=</span><span class="n">videos_layout</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="n">gb</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;Nodes&quot;</span><span class="p">)</span>
        <span class="n">vb</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skeletonNodesTable</span> <span class="o">=</span> <span class="n">SkeletonNodesTable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span><span class="p">)</span>
        <span class="n">vb</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skeletonNodesTable</span><span class="p">)</span>
        <span class="n">hb</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">btn</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;New node&quot;</span><span class="p">)</span>
        <span class="n">btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newNode</span><span class="p">)</span>
        <span class="n">hb</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">btn</span><span class="p">)</span>
        <span class="n">btn</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Delete node&quot;</span><span class="p">)</span>
        <span class="n">btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deleteNode</span><span class="p">)</span>
        <span class="n">hb</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">btn</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buttons</span><span class="p">[</span><span class="s2">&quot;delete node&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">btn</span>
        <span class="n">hbw</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
        <span class="n">hbw</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">hb</span><span class="p">)</span>
        <span class="n">vb</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">hbw</span><span class="p">)</span>
        <span class="n">gb</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">vb</span><span class="p">)</span>
        <span class="n">skeleton_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">gb</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">_update_edge_src</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skeletonEdgesDst</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">skeleton</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span>

        <span class="n">gb</span> <span class="o">=</span> <span class="n">QGroupBox</span><span class="p">(</span><span class="s2">&quot;Edges&quot;</span><span class="p">)</span>
        <span class="n">vb</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skeletonEdgesTable</span> <span class="o">=</span> <span class="n">SkeletonEdgesTable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span><span class="p">)</span>
        <span class="n">vb</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skeletonEdgesTable</span><span class="p">)</span>
        <span class="n">hb</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skeletonEdgesSrc</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skeletonEdgesSrc</span><span class="o">.</span><span class="n">setEditable</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skeletonEdgesSrc</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">_update_edge_src</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skeletonEdgesSrc</span><span class="o">.</span><span class="n">setModel</span><span class="p">(</span><span class="n">SkeletonNodeModel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span><span class="p">))</span>
        <span class="n">hb</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skeletonEdgesSrc</span><span class="p">)</span>
        <span class="n">hb</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;to&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skeletonEdgesDst</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skeletonEdgesDst</span><span class="o">.</span><span class="n">setEditable</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">hb</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skeletonEdgesDst</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skeletonEdgesDst</span><span class="o">.</span><span class="n">setModel</span><span class="p">(</span>
            <span class="n">SkeletonNodeModel</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">skeletonEdgesSrc</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">btn</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Add edge&quot;</span><span class="p">)</span>
        <span class="n">btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newEdge</span><span class="p">)</span>
        <span class="n">hb</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">btn</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buttons</span><span class="p">[</span><span class="s2">&quot;add edge&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">btn</span>
        <span class="n">btn</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Delete edge&quot;</span><span class="p">)</span>
        <span class="n">btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deleteEdge</span><span class="p">)</span>
        <span class="n">hb</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">btn</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buttons</span><span class="p">[</span><span class="s2">&quot;delete edge&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">btn</span>
        <span class="n">hbw</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
        <span class="n">hbw</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">hb</span><span class="p">)</span>
        <span class="n">vb</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">hbw</span><span class="p">)</span>
        <span class="n">gb</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">vb</span><span class="p">)</span>
        <span class="n">skeleton_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">gb</span><span class="p">)</span>

        <span class="n">hb</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">btn</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Load Skeleton&quot;</span><span class="p">)</span>
        <span class="n">btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">openSkeleton</span><span class="p">)</span>
        <span class="n">hb</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">btn</span><span class="p">)</span>
        <span class="n">btn</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Save Skeleton&quot;</span><span class="p">)</span>
        <span class="n">btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">saveSkeleton</span><span class="p">)</span>
        <span class="n">hb</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">btn</span><span class="p">)</span>
        <span class="n">hbw</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
        <span class="n">hbw</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">hb</span><span class="p">)</span>
        <span class="n">skeleton_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">hbw</span><span class="p">)</span>

        <span class="c1"># update edge UI when change to nodes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skeletonNodesTable</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">dataChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">updateEdges</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skeletonNodesTable</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">dataChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">changestack_push</span><span class="p">)</span>

        <span class="c1">####### Instances #######</span>
        <span class="n">instances_layout</span> <span class="o">=</span> <span class="n">_make_dock</span><span class="p">(</span><span class="s2">&quot;Instances&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">instancesTable</span> <span class="o">=</span> <span class="n">LabeledFrameTable</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">)</span>
        <span class="n">instances_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">instancesTable</span><span class="p">)</span>
        <span class="n">hb</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">btn</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;New instance&quot;</span><span class="p">)</span>
        <span class="n">btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">newInstance</span><span class="p">())</span>
        <span class="n">hb</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">btn</span><span class="p">)</span>
        <span class="n">btn</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Delete instance&quot;</span><span class="p">)</span>
        <span class="n">btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deleteSelectedInstance</span><span class="p">)</span>
        <span class="n">hb</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">btn</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buttons</span><span class="p">[</span><span class="s2">&quot;delete instance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">btn</span>
        <span class="n">hbw</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
        <span class="n">hbw</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">hb</span><span class="p">)</span>
        <span class="n">instances_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">hbw</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">update_instance_table_selection</span><span class="p">():</span>
            <span class="n">inst_selected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">getSelectionInstance</span><span class="p">()</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">inst_selected</span><span class="p">:</span>
                <span class="k">return</span>

            <span class="n">idx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">if</span> <span class="n">inst_selected</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labeled_frame</span><span class="o">.</span><span class="n">instances_to_show</span><span class="p">:</span>
                <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labeled_frame</span><span class="o">.</span><span class="n">instances_to_show</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">inst_selected</span><span class="p">)</span>

            <span class="n">table_row_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">instancesTable</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">createIndex</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">instancesTable</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">table_row_idx</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">instancesTable</span><span class="o">.</span><span class="n">selectionChangedSignal</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">inst</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">selectInstance</span><span class="p">(</span><span class="n">inst</span><span class="p">,</span> <span class="n">signal</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">updatedSelection</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">update_instance_table_selection</span><span class="p">)</span>

        <span class="c1"># update track UI when change to track name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">instancesTable</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">dataChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">updateTrackMenu</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">instancesTable</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">dataChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">changestack_push</span><span class="p">)</span>

        <span class="c1">####### Suggestions #######</span>
        <span class="n">suggestions_layout</span> <span class="o">=</span> <span class="n">_make_dock</span><span class="p">(</span><span class="s2">&quot;Labeling Suggestions&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">suggestionsTable</span> <span class="o">=</span> <span class="n">SuggestionsTable</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">)</span>
        <span class="n">suggestions_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">suggestionsTable</span><span class="p">)</span>

        <span class="n">hb</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">btn</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Prev&quot;</span><span class="p">)</span>
        <span class="n">btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">nextSuggestedFrame</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">hb</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">btn</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">suggested_count_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">()</span>
        <span class="n">hb</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">suggested_count_label</span><span class="p">)</span>
        <span class="n">btn</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Next&quot;</span><span class="p">)</span>
        <span class="n">btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">nextSuggestedFrame</span><span class="p">())</span>
        <span class="n">hb</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">btn</span><span class="p">)</span>
        <span class="n">hbw</span> <span class="o">=</span> <span class="n">QWidget</span><span class="p">()</span>
        <span class="n">hbw</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">hb</span><span class="p">)</span>
        <span class="n">suggestions_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">hbw</span><span class="p">)</span>

        <span class="n">suggestions_yaml</span> <span class="o">=</span> <span class="n">resource_filename</span><span class="p">(</span>
            <span class="n">Requirement</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;sleap&quot;</span><span class="p">),</span> <span class="s2">&quot;sleap/config/suggestions.yaml&quot;</span>
        <span class="p">)</span>
        <span class="n">form_wid</span> <span class="o">=</span> <span class="n">YamlFormWidget</span><span class="p">(</span>
            <span class="n">yaml_file</span><span class="o">=</span><span class="n">suggestions_yaml</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Generate Suggestions&quot;</span>
        <span class="p">)</span>
        <span class="n">form_wid</span><span class="o">.</span><span class="n">mainAction</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generateSuggestions</span><span class="p">)</span>
        <span class="n">suggestions_layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">form_wid</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">suggestionsTable</span><span class="o">.</span><span class="n">doubleClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">table_idx</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">gotoVideoAndFrame</span><span class="p">(</span>
                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">get_suggestions</span><span class="p">()[</span><span class="n">table_idx</span><span class="o">.</span><span class="n">row</span><span class="p">()]</span>
            <span class="p">)</span>
        <span class="p">)</span>

<div class="viewcode-block" id="MainWindow.load_overlays"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.load_overlays">[docs]</a>    <span class="k">def</span> <span class="nf">load_overlays</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load all standard video overlays.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">overlays</span><span class="p">[</span><span class="s2">&quot;track_labels&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">TrackListOverlay</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">overlays</span><span class="p">[</span><span class="s2">&quot;negative&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NegativeAnchorOverlay</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">overlays</span><span class="p">[</span><span class="s2">&quot;trails&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">TrackTrailOverlay</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">overlays</span><span class="p">[</span><span class="s2">&quot;instance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">InstanceOverlay</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_update_gui_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Enable/disable gui items based on current state.&quot;&quot;&quot;</span>
        <span class="n">has_selected_instance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="n">has_unsaved_changes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">changestack_has_changes</span><span class="p">()</span>
        <span class="n">has_multiple_videos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">videos</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span>
        <span class="n">has_labeled_frames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span>
            <span class="p">(</span><span class="n">lf</span><span class="o">.</span><span class="n">video</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">video</span> <span class="k">for</span> <span class="n">lf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">has_suggestions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">suggestions</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">has_tracks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">tracks</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">has_multiple_instances</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">labeled_frame</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labeled_frame</span><span class="o">.</span><span class="n">instances</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span>
        <span class="p">)</span>
        <span class="c1"># todo: exclude predicted instances from count</span>
        <span class="n">has_nodes_selected</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skeletonEdgesSrc</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">skeletonEdgesDst</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span>
        <span class="p">)</span>
        <span class="n">control_key_down</span> <span class="o">=</span> <span class="n">QApplication</span><span class="o">.</span><span class="n">queryKeyboardModifiers</span><span class="p">()</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">.</span><span class="n">ControlModifier</span>

        <span class="c1"># Update menus</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">track_menu</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">has_selected_instance</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_menu_actions</span><span class="p">[</span><span class="s2">&quot;clear selection&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">has_selected_instance</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_menu_actions</span><span class="p">[</span><span class="s2">&quot;delete instance&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">has_selected_instance</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_menu_actions</span><span class="p">[</span><span class="s2">&quot;transpose&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">has_multiple_instances</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_menu_actions</span><span class="p">[</span><span class="s2">&quot;save&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">has_unsaved_changes</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_menu_actions</span><span class="p">[</span><span class="s2">&quot;next video&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">has_multiple_videos</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_menu_actions</span><span class="p">[</span><span class="s2">&quot;prev video&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">has_multiple_videos</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_menu_actions</span><span class="p">[</span><span class="s2">&quot;goto next labeled&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">has_labeled_frames</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_menu_actions</span><span class="p">[</span><span class="s2">&quot;goto prev labeled&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">has_labeled_frames</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_menu_actions</span><span class="p">[</span><span class="s2">&quot;goto next suggestion&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">has_suggestions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_menu_actions</span><span class="p">[</span><span class="s2">&quot;goto prev suggestion&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">has_suggestions</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_menu_actions</span><span class="p">[</span><span class="s2">&quot;goto next track spawn&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">has_tracks</span><span class="p">)</span>

        <span class="c1"># Update buttons</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buttons</span><span class="p">[</span><span class="s2">&quot;add edge&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">has_nodes_selected</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buttons</span><span class="p">[</span><span class="s2">&quot;delete edge&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skeletonEdgesTable</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span><span class="o">.</span><span class="n">isValid</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buttons</span><span class="p">[</span><span class="s2">&quot;delete node&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skeletonNodesTable</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span><span class="o">.</span><span class="n">isValid</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buttons</span><span class="p">[</span><span class="s2">&quot;show video&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">videosTable</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span><span class="o">.</span><span class="n">isValid</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buttons</span><span class="p">[</span><span class="s2">&quot;remove video&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">videosTable</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span><span class="o">.</span><span class="n">isValid</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buttons</span><span class="p">[</span><span class="s2">&quot;delete instance&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">instancesTable</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span><span class="o">.</span><span class="n">isValid</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="c1"># Update overlays</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">overlays</span><span class="p">[</span><span class="s2">&quot;track_labels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">control_key_down</span> <span class="ow">and</span> <span class="n">has_selected_instance</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_update_data_views</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">update</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Update data used by data view table models.</span>

<span class="sd">        Args:</span>
<span class="sd">            Accepts names of what data to update as unnamed string arguments:</span>
<span class="sd">                &quot;video&quot;, &quot;skeleton&quot;, &quot;labels&quot;, &quot;frame&quot;, &quot;suggestions&quot;</span>
<span class="sd">            If no arguments are given, then everything is updated.</span>
<span class="sd">        Returns:</span>
<span class="sd">             None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">update</span> <span class="o">=</span> <span class="n">update</span> <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;video&quot;</span><span class="p">,</span> <span class="s2">&quot;skeleton&quot;</span><span class="p">,</span> <span class="s2">&quot;labels&quot;</span><span class="p">,</span> <span class="s2">&quot;frame&quot;</span><span class="p">,</span> <span class="s2">&quot;suggestions&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">skeletons</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">skeletons</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="s2">&quot;video&quot;</span> <span class="ow">in</span> <span class="n">update</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">videosTable</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">videos</span>

        <span class="k">if</span> <span class="s2">&quot;skeleton&quot;</span> <span class="ow">in</span> <span class="n">update</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skeletonNodesTable</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">skeleton</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skeletonEdgesTable</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">skeleton</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skeletonEdgesSrc</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">skeleton</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skeletonEdgesDst</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">skeleton</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span>

        <span class="k">if</span> <span class="s2">&quot;labels&quot;</span> <span class="ow">in</span> <span class="n">update</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">instancesTable</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">instancesTable</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">color_manager</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_color_manager</span>

        <span class="k">if</span> <span class="s2">&quot;frame&quot;</span> <span class="ow">in</span> <span class="n">update</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">instancesTable</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">labeled_frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labeled_frame</span>

        <span class="k">if</span> <span class="s2">&quot;suggestions&quot;</span> <span class="ow">in</span> <span class="n">update</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">suggestionsTable</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span>

            <span class="c1"># update count of suggested frames w/ labeled instances</span>
            <span class="n">suggestion_status_text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">suggestion_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">get_suggestions</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">suggestion_list</span><span class="p">):</span>
                <span class="n">suggestion_label_counts</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">instance_count</span><span class="p">(</span><span class="n">video</span><span class="p">,</span> <span class="n">frame_idx</span><span class="p">)</span>
                    <span class="k">for</span> <span class="p">(</span><span class="n">video</span><span class="p">,</span> <span class="n">frame_idx</span><span class="p">)</span> <span class="ow">in</span> <span class="n">suggestion_list</span>
                <span class="p">]</span>
                <span class="n">labeled_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">suggestion_list</span><span class="p">)</span> <span class="o">-</span> <span class="n">suggestion_label_counts</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">suggestion_status_text</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">f</span><span class="s2">&quot;</span><span class="si">{labeled_count}</span><span class="s2">/{len(suggestion_list)} labeled&quot;</span>
                <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">suggested_count_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">suggestion_status_text</span><span class="p">)</span>

<div class="viewcode-block" id="MainWindow.plotFrame"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.plotFrame">[docs]</a>    <span class="k">def</span> <span class="nf">plotFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plots (or replots) current frame.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">video</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">showLabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_show_labels</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">showEdges</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_show_edges</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_auto_zoom</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">zoomToFit</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">_after_plot_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">player</span><span class="p">,</span> <span class="n">frame_idx</span><span class="p">,</span> <span class="n">selected_inst</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Called each time a new frame is drawn.&quot;&quot;&quot;</span>

        <span class="c1"># Store the current LabeledFrame (or make new, empty object)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labeled_frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">,</span> <span class="n">frame_idx</span><span class="p">,</span> <span class="n">return_new</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Show instances, etc, for this frame</span>
        <span class="k">for</span> <span class="n">overlay</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">overlays</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">overlay</span><span class="o">.</span><span class="n">add_to_scene</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">,</span> <span class="n">frame_idx</span><span class="p">)</span>

        <span class="c1"># Select instance if there was already selection</span>
        <span class="k">if</span> <span class="n">selected_inst</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">player</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">selectInstance</span><span class="p">(</span><span class="n">selected_inst</span><span class="p">)</span>

        <span class="c1"># Update related displays</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateStatusMessage</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_data_views</span><span class="p">(</span><span class="s2">&quot;frame&quot;</span><span class="p">)</span>

        <span class="c1"># Trigger event after the overlays have been added</span>
        <span class="n">player</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">updatedViewer</span><span class="o">.</span><span class="n">emit</span><span class="p">()</span>

<div class="viewcode-block" id="MainWindow.updateStatusMessage"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.updateStatusMessage">[docs]</a>    <span class="k">def</span> <span class="nf">updateStatusMessage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Updates status bar.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">message</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;Frame: {self.player.frame_idx+1}/{len(self.video)}&quot;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">seekbar</span><span class="o">.</span><span class="n">hasSelection</span><span class="p">():</span>
                <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">seekbar</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>
                <span class="n">message</span> <span class="o">+=</span> <span class="n">f</span><span class="s2">&quot; (selection: </span><span class="si">{start}</span><span class="s2">-</span><span class="si">{end}</span><span class="s2">)&quot;</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">videos</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">message</span> <span class="o">+=</span> <span class="n">f</span><span class="s2">&quot; of video {self.labels.videos.index(self.video)}&quot;</span>

            <span class="n">message</span> <span class="o">+=</span> <span class="n">f</span><span class="s2">&quot;    Labeled Frames: &quot;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">video</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">message</span> <span class="o">+=</span> <span class="p">(</span>
                    <span class="n">f</span><span class="s2">&quot;{len(self.labels.get_video_user_labeled_frames(self.video))}&quot;</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">videos</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">message</span> <span class="o">+=</span> <span class="s2">&quot; in video, &quot;</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">videos</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">message</span> <span class="o">+=</span> <span class="n">f</span><span class="s2">&quot;{len(self.labels.user_labeled_frames)} in project&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">showMessage</span><span class="p">(</span><span class="n">message</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.loadProject"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.loadProject">[docs]</a>    <span class="k">def</span> <span class="nf">loadProject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads given labels file into GUI.</span>

<span class="sd">        Args:</span>
<span class="sd">            filename: The path to the saved labels dataset. If None,</span>
<span class="sd">                then don&#39;t do anything.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">show_msg</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">gui_video_callback</span> <span class="o">=</span> <span class="n">Labels</span><span class="o">.</span><span class="n">make_gui_video_callback</span><span class="p">(</span>
            <span class="n">search_paths</span><span class="o">=</span><span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">filename</span><span class="p">)]</span>
        <span class="p">)</span>

        <span class="n">has_loaded</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">==</span> <span class="n">Labels</span><span class="p">:</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="n">filename</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">has_loaded</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">labels</span> <span class="o">=</span> <span class="n">Labels</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">video_callback</span><span class="o">=</span><span class="n">gui_video_callback</span><span class="p">)</span>
                <span class="n">has_loaded</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                <span class="n">QMessageBox</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">f</span><span class="s2">&quot;Unable to load </span><span class="si">{filename}</span><span class="s2">.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>

        <span class="k">if</span> <span class="n">has_loaded</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">changestack_clear</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_color_manager</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_color_manager</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_color_palette</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">load_overlays</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">setTrailLength</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">overlays</span><span class="p">[</span><span class="s2">&quot;trails&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">trail_length</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">show_msg</span><span class="p">:</span>
                <span class="n">msgBox</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">(</span>
                    <span class="n">text</span><span class="o">=</span><span class="n">f</span><span class="s2">&quot;Imported {len(self.labels)} labeled frames.&quot;</span>
                <span class="p">)</span>
                <span class="n">msgBox</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">skeletons</span><span class="p">):</span>
                <span class="c1"># TODO: add support for multiple skeletons</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">skeletons</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="c1"># Update UI tables</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_data_views</span><span class="p">()</span>

            <span class="c1"># Load first video</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">videos</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loadVideo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">videos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>

            <span class="c1"># Update track menu options</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">updateTrackMenu</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.updateTrackMenu"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.updateTrackMenu">[docs]</a>    <span class="k">def</span> <span class="nf">updateTrackMenu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Updates track menu options.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">track_menu</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">tracks</span><span class="p">:</span>
            <span class="n">key_command</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">tracks</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">track</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="p">:</span>
                <span class="n">key_command</span> <span class="o">=</span> <span class="n">Qt</span><span class="o">.</span><span class="n">CTRL</span> <span class="o">+</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Key_0</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">tracks</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">track</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">track_menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span>
                <span class="n">f</span><span class="s2">&quot;</span><span class="si">{track.name}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="o">=</span><span class="n">track</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">setInstanceTrack</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">key_command</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">track_menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="s2">&quot;New Track&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">addTrack</span><span class="p">,</span> <span class="n">Qt</span><span class="o">.</span><span class="n">CTRL</span> <span class="o">+</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Key_0</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.activateSelectedVideo"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.activateSelectedVideo">[docs]</a>    <span class="k">def</span> <span class="nf">activateSelectedVideo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Activates video selected in table.&quot;&quot;&quot;</span>
        <span class="c1"># Get selected video</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">videosTable</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">idx</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loadVideo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">videos</span><span class="p">[</span><span class="n">idx</span><span class="o">.</span><span class="n">row</span><span class="p">()],</span> <span class="n">idx</span><span class="o">.</span><span class="n">row</span><span class="p">())</span></div>

<div class="viewcode-block" id="MainWindow.addVideo"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.addVideo">[docs]</a>    <span class="k">def</span> <span class="nf">addVideo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Shows gui for adding video to project.</span>

<span class="sd">        Args:</span>
<span class="sd">            filename: If given, then we just load this video. If not given,</span>
<span class="sd">                then we show dialog for importing videos.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Browse for file</span>
        <span class="n">video</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">video</span> <span class="o">=</span> <span class="n">Video</span><span class="o">.</span><span class="n">from_filename</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
            <span class="c1"># Add to labels</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">add_video</span><span class="p">(</span><span class="n">video</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">import_list</span> <span class="o">=</span> <span class="n">ImportVideos</span><span class="p">()</span><span class="o">.</span><span class="n">go</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">import_item</span> <span class="ow">in</span> <span class="n">import_list</span><span class="p">:</span>
                <span class="c1"># Create Video object</span>
                <span class="n">video</span> <span class="o">=</span> <span class="n">Video</span><span class="o">.</span><span class="n">from_filename</span><span class="p">(</span><span class="o">**</span><span class="n">import_item</span><span class="p">[</span><span class="s2">&quot;params&quot;</span><span class="p">])</span>
                <span class="c1"># Add to labels</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">add_video</span><span class="p">(</span><span class="n">video</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">changestack_push</span><span class="p">(</span><span class="s2">&quot;add video&quot;</span><span class="p">)</span>

        <span class="c1"># Load if no video currently loaded</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">video</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loadVideo</span><span class="p">(</span><span class="n">video</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">videos</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Update data model/view</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_data_views</span><span class="p">(</span><span class="s2">&quot;video&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.removeVideo"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.removeVideo">[docs]</a>    <span class="k">def</span> <span class="nf">removeVideo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Removes video (selected in table) from project.&quot;&quot;&quot;</span>
        <span class="c1"># Get selected video</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">videosTable</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">idx</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="n">video</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">videos</span><span class="p">[</span><span class="n">idx</span><span class="o">.</span><span class="n">row</span><span class="p">()]</span>

        <span class="c1"># Count labeled frames for this video</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">video</span><span class="p">))</span>

        <span class="c1"># Warn if there are labels that will be deleted</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span>
                <span class="s2">&quot;Removing video with labels&quot;</span><span class="p">,</span>
                <span class="n">f</span><span class="s2">&quot;</span><span class="si">{n}</span><span class="s2"> labeled frames in this video will be deleted, &quot;</span>
                <span class="s2">&quot;are you sure you want to remove this video?&quot;</span><span class="p">,</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span><span class="p">,</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">No</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">response</span> <span class="o">==</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">No</span><span class="p">:</span>
                <span class="k">return</span>

        <span class="c1"># Remove video</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">remove_video</span><span class="p">(</span><span class="n">video</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">changestack_push</span><span class="p">(</span><span class="s2">&quot;remove video&quot;</span><span class="p">)</span>

        <span class="c1"># Update data model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_data_views</span><span class="p">()</span>

        <span class="c1"># Update view if this was the current video</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">video</span> <span class="o">==</span> <span class="n">video</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">videos</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
                <span class="c1"># TODO: update statusbar</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_idx</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">idx</span><span class="o">.</span><span class="n">row</span><span class="p">(),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">videos</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loadVideo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">videos</span><span class="p">[</span><span class="n">new_idx</span><span class="p">],</span> <span class="n">new_idx</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.loadVideo"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.loadVideo">[docs]</a>    <span class="k">def</span> <span class="nf">loadVideo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">video</span><span class="p">:</span> <span class="n">Video</span><span class="p">,</span> <span class="n">video_idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Activates video in gui.&quot;&quot;&quot;</span>

        <span class="c1"># Update current video instance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">video</span> <span class="o">=</span> <span class="n">video</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">video_idx</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">video_idx</span> <span class="k">if</span> <span class="n">video_idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">videos</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">video</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Load video in player widget</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">load_video</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">)</span>

        <span class="c1"># Annotate labeled frames on seekbar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateSeekbarMarks</span><span class="p">()</span>

        <span class="c1"># Jump to last labeled frame</span>
        <span class="n">last_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">find_last</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">last_label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotFrame</span><span class="p">(</span><span class="n">last_label</span><span class="o">.</span><span class="n">frame_idx</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.openSkeleton"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.openSkeleton">[docs]</a>    <span class="k">def</span> <span class="nf">openSkeleton</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Shows gui for loading saved skeleton into project.&quot;&quot;&quot;</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;JSON skeleton (*.json)&quot;</span><span class="p">,</span> <span class="s2">&quot;HDF5 skeleton (*.h5 *.hdf5)&quot;</span><span class="p">]</span>
        <span class="n">filename</span><span class="p">,</span> <span class="n">selected_filter</span> <span class="o">=</span> <span class="n">FileDialog</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">caption</span><span class="o">=</span><span class="s2">&quot;Open skeleton...&quot;</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="s2">&quot;;;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filters</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.json&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span> <span class="o">=</span> <span class="n">Skeleton</span><span class="o">.</span><span class="n">load_json</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s2">&quot;.h5&quot;</span><span class="p">,</span> <span class="s2">&quot;.hdf5&quot;</span><span class="p">)):</span>
            <span class="n">sk_list</span> <span class="o">=</span> <span class="n">Skeleton</span><span class="o">.</span><span class="n">load_all_hdf5</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sk_list</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span> <span class="o">=</span> <span class="n">sk_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">skeletons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">changestack_push</span><span class="p">(</span><span class="s2">&quot;new skeleton&quot;</span><span class="p">)</span>

        <span class="c1"># Update data model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_data_views</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.saveSkeleton"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.saveSkeleton">[docs]</a>    <span class="k">def</span> <span class="nf">saveSkeleton</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Shows gui for saving skeleton from project.&quot;&quot;&quot;</span>
        <span class="n">default_name</span> <span class="o">=</span> <span class="s2">&quot;skeleton.json&quot;</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;JSON skeleton (*.json)&quot;</span><span class="p">,</span> <span class="s2">&quot;HDF5 skeleton (*.h5 *.hdf5)&quot;</span><span class="p">]</span>
        <span class="n">filename</span><span class="p">,</span> <span class="n">selected_filter</span> <span class="o">=</span> <span class="n">FileDialog</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">caption</span><span class="o">=</span><span class="s2">&quot;Save As...&quot;</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="n">default_name</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="s2">&quot;;;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filters</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.json&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span><span class="o">.</span><span class="n">save_json</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">((</span><span class="s2">&quot;.h5&quot;</span><span class="p">,</span> <span class="s2">&quot;.hdf5&quot;</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span><span class="o">.</span><span class="n">save_hdf5</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.newNode"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.newNode">[docs]</a>    <span class="k">def</span> <span class="nf">newNode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds new node to skeleton.&quot;&quot;&quot;</span>
        <span class="c1"># Find new part name</span>
        <span class="n">part_name</span> <span class="o">=</span> <span class="s2">&quot;new_part&quot;</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="n">part_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span><span class="p">:</span>
            <span class="n">part_name</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;new_part_</span><span class="si">{i}</span><span class="s2">&quot;</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># Add the node to the skeleton</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">part_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">changestack_push</span><span class="p">(</span><span class="s2">&quot;new node&quot;</span><span class="p">)</span>

        <span class="c1"># Update data model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_data_views</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plotFrame</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.deleteNode"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.deleteNode">[docs]</a>    <span class="k">def</span> <span class="nf">deleteNode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Removes (currently selected) node from skeleton.&quot;&quot;&quot;</span>
        <span class="c1"># Get selected node</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skeletonNodesTable</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">idx</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">idx</span><span class="o">.</span><span class="n">row</span><span class="p">()]</span>

        <span class="c1"># Remove</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span><span class="o">.</span><span class="n">delete_node</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">changestack_push</span><span class="p">(</span><span class="s2">&quot;delete node&quot;</span><span class="p">)</span>

        <span class="c1"># Update data model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_data_views</span><span class="p">()</span>

        <span class="c1"># Replot instances</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotFrame</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.updateEdges"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.updateEdges">[docs]</a>    <span class="k">def</span> <span class="nf">updateEdges</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Called when edges in skeleton have been changed.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_data_views</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotFrame</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.newEdge"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.newEdge">[docs]</a>    <span class="k">def</span> <span class="nf">newEdge</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Adds new edge to skeleton.&quot;&quot;&quot;</span>
        <span class="c1"># TODO: Move this to unified data model</span>

        <span class="c1"># Get selected nodes</span>
        <span class="n">src_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skeletonEdgesSrc</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="n">dst_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skeletonEdgesDst</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>

        <span class="c1"># Check if they&#39;re in the graph</span>
        <span class="k">if</span> <span class="n">src_node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span> <span class="ow">or</span> <span class="n">dst_node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># Add edge</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">src_node</span><span class="p">,</span> <span class="n">destination</span><span class="o">=</span><span class="n">dst_node</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">changestack_push</span><span class="p">(</span><span class="s2">&quot;new edge&quot;</span><span class="p">)</span>

        <span class="c1"># Update data model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_data_views</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plotFrame</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.deleteEdge"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.deleteEdge">[docs]</a>    <span class="k">def</span> <span class="nf">deleteEdge</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Removes (currently selected) edge from skeleton.&quot;&quot;&quot;</span>
        <span class="c1"># TODO: Move this to unified data model</span>

        <span class="c1"># Get selected edge</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skeletonEdgesTable</span><span class="o">.</span><span class="n">currentIndex</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">idx</span><span class="o">.</span><span class="n">isValid</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="n">edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">idx</span><span class="o">.</span><span class="n">row</span><span class="p">()]</span>

        <span class="c1"># Delete edge</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span><span class="o">.</span><span class="n">delete_edge</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">destination</span><span class="o">=</span><span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">changestack_push</span><span class="p">(</span><span class="s2">&quot;delete edge&quot;</span><span class="p">)</span>

        <span class="c1"># Update data model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_data_views</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plotFrame</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.updateSeekbarMarks"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.updateSeekbarMarks">[docs]</a>    <span class="k">def</span> <span class="nf">updateSeekbarMarks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Updates marks on seekbar.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">seekbar</span><span class="o">.</span><span class="n">setTracksFromLabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.setSeekbarHeader"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.setSeekbarHeader">[docs]</a>    <span class="k">def</span> <span class="nf">setSeekbarHeader</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">graph_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Updates graph shown in seekbar header.&quot;&quot;&quot;</span>
        <span class="n">data_obj</span> <span class="o">=</span> <span class="n">StatisticSeries</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">)</span>
        <span class="n">header_functions</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;Point Displacement (sum)&quot;</span><span class="p">:</span> <span class="n">data_obj</span><span class="o">.</span><span class="n">get_point_displacement_series</span><span class="p">,</span>
            <span class="s2">&quot;Point Displacement (max)&quot;</span><span class="p">:</span> <span class="n">data_obj</span><span class="o">.</span><span class="n">get_point_displacement_series</span><span class="p">,</span>
            <span class="s2">&quot;Instance Score (sum)&quot;</span><span class="p">:</span> <span class="n">data_obj</span><span class="o">.</span><span class="n">get_instance_score_series</span><span class="p">,</span>
            <span class="s2">&quot;Instance Score (min)&quot;</span><span class="p">:</span> <span class="n">data_obj</span><span class="o">.</span><span class="n">get_instance_score_series</span><span class="p">,</span>
            <span class="s2">&quot;Point Score (sum)&quot;</span><span class="p">:</span> <span class="n">data_obj</span><span class="o">.</span><span class="n">get_point_score_series</span><span class="p">,</span>
            <span class="s2">&quot;Point Score (min)&quot;</span><span class="p">:</span> <span class="n">data_obj</span><span class="o">.</span><span class="n">get_point_score_series</span><span class="p">,</span>
            <span class="s2">&quot;Number of predicted points&quot;</span><span class="p">:</span> <span class="n">data_obj</span><span class="o">.</span><span class="n">get_point_count_series</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_menu_check_single</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seekbarHeaderMenu</span><span class="p">,</span> <span class="n">graph_name</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">graph_name</span> <span class="o">==</span> <span class="s2">&quot;None&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">seekbar</span><span class="o">.</span><span class="n">clearHeader</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">graph_name</span> <span class="ow">in</span> <span class="n">header_functions</span><span class="p">:</span>
                <span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">video</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">)</span>
                <span class="n">reduction_name</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;\((sum|max|min)\)&quot;</span><span class="p">,</span> <span class="n">graph_name</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">reduction_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;reduction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">reduction_name</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">series</span> <span class="o">=</span> <span class="n">header_functions</span><span class="p">[</span><span class="n">graph_name</span><span class="p">](</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">seekbar</span><span class="o">.</span><span class="n">setHeaderSeries</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Could not find function for </span><span class="si">{header_functions}</span><span class="s2">&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.generateSuggestions"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.generateSuggestions">[docs]</a>    <span class="k">def</span> <span class="nf">generateSuggestions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generates suggestions using given params dictionary.&quot;&quot;&quot;</span>
        <span class="n">new_suggestions</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">video</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">videos</span><span class="p">:</span>
            <span class="n">new_suggestions</span><span class="p">[</span><span class="n">video</span><span class="p">]</span> <span class="o">=</span> <span class="n">VideoFrameSuggestions</span><span class="o">.</span><span class="n">suggest</span><span class="p">(</span>
                <span class="n">video</span><span class="o">=</span><span class="n">video</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">set_suggestions</span><span class="p">(</span><span class="n">new_suggestions</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_update_data_views</span><span class="p">(</span><span class="s2">&quot;suggestions&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateSeekbarMarks</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">_frames_for_prediction</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Builds options for frames on which to run inference.</span>

<span class="sd">        Args:</span>
<span class="sd">            None.</span>
<span class="sd">        Returns:</span>
<span class="sd">            Dictionary, keys are names of options (e.g., &quot;clip&quot;, &quot;random&quot;),</span>
<span class="sd">            values are {video: list of frame indices} dictionaries.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">remove_user_labeled</span><span class="p">(</span>
            <span class="n">video</span><span class="p">,</span> <span class="n">frames</span><span class="p">,</span> <span class="n">user_labeled_frames</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">user_labeled_frames</span>
        <span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">frames</span>
            <span class="n">video_user_labeled_frame_idxs</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">lf</span><span class="o">.</span><span class="n">frame_idx</span> <span class="k">for</span> <span class="n">lf</span> <span class="ow">in</span> <span class="n">user_labeled_frames</span> <span class="k">if</span> <span class="n">lf</span><span class="o">.</span><span class="n">video</span> <span class="o">==</span> <span class="n">video</span>
            <span class="p">]</span>
            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">video_user_labeled_frame_idxs</span><span class="p">))</span>

        <span class="n">selection</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">selection</span><span class="p">[</span><span class="s2">&quot;frame&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">:</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">frame_idx</span><span class="p">]}</span>
        <span class="n">selection</span><span class="p">[</span><span class="s2">&quot;clip&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">seekbar</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()))</span>
        <span class="p">}</span>
        <span class="n">selection</span><span class="p">[</span><span class="s2">&quot;video&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="o">.</span><span class="n">num_frames</span><span class="p">))}</span>

        <span class="n">selection</span><span class="p">[</span><span class="s2">&quot;suggestions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">video</span><span class="p">:</span> <span class="n">remove_user_labeled</span><span class="p">(</span><span class="n">video</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">get_video_suggestions</span><span class="p">(</span><span class="n">video</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">video</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">videos</span>
        <span class="p">}</span>

        <span class="n">selection</span><span class="p">[</span><span class="s2">&quot;random&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">video</span><span class="p">:</span> <span class="n">remove_user_labeled</span><span class="p">(</span><span class="n">video</span><span class="p">,</span> <span class="n">VideoFrameSuggestions</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">video</span><span class="o">=</span><span class="n">video</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">video</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">videos</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">selection</span>

<div class="viewcode-block" id="MainWindow.showLearningDialog"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.showLearningDialog">[docs]</a>    <span class="k">def</span> <span class="nf">showLearningDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Helper function to show active learning dialog in given mode.</span>

<span class="sd">        Args:</span>
<span class="sd">            mode: A string representing mode for dialog, which could be:</span>
<span class="sd">            * &quot;active&quot;</span>
<span class="sd">            * &quot;inference&quot;</span>
<span class="sd">            * &quot;expert&quot;</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">sleap.gui.active</span> <span class="k">import</span> <span class="n">ActiveLearningDialog</span>

        <span class="k">if</span> <span class="s2">&quot;inference&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">overlays</span><span class="p">:</span>
            <span class="n">QMessageBox</span><span class="p">(</span>
                <span class="n">text</span><span class="o">=</span><span class="s2">&quot;In order to use this function you must first quit and &quot;</span>
                <span class="s2">&quot;re-open SLEAP to release resources used by visualizing &quot;</span>
                <span class="s2">&quot;model outputs.&quot;</span>
            <span class="p">)</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_child_windows</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_child_windows</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span> <span class="o">=</span> <span class="n">ActiveLearningDialog</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="n">mode</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_child_windows</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span><span class="o">.</span><span class="n">learningFinished</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">learningFinished</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_child_windows</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span><span class="o">.</span><span class="n">frame_selection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frames_for_prediction</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_child_windows</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span><span class="o">.</span><span class="n">open</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.learningFinished"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.learningFinished">[docs]</a>    <span class="k">def</span> <span class="nf">learningFinished</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Called when active learning (or inference) finishes.&quot;&quot;&quot;</span>
        <span class="c1"># we ran active learning so update display/ui</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotFrame</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateSeekbarMarks</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_data_views</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">changestack_push</span><span class="p">(</span><span class="s2">&quot;new predictions&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.visualizeOutputs"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.visualizeOutputs">[docs]</a>    <span class="k">def</span> <span class="nf">visualizeOutputs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gui for adding overlay with live visualization of predictions.&quot;&quot;&quot;</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Model (*.json)&quot;</span><span class="p">,</span> <span class="s2">&quot;HDF5 output (*.h5 *.hdf5)&quot;</span><span class="p">]</span>

        <span class="c1"># Default to opening from models directory from project</span>
        <span class="n">models_dir</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">models_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">),</span> <span class="s2">&quot;models/&quot;</span><span class="p">)</span>

        <span class="c1"># Show dialog</span>
        <span class="n">filename</span><span class="p">,</span> <span class="n">selected_filter</span> <span class="o">=</span> <span class="n">FileDialog</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="nb">dir</span><span class="o">=</span><span class="n">models_dir</span><span class="p">,</span>
            <span class="n">caption</span><span class="o">=</span><span class="s2">&quot;Import model outputs...&quot;</span><span class="p">,</span>
            <span class="nb">filter</span><span class="o">=</span><span class="s2">&quot;;;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filters</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">selected_filter</span> <span class="o">==</span> <span class="n">filters</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="c1"># Model as overlay datasource</span>
            <span class="c1"># This will show live inference results</span>

            <span class="kn">from</span> <span class="nn">sleap.gui.overlays.base</span> <span class="k">import</span> <span class="n">DataOverlay</span>

            <span class="n">overlay</span> <span class="o">=</span> <span class="n">DataOverlay</span><span class="o">.</span><span class="n">from_model</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">,</span> <span class="n">player</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">overlays</span><span class="p">[</span><span class="s2">&quot;inference&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">overlay</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># HDF5 as overlay datasource</span>
            <span class="c1"># This will show saved inference results from previous run</span>

            <span class="n">show_confmaps</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">show_pafs</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">if</span> <span class="n">show_confmaps</span><span class="p">:</span>
                <span class="kn">from</span> <span class="nn">sleap.gui.overlays.confmaps</span> <span class="k">import</span> <span class="n">ConfmapOverlay</span>

                <span class="n">confmap_overlay</span> <span class="o">=</span> <span class="n">ConfmapOverlay</span><span class="o">.</span><span class="n">from_h5</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">player</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">changedPlot</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">parent</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="n">confmap_overlay</span><span class="o">.</span><span class="n">add_to_scene</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="n">show_pafs</span><span class="p">:</span>
                <span class="kn">from</span> <span class="nn">sleap.gui.overlays.pafs</span> <span class="k">import</span> <span class="n">PafOverlay</span>

                <span class="n">paf_overlay</span> <span class="o">=</span> <span class="n">PafOverlay</span><span class="o">.</span><span class="n">from_h5</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">player</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">changedPlot</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
                    <span class="k">lambda</span> <span class="n">parent</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="n">paf_overlay</span><span class="o">.</span><span class="n">add_to_scene</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">idx</span><span class="p">)</span>
                <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plotFrame</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.deletePredictions"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.deletePredictions">[docs]</a>    <span class="k">def</span> <span class="nf">deletePredictions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deletes all predicted instances in project.&quot;&quot;&quot;</span>

        <span class="n">predicted_instances</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">lf</span><span class="p">,</span> <span class="n">inst</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">lf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span>
            <span class="k">for</span> <span class="n">inst</span> <span class="ow">in</span> <span class="n">lf</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">inst</span><span class="p">)</span> <span class="o">==</span> <span class="n">PredictedInstance</span>
        <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_delete_confirm</span><span class="p">(</span><span class="n">predicted_instances</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.deleteClipPredictions"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.deleteClipPredictions">[docs]</a>    <span class="k">def</span> <span class="nf">deleteClipPredictions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deletes all instances within selected range of video frames.&quot;&quot;&quot;</span>

        <span class="n">predicted_instances</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">lf</span><span class="p">,</span> <span class="n">inst</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">lf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">find</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">,</span> <span class="n">frame_idx</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">seekbar</span><span class="o">.</span><span class="n">getSelection</span><span class="p">())</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">inst</span> <span class="ow">in</span> <span class="n">lf</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">inst</span><span class="p">)</span> <span class="o">==</span> <span class="n">PredictedInstance</span>
        <span class="p">]</span>

        <span class="c1"># If user selected an instance, then only delete for that track.</span>
        <span class="n">selected_inst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">getSelectionInstance</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">selected_inst</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">track</span> <span class="o">=</span> <span class="n">selected_inst</span><span class="o">.</span><span class="n">track</span>
            <span class="k">if</span> <span class="n">track</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># If user selected an instance without a track, delete only</span>
                <span class="c1"># that instance and only on the current frame.</span>
                <span class="n">predicted_instances</span> <span class="o">=</span> <span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">labeled_frame</span><span class="p">,</span> <span class="n">selected_inst</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Filter by track</span>
                <span class="n">predicted_instances</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span>
                    <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">track</span> <span class="o">==</span> <span class="n">track</span><span class="p">,</span> <span class="n">predicted_instances</span><span class="p">)</span>
                <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_delete_confirm</span><span class="p">(</span><span class="n">predicted_instances</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.deleteAreaPredictions"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.deleteAreaPredictions">[docs]</a>    <span class="k">def</span> <span class="nf">deleteAreaPredictions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gui for deleting instances within some rect on frame images.&quot;&quot;&quot;</span>

        <span class="c1"># Callback to delete after area has been selected</span>
        <span class="k">def</span> <span class="nf">delete_area_callback</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">):</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">updateStatusMessage</span><span class="p">()</span>

            <span class="c1"># Make sure there was an area selected</span>
            <span class="k">if</span> <span class="n">x0</span> <span class="o">==</span> <span class="n">x1</span> <span class="ow">or</span> <span class="n">y0</span> <span class="o">==</span> <span class="n">y1</span><span class="p">:</span>
                <span class="k">return</span>

            <span class="n">min_corner</span> <span class="o">=</span> <span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">)</span>
            <span class="n">max_corner</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>

            <span class="k">def</span> <span class="nf">is_bounded</span><span class="p">(</span><span class="n">inst</span><span class="p">):</span>
                <span class="n">points_array</span> <span class="o">=</span> <span class="n">inst</span><span class="o">.</span><span class="n">points_array</span>
                <span class="n">valid_points</span> <span class="o">=</span> <span class="n">points_array</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">points_array</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>

                <span class="n">is_gt_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">valid_points</span> <span class="o">&gt;=</span> <span class="n">min_corner</span><span class="p">)</span>
                <span class="n">is_lt_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">valid_points</span> <span class="o">&lt;=</span> <span class="n">max_corner</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">is_gt_min</span> <span class="ow">and</span> <span class="n">is_lt_max</span>

            <span class="c1"># Find all instances contained in selected area</span>
            <span class="n">predicted_instances</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">(</span><span class="n">lf</span><span class="p">,</span> <span class="n">inst</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">lf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">inst</span> <span class="ow">in</span> <span class="n">lf</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">inst</span><span class="p">)</span> <span class="o">==</span> <span class="n">PredictedInstance</span> <span class="ow">and</span> <span class="n">is_bounded</span><span class="p">(</span><span class="n">inst</span><span class="p">)</span>
            <span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_delete_confirm</span><span class="p">(</span><span class="n">predicted_instances</span><span class="p">)</span>

        <span class="c1"># Prompt the user to select area</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateStatusMessage</span><span class="p">(</span>
            <span class="n">f</span><span class="s2">&quot;Please select the area from which to remove instances. This will be applied to all frames.&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">onAreaSelection</span><span class="p">(</span><span class="n">delete_area_callback</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.deleteLowScorePredictions"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.deleteLowScorePredictions">[docs]</a>    <span class="k">def</span> <span class="nf">deleteLowScorePredictions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gui for deleting instances below some score threshold.&quot;&quot;&quot;</span>
        <span class="n">score_thresh</span><span class="p">,</span> <span class="n">okay</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QInputDialog</span><span class="o">.</span><span class="n">getDouble</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;Delete Instances with Low Score...&quot;</span><span class="p">,</span> <span class="s2">&quot;Score Below:&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">okay</span><span class="p">:</span>
            <span class="c1"># Find all instances contained in selected area</span>
            <span class="n">predicted_instances</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">(</span><span class="n">lf</span><span class="p">,</span> <span class="n">inst</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">lf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">inst</span> <span class="ow">in</span> <span class="n">lf</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">inst</span><span class="p">)</span> <span class="o">==</span> <span class="n">PredictedInstance</span> <span class="ow">and</span> <span class="n">inst</span><span class="o">.</span><span class="n">score</span> <span class="o">&lt;</span> <span class="n">score_thresh</span>
            <span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_delete_confirm</span><span class="p">(</span><span class="n">predicted_instances</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.deleteFrameLimitPredictions"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.deleteFrameLimitPredictions">[docs]</a>    <span class="k">def</span> <span class="nf">deleteFrameLimitPredictions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gui for deleting instances beyond some number in each frame.&quot;&quot;&quot;</span>
        <span class="n">count_thresh</span><span class="p">,</span> <span class="n">okay</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QInputDialog</span><span class="o">.</span><span class="n">getInt</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="s2">&quot;Limit Instances in Frame...&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Maximum instances in a frame:&quot;</span><span class="p">,</span>
            <span class="mi">3</span><span class="p">,</span>
            <span class="mi">1</span><span class="p">,</span>
            <span class="mi">100</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">okay</span><span class="p">:</span>
            <span class="n">predicted_instances</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="c1"># Find all instances contained in selected area</span>
            <span class="k">for</span> <span class="n">lf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lf</span><span class="o">.</span><span class="n">instances</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">count_thresh</span><span class="p">:</span>
                    <span class="c1"># Get all but the count_thresh many instances with the highest score</span>
                    <span class="n">extra_instances</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
                        <span class="n">lf</span><span class="o">.</span><span class="n">instances</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">operator</span><span class="o">.</span><span class="n">attrgetter</span><span class="p">(</span><span class="s2">&quot;score&quot;</span><span class="p">)</span>
                    <span class="p">)[:</span><span class="o">-</span><span class="n">count_thresh</span><span class="p">]</span>
                    <span class="n">predicted_instances</span><span class="o">.</span><span class="n">extend</span><span class="p">([(</span><span class="n">lf</span><span class="p">,</span> <span class="n">inst</span><span class="p">)</span> <span class="k">for</span> <span class="n">inst</span> <span class="ow">in</span> <span class="n">extra_instances</span><span class="p">])</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_delete_confirm</span><span class="p">(</span><span class="n">predicted_instances</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_delete_confirm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lf_inst_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Helper function to confirm before deleting instances.</span>

<span class="sd">        Args:</span>
<span class="sd">            lf_inst_list: A list of (labeled frame, instance) tuples.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Confirm that we want to delete</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">critical</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="s2">&quot;Removing predicted instances&quot;</span><span class="p">,</span>
            <span class="n">f</span><span class="s2">&quot;There are {len(lf_inst_list)} predicted instances that would be deleted. &quot;</span>
            <span class="s2">&quot;Are you sure you want to delete these?&quot;</span><span class="p">,</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Yes</span><span class="p">,</span>
            <span class="n">QMessageBox</span><span class="o">.</span><span class="n">No</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">resp</span> <span class="o">==</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">No</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># Delete the instances</span>
        <span class="k">for</span> <span class="n">lf</span><span class="p">,</span> <span class="n">inst</span> <span class="ow">in</span> <span class="n">lf_inst_list</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">remove_instance</span><span class="p">(</span><span class="n">lf</span><span class="p">,</span> <span class="n">inst</span><span class="p">)</span>

        <span class="c1"># Update visuals</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotFrame</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateSeekbarMarks</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">changestack_push</span><span class="p">(</span><span class="s2">&quot;removed predictions&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="MainWindow.markNegativeAnchor"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.markNegativeAnchor">[docs]</a>    <span class="k">def</span> <span class="nf">markNegativeAnchor</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Allows user to add negative training sample anchor.&quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">click_callback</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">updateStatusMessage</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">add_negative_anchor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">frame_idx</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">changestack_push</span><span class="p">(</span><span class="s2">&quot;add negative anchors&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotFrame</span><span class="p">()</span>

        <span class="c1"># Prompt the user to select area</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateStatusMessage</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Please click where you want a negative sample...&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">onPointSelection</span><span class="p">(</span><span class="n">click_callback</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.clearFrameNegativeAnchors"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.clearFrameNegativeAnchors">[docs]</a>    <span class="k">def</span> <span class="nf">clearFrameNegativeAnchors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Removes negative training sample anchors on current frame.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">remove_negative_anchors</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">frame_idx</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">changestack_push</span><span class="p">(</span><span class="s2">&quot;remove negative anchors&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotFrame</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.importPredictions"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.importPredictions">[docs]</a>    <span class="k">def</span> <span class="nf">importPredictions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Starts gui for importing another dataset into currently one.&quot;&quot;&quot;</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;HDF5 dataset (*.h5 *.hdf5)&quot;</span><span class="p">,</span> <span class="s2">&quot;JSON labels (*.json *.json.zip)&quot;</span><span class="p">]</span>
        <span class="n">filenames</span><span class="p">,</span> <span class="n">selected_filter</span> <span class="o">=</span> <span class="n">FileDialog</span><span class="o">.</span><span class="n">openMultiple</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">caption</span><span class="o">=</span><span class="s2">&quot;Import labeled data...&quot;</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="s2">&quot;;;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filters</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
            <span class="n">gui_video_callback</span> <span class="o">=</span> <span class="n">Labels</span><span class="o">.</span><span class="n">make_gui_video_callback</span><span class="p">(</span>
                <span class="n">search_paths</span><span class="o">=</span><span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">filename</span><span class="p">)]</span>
            <span class="p">)</span>

            <span class="n">new_labels</span> <span class="o">=</span> <span class="n">Labels</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">video_callback</span><span class="o">=</span><span class="n">gui_video_callback</span><span class="p">)</span>

            <span class="c1"># Merging data is handled by MergeDialog</span>
            <span class="n">MergeDialog</span><span class="p">(</span><span class="n">base_labels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="n">new_labels</span><span class="o">=</span><span class="n">new_labels</span><span class="p">)</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>

        <span class="c1"># update display/ui</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotFrame</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateSeekbarMarks</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_data_views</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">changestack_push</span><span class="p">(</span><span class="s2">&quot;new predictions&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.doubleClickInstance"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.doubleClickInstance">[docs]</a>    <span class="k">def</span> <span class="nf">doubleClickInstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">:</span> <span class="n">Instance</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handles when the user has double-clicked an instance.</span>

<span class="sd">        If prediction, then copy to new user-instance.</span>
<span class="sd">        If already user instance, then add any missing nodes (in case</span>
<span class="sd">        skeleton has been changed after instance was created).</span>

<span class="sd">        Args:</span>
<span class="sd">            instance: The :class:`Instance` that was double-clicked.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># When a predicted instance is double-clicked, add a new instance</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">newInstance</span><span class="p">(</span><span class="n">copy_instance</span><span class="o">=</span><span class="n">instance</span><span class="p">)</span>

        <span class="c1"># When a regular instance is double-clicked, add any missing points</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># the rect that&#39;s currently visibile in the window view</span>
            <span class="n">in_view_rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">mapToScene</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">rect</span><span class="p">()</span>
            <span class="p">)</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span>

            <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">node</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">instance</span><span class="o">.</span><span class="n">nodes</span> <span class="ow">or</span> <span class="n">instance</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">.</span><span class="n">isnan</span><span class="p">():</span>
                    <span class="c1"># pick random points within currently zoomed view</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="n">in_view_rect</span><span class="o">.</span><span class="n">x</span><span class="p">()</span>
                        <span class="o">+</span> <span class="p">(</span><span class="n">in_view_rect</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">)</span>
                        <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">*</span> <span class="n">in_view_rect</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
                    <span class="p">)</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="n">in_view_rect</span><span class="o">.</span><span class="n">y</span><span class="p">()</span>
                        <span class="o">+</span> <span class="p">(</span><span class="n">in_view_rect</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">)</span>
                        <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">*</span> <span class="n">in_view_rect</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
                    <span class="p">)</span>
                    <span class="c1"># set point for node</span>
                    <span class="n">instance</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">plotFrame</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.newInstance"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.newInstance">[docs]</a>    <span class="k">def</span> <span class="nf">newInstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">copy_instance</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Instance</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a new instance, copying node coordinates as appropriate.</span>

<span class="sd">        Args:</span>
<span class="sd">            copy_instance: The :class:`Instance` (or</span>
<span class="sd">                :class:`PredictedInstance`) which we want to copy.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">labeled_frame</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># FIXME: filter by skeleton type</span>

        <span class="n">from_predicted</span> <span class="o">=</span> <span class="n">copy_instance</span>
        <span class="n">from_prev_frame</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">copy_instance</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">selected_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">selected_idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># If the user has selected an instance, copy that one.</span>
                <span class="n">copy_instance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labeled_frame</span><span class="o">.</span><span class="n">instances</span><span class="p">[</span><span class="n">selected_idx</span><span class="p">]</span>
                <span class="n">from_predicted</span> <span class="o">=</span> <span class="n">copy_instance</span>

        <span class="k">if</span> <span class="n">copy_instance</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">unused_predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labeled_frame</span><span class="o">.</span><span class="n">unused_predictions</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unused_predictions</span><span class="p">):</span>
                <span class="c1"># If there are predicted instances that don&#39;t correspond to an instance</span>
                <span class="c1"># in this frame, use the first predicted instance without matching instance.</span>
                <span class="n">copy_instance</span> <span class="o">=</span> <span class="n">unused_predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">from_predicted</span> <span class="o">=</span> <span class="n">copy_instance</span>

        <span class="k">if</span> <span class="n">copy_instance</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Otherwise, if there are instances in previous frames,</span>
            <span class="c1"># copy the points from one of those instances.</span>
            <span class="n">prev_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">previousLabeledFrameIndex</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">prev_idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">prev_instances</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">find</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">,</span> <span class="n">prev_idx</span><span class="p">,</span> <span class="n">return_new</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">instances</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">prev_instances</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labeled_frame</span><span class="o">.</span><span class="n">instances</span><span class="p">):</span>
                    <span class="c1"># If more instances in previous frame than current, then use the</span>
                    <span class="c1"># first unmatched instance.</span>
                    <span class="n">copy_instance</span> <span class="o">=</span> <span class="n">prev_instances</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labeled_frame</span><span class="o">.</span><span class="n">instances</span><span class="p">)]</span>
                    <span class="n">from_prev_frame</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labeled_frame</span><span class="o">.</span><span class="n">instances</span><span class="p">):</span>
                    <span class="c1"># Otherwise, if there are already instances in current frame,</span>
                    <span class="c1"># copy the points from the last instance added to frame.</span>
                    <span class="n">copy_instance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labeled_frame</span><span class="o">.</span><span class="n">instances</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">prev_instances</span><span class="p">):</span>
                    <span class="c1"># Otherwise use the last instance added to previous frame.</span>
                    <span class="n">copy_instance</span> <span class="o">=</span> <span class="n">prev_instances</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">from_prev_frame</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">from_predicted</span> <span class="o">=</span> <span class="n">from_predicted</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">from_predicted</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="c1"># Now create the new instance</span>
        <span class="n">new_instance</span> <span class="o">=</span> <span class="n">Instance</span><span class="p">(</span><span class="n">skeleton</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span><span class="p">,</span> <span class="n">from_predicted</span><span class="o">=</span><span class="n">from_predicted</span><span class="p">)</span>

        <span class="c1"># Get the rect that&#39;s currently visibile in the window view</span>
        <span class="n">in_view_rect</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">mapToScene</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">rect</span><span class="p">()</span>
        <span class="p">)</span><span class="o">.</span><span class="n">boundingRect</span><span class="p">()</span>

        <span class="c1"># go through each node in skeleton</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span><span class="o">.</span><span class="n">node_names</span><span class="p">:</span>
            <span class="c1"># if we&#39;re copying from a skeleton that has this node</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">copy_instance</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="ow">and</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">copy_instance</span>
                <span class="ow">and</span> <span class="ow">not</span> <span class="n">copy_instance</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">.</span><span class="n">isnan</span><span class="p">()</span>
            <span class="p">):</span>
                <span class="c1"># just copy x, y, and visible</span>
                <span class="c1"># we don&#39;t want to copy a PredictedPoint or score attribute</span>
                <span class="n">new_instance</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span>
                    <span class="n">x</span><span class="o">=</span><span class="n">copy_instance</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">.</span><span class="n">x</span><span class="p">,</span>
                    <span class="n">y</span><span class="o">=</span><span class="n">copy_instance</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">.</span><span class="n">y</span><span class="p">,</span>
                    <span class="n">visible</span><span class="o">=</span><span class="n">copy_instance</span><span class="p">[</span><span class="n">node</span><span class="p">]</span><span class="o">.</span><span class="n">visible</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># pick random points within currently zoomed view</span>
                <span class="n">x</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">in_view_rect</span><span class="o">.</span><span class="n">x</span><span class="p">()</span>
                    <span class="o">+</span> <span class="p">(</span><span class="n">in_view_rect</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">)</span>
                    <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">*</span> <span class="n">in_view_rect</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">y</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">in_view_rect</span><span class="o">.</span><span class="n">y</span><span class="p">()</span>
                    <span class="o">+</span> <span class="p">(</span><span class="n">in_view_rect</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.1</span><span class="p">)</span>
                    <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">*</span> <span class="n">in_view_rect</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="c1"># mark the node as not &quot;visible&quot; if we&#39;re copying from a predicted instance without this node</span>
                <span class="n">is_visible</span> <span class="o">=</span> <span class="n">copy_instance</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span>
                    <span class="n">copy_instance</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span>
                <span class="p">)</span>
                <span class="c1"># set point for node</span>
                <span class="n">new_instance</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="n">is_visible</span><span class="p">)</span>

        <span class="c1"># If we&#39;re copying a predicted instance or from another frame, copy the track</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">copy_instance</span><span class="p">,</span> <span class="s2">&quot;score&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">from_prev_frame</span><span class="p">:</span>
            <span class="n">new_instance</span><span class="o">.</span><span class="n">track</span> <span class="o">=</span> <span class="n">copy_instance</span><span class="o">.</span><span class="n">track</span>

        <span class="c1"># Add the instance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">add_instance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labeled_frame</span><span class="p">,</span> <span class="n">new_instance</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">changestack_push</span><span class="p">(</span><span class="s2">&quot;new instance&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">labeled_frame</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">labels</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labeled_frame</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">changestack_push</span><span class="p">(</span><span class="s2">&quot;new labeled frame&quot;</span><span class="p">)</span>

        <span class="c1"># update display/ui</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotFrame</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateSeekbarMarks</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateTrackMenu</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.deleteSelectedInstance"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.deleteSelectedInstance">[docs]</a>    <span class="k">def</span> <span class="nf">deleteSelectedInstance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deletes currently selected instance.&quot;&quot;&quot;</span>
        <span class="n">selected_inst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">getSelectionInstance</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">selected_inst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">remove_instance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labeled_frame</span><span class="p">,</span> <span class="n">selected_inst</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">changestack_push</span><span class="p">(</span><span class="s2">&quot;delete instance&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plotFrame</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateSeekbarMarks</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.deleteSelectedInstanceTrack"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.deleteSelectedInstanceTrack">[docs]</a>    <span class="k">def</span> <span class="nf">deleteSelectedInstanceTrack</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deletes all instances from track of currently selected instance.&quot;&quot;&quot;</span>
        <span class="n">selected_inst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">getSelectionInstance</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">selected_inst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># to do: range of frames?</span>

        <span class="n">track</span> <span class="o">=</span> <span class="n">selected_inst</span><span class="o">.</span><span class="n">track</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">remove_instance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labeled_frame</span><span class="p">,</span> <span class="n">selected_inst</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">track</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># remove any instance on this track</span>
            <span class="k">for</span> <span class="n">lf</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">inst</span> <span class="ow">in</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">inst</span><span class="p">:</span> <span class="n">inst</span><span class="o">.</span><span class="n">track</span> <span class="o">==</span> <span class="n">track</span><span class="p">,</span> <span class="n">lf</span><span class="o">.</span><span class="n">instances</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">remove_instance</span><span class="p">(</span><span class="n">lf</span><span class="p">,</span> <span class="n">inst</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">changestack_push</span><span class="p">(</span><span class="s2">&quot;delete track&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plotFrame</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateTrackMenu</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateSeekbarMarks</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.addTrack"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.addTrack">[docs]</a>    <span class="k">def</span> <span class="nf">addTrack</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Creates new track and moves selected instance into this track.&quot;&quot;&quot;</span>
        <span class="n">track_numbers_used</span> <span class="o">=</span> <span class="p">[</span>
            <span class="nb">int</span><span class="p">(</span><span class="n">track</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">tracks</span> <span class="k">if</span> <span class="n">track</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">()</span>
        <span class="p">]</span>
        <span class="n">next_number</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">track_numbers_used</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">new_track</span> <span class="o">=</span> <span class="n">Track</span><span class="p">(</span><span class="n">spawned_on</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">frame_idx</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">next_number</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">changestack_start_atomic</span><span class="p">(</span><span class="s2">&quot;add track&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">add_track</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">,</span> <span class="n">new_track</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">changestack_push</span><span class="p">(</span><span class="s2">&quot;new track&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setInstanceTrack</span><span class="p">(</span><span class="n">new_track</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">changestack_push</span><span class="p">(</span><span class="s2">&quot;set track&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">changestack_end_atomic</span><span class="p">()</span>

        <span class="c1"># update track menu and seekbar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateTrackMenu</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateSeekbarMarks</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.setInstanceTrack"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.setInstanceTrack">[docs]</a>    <span class="k">def</span> <span class="nf">setInstanceTrack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_track</span><span class="p">:</span> <span class="s2">&quot;Track&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets track for selected instance.&quot;&quot;&quot;</span>
        <span class="n">vis_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">getSelection</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">vis_idx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">selected_instance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labeled_frame</span><span class="o">.</span><span class="n">instances_to_show</span><span class="p">[</span><span class="n">vis_idx</span><span class="p">]</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labeled_frame</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">selected_instance</span><span class="p">)</span>

        <span class="n">old_track</span> <span class="o">=</span> <span class="n">selected_instance</span><span class="o">.</span><span class="n">track</span>

        <span class="c1"># When setting track for an instance that doesn&#39;t already have a track set,</span>
        <span class="c1"># just set for selected instance.</span>
        <span class="k">if</span> <span class="n">old_track</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Move anything already in the new track out of it</span>
            <span class="n">new_track_instances</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">find_track_instances</span><span class="p">(</span>
                <span class="n">video</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">,</span>
                <span class="n">track</span><span class="o">=</span><span class="n">new_track</span><span class="p">,</span>
                <span class="n">frame_range</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">frame_idx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">frame_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">new_track_instances</span><span class="p">:</span>
                <span class="n">instance</span><span class="o">.</span><span class="n">track</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="c1"># Move selected instance into new track</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">track_set_instance</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">labeled_frame</span><span class="p">,</span> <span class="n">selected_instance</span><span class="p">,</span> <span class="n">new_track</span>
            <span class="p">)</span>

        <span class="c1"># When the instance does already have a track, then we want to update</span>
        <span class="c1"># the track for a range of frames.</span>
        <span class="k">else</span><span class="p">:</span>

            <span class="c1"># Determine range that should be affected</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">seekbar</span><span class="o">.</span><span class="n">hasSelection</span><span class="p">():</span>
                <span class="c1"># If range is selected in seekbar, use that</span>
                <span class="n">frame_range</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">seekbar</span><span class="o">.</span><span class="n">getSelection</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Otherwise, range is current to last frame</span>
                <span class="n">frame_range</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">frame_idx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="o">.</span><span class="n">frames</span><span class="p">)</span>

            <span class="c1"># Do the swap</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">track_swap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">,</span> <span class="n">new_track</span><span class="p">,</span> <span class="n">old_track</span><span class="p">,</span> <span class="n">frame_range</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">changestack_push</span><span class="p">(</span><span class="s2">&quot;swap tracks&quot;</span><span class="p">)</span>

        <span class="c1"># Update visuals</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotFrame</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateSeekbarMarks</span><span class="p">()</span>

        <span class="c1"># Make sure the originally selected instance is still selected</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">selectInstance</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.transposeInstance"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.transposeInstance">[docs]</a>    <span class="k">def</span> <span class="nf">transposeInstance</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Transposes tracks for two instances.</span>

<span class="sd">        If there are only two instances, then this swaps tracks.</span>
<span class="sd">        Otherwise, it allows user to select the instances for which we want</span>
<span class="sd">        to swap tracks.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># We&#39;re currently identifying instances by numeric index, so it&#39;s</span>
        <span class="c1"># impossible to (e.g.) have a single instance which we identify</span>
        <span class="c1"># as the second instance in some other frame.</span>

        <span class="c1"># For the present, we can only &quot;transpose&quot; if there are multiple instances.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labeled_frame</span><span class="o">.</span><span class="n">instances</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="c1"># If there are just two instances, transpose them.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labeled_frame</span><span class="o">.</span><span class="n">instances</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_transpose_instances</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="c1"># If there are more than two, then we need the user to select the instances.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">onSequenceSelect</span><span class="p">(</span>
                <span class="n">seq_len</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">on_success</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_transpose_instances</span><span class="p">,</span>
                <span class="n">on_each</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_transpose_message</span><span class="p">,</span>
                <span class="n">on_failure</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">updateStatusMessage</span><span class="p">(),</span>
            <span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_transpose_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">word</span> <span class="o">=</span> <span class="s2">&quot;next&quot;</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">instance_ids</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;first&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateStatusMessage</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Please select the </span><span class="si">{word}</span><span class="s2"> instance to transpose...&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_transpose_instances</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">instance_ids</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">idx_0</span> <span class="o">=</span> <span class="n">instance_ids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">idx_1</span> <span class="o">=</span> <span class="n">instance_ids</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># Swap order in array (just for this frame) for when we don&#39;t have tracks</span>
        <span class="n">instance_0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labeled_frame</span><span class="o">.</span><span class="n">instances_to_show</span><span class="p">[</span><span class="n">idx_0</span><span class="p">]</span>
        <span class="n">instance_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labeled_frame</span><span class="o">.</span><span class="n">instances_to_show</span><span class="p">[</span><span class="n">idx_1</span><span class="p">]</span>

        <span class="c1"># Swap tracks for current and subsequent frames when we do have tracks</span>
        <span class="n">old_track</span><span class="p">,</span> <span class="n">new_track</span> <span class="o">=</span> <span class="n">instance_0</span><span class="o">.</span><span class="n">track</span><span class="p">,</span> <span class="n">instance_1</span><span class="o">.</span><span class="n">track</span>
        <span class="k">if</span> <span class="n">old_track</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">new_track</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">frame_range</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">frame_idx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="o">.</span><span class="n">frames</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">track_swap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">,</span> <span class="n">new_track</span><span class="p">,</span> <span class="n">old_track</span><span class="p">,</span> <span class="n">frame_range</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">changestack_push</span><span class="p">(</span><span class="s2">&quot;swap tracks&quot;</span><span class="p">)</span>

        <span class="c1"># Update visuals</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotFrame</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateSeekbarMarks</span><span class="p">()</span>

<div class="viewcode-block" id="MainWindow.newProject"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.newProject">[docs]</a>    <span class="k">def</span> <span class="nf">newProject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new project in a new window.&quot;&quot;&quot;</span>
        <span class="n">window</span> <span class="o">=</span> <span class="n">MainWindow</span><span class="p">()</span>
        <span class="n">window</span><span class="o">.</span><span class="n">showMaximized</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.openProject"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.openProject">[docs]</a>    <span class="k">def</span> <span class="nf">openProject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first_open</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Allows use to select and then open a saved project.</span>

<span class="sd">        Args:</span>
<span class="sd">            first_open: Whether this is the first window opened. If True,</span>
<span class="sd">                then the new project is loaded into the current window</span>
<span class="sd">                rather than a new application window.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;HDF5 dataset (*.h5 *.hdf5)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;JSON labels (*.json *.json.zip)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Matlab dataset (*.mat)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;DeepLabCut csv (*.csv)&quot;</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="n">filename</span><span class="p">,</span> <span class="n">selected_filter</span> <span class="o">=</span> <span class="n">FileDialog</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">caption</span><span class="o">=</span><span class="s2">&quot;Import labeled data...&quot;</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="s2">&quot;;;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filters</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">OPEN_IN_NEW</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">first_open</span><span class="p">:</span>
            <span class="n">new_window</span> <span class="o">=</span> <span class="n">MainWindow</span><span class="p">()</span>
            <span class="n">new_window</span><span class="o">.</span><span class="n">showMaximized</span><span class="p">()</span>
            <span class="n">new_window</span><span class="o">.</span><span class="n">loadProject</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loadProject</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.saveProject"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.saveProject">[docs]</a>    <span class="k">def</span> <span class="nf">saveProject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Show gui to save project (or save as if not yet saved).&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_trySave</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># No filename (must be new project), so treat as &quot;Save as&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">saveProjectAs</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.saveProjectAs"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.saveProjectAs">[docs]</a>    <span class="k">def</span> <span class="nf">saveProjectAs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Show gui to save project as a new file.&quot;&quot;&quot;</span>
        <span class="n">default_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;untitled&quot;</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">PurePath</span><span class="p">(</span><span class="n">default_name</span><span class="p">)</span>
        <span class="n">default_name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">with_name</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;</span><span class="si">{p.stem}</span><span class="s2"> copy</span><span class="si">{p.suffix}</span><span class="s2">&quot;</span><span class="p">))</span>

        <span class="n">filters</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;HDF5 dataset (*.h5)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;JSON labels (*.json)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Compressed JSON (*.zip)&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="n">filename</span><span class="p">,</span> <span class="n">selected_filter</span> <span class="o">=</span> <span class="n">FileDialog</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">caption</span><span class="o">=</span><span class="s2">&quot;Save As...&quot;</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="n">default_name</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="s2">&quot;;;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filters</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trySave</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
            <span class="c1"># If save was successful</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span></div>

    <span class="k">def</span> <span class="nf">_trySave</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Helper function which attempts save and handles errors.&quot;&quot;&quot;</span>
        <span class="n">success</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">Labels</span><span class="o">.</span><span class="n">save_file</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span>
            <span class="n">success</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="c1"># Mark savepoint in change stack</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">changestack_savepoint</span><span class="p">()</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="n">f</span><span class="s2">&quot;An error occured when attempting to save:</span><span class="se">\n</span><span class="s2"> </span><span class="si">{e}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
            <span class="n">message</span> <span class="o">+=</span> <span class="s2">&quot;Try saving your project with a different filename or in a different format.&quot;</span>
            <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QMessageBox</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">message</span><span class="p">)</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>

        <span class="c1"># Redraw. Not sure why, but sometimes we need to do this.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotFrame</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">success</span>

<div class="viewcode-block" id="MainWindow.closeEvent"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.closeEvent">[docs]</a>    <span class="k">def</span> <span class="nf">closeEvent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Closes application window, prompting for saving as needed.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">changestack_has_changes</span><span class="p">():</span>
            <span class="c1"># No unsaved changes, so accept event (close)</span>
            <span class="n">event</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msgBox</span> <span class="o">=</span> <span class="n">QMessageBox</span><span class="p">()</span>
            <span class="n">msgBox</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Do you want to save the changes to this project?&quot;</span><span class="p">)</span>
            <span class="n">msgBox</span><span class="o">.</span><span class="n">setInformativeText</span><span class="p">(</span><span class="s2">&quot;If you don&#39;t save, your changes will be lost.&quot;</span><span class="p">)</span>
            <span class="n">msgBox</span><span class="o">.</span><span class="n">setStandardButtons</span><span class="p">(</span>
                <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Save</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Discard</span> <span class="o">|</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Cancel</span>
            <span class="p">)</span>
            <span class="n">msgBox</span><span class="o">.</span><span class="n">setDefaultButton</span><span class="p">(</span><span class="n">QMessageBox</span><span class="o">.</span><span class="n">Save</span><span class="p">)</span>

            <span class="n">ret_val</span> <span class="o">=</span> <span class="n">msgBox</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">ret_val</span> <span class="o">==</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Cancel</span><span class="p">:</span>
                <span class="c1"># cancel close by ignoring event</span>
                <span class="n">event</span><span class="o">.</span><span class="n">ignore</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">ret_val</span> <span class="o">==</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Discard</span><span class="p">:</span>
                <span class="c1"># don&#39;t save, just close</span>
                <span class="n">event</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">ret_val</span> <span class="o">==</span> <span class="n">QMessageBox</span><span class="o">.</span><span class="n">Save</span><span class="p">:</span>
                <span class="c1"># save</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">saveProject</span><span class="p">()</span>
                <span class="c1"># accept avent (close)</span>
                <span class="n">event</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.nextVideo"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.nextVideo">[docs]</a>    <span class="k">def</span> <span class="nf">nextVideo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Activates next video in project.&quot;&quot;&quot;</span>
        <span class="n">new_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">video_idx</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">new_idx</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">new_idx</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">videos</span><span class="p">)</span> <span class="k">else</span> <span class="n">new_idx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loadVideo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">videos</span><span class="p">[</span><span class="n">new_idx</span><span class="p">],</span> <span class="n">new_idx</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.previousVideo"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.previousVideo">[docs]</a>    <span class="k">def</span> <span class="nf">previousVideo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Activates previous video in project.&quot;&quot;&quot;</span>
        <span class="n">new_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">video_idx</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">new_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">videos</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">new_idx</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">new_idx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loadVideo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">videos</span><span class="p">[</span><span class="n">new_idx</span><span class="p">],</span> <span class="n">new_idx</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.gotoFrame"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.gotoFrame">[docs]</a>    <span class="k">def</span> <span class="nf">gotoFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Shows gui to go to frame by number.&quot;&quot;&quot;</span>
        <span class="n">frame_number</span><span class="p">,</span> <span class="n">okay</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QInputDialog</span><span class="o">.</span><span class="n">getInt</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="s2">&quot;Go To Frame...&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Frame Number:&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">frame_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
            <span class="mi">1</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="o">.</span><span class="n">frames</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">okay</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotFrame</span><span class="p">(</span><span class="n">frame_number</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.exportLabeledClip"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.exportLabeledClip">[docs]</a>    <span class="k">def</span> <span class="nf">exportLabeledClip</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Shows gui for exporting clip with visual annotations.&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">sleap.io.visuals</span> <span class="k">import</span> <span class="n">save_labeled_video</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">seekbar</span><span class="o">.</span><span class="n">hasSelection</span><span class="p">():</span>

            <span class="n">fps</span><span class="p">,</span> <span class="n">okay</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QInputDialog</span><span class="o">.</span><span class="n">getInt</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span>
                <span class="s2">&quot;Frames per second&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Frames per second:&quot;</span><span class="p">,</span>
                <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">,</span> <span class="s2">&quot;fps&quot;</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
                <span class="mi">1</span><span class="p">,</span>
                <span class="mi">300</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">okay</span><span class="p">:</span>
                <span class="k">return</span>

            <span class="n">filename</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">FileDialog</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span>
                <span class="n">caption</span><span class="o">=</span><span class="s2">&quot;Save Video As...&quot;</span><span class="p">,</span>
                <span class="nb">dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;.avi&quot;</span><span class="p">,</span>
                <span class="nb">filter</span><span class="o">=</span><span class="s2">&quot;AVI Video (*.avi)&quot;</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span>

            <span class="n">save_labeled_video</span><span class="p">(</span>
                <span class="n">labels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span>
                <span class="n">video</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">,</span>
                <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span>
                <span class="n">frames</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">seekbar</span><span class="o">.</span><span class="n">getSelection</span><span class="p">())),</span>
                <span class="n">fps</span><span class="o">=</span><span class="n">fps</span><span class="p">,</span>
                <span class="n">gui_progress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.exportLabeledFrames"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.exportLabeledFrames">[docs]</a>    <span class="k">def</span> <span class="nf">exportLabeledFrames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Gui for exporting the training dataset of labels/frame images.&quot;&quot;&quot;</span>
        <span class="n">filters</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;HDF5 dataset (*.h5)&quot;</span><span class="p">,</span> <span class="s2">&quot;Compressed JSON dataset (*.json *.json.zip)&quot;</span><span class="p">]</span>
        <span class="n">filename</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">FileDialog</span><span class="o">.</span><span class="n">save</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">caption</span><span class="o">=</span><span class="s2">&quot;Save Labeled Frames As...&quot;</span><span class="p">,</span>
            <span class="nb">dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;.h5&quot;</span><span class="p">,</span>
            <span class="n">filters</span><span class="o">=</span><span class="s2">&quot;;;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filters</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">Labels</span><span class="o">.</span><span class="n">save_file</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">default_suffix</span><span class="o">=</span><span class="s2">&quot;h5&quot;</span><span class="p">,</span> <span class="n">save_frame_data</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_plot_if_next</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame_iterator</span><span class="p">:</span> <span class="n">Iterator</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Plots next frame (if there is one) from iterator.</span>

<span class="sd">        Arguments:</span>
<span class="sd">            frame_iterator: The iterator from which we&#39;ll try to get next</span>
<span class="sd">            :class:`LabeledFrame`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if we went to next frame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">next_lf</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">frame_iterator</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plotFrame</span><span class="p">(</span><span class="n">next_lf</span><span class="o">.</span><span class="n">frame_idx</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">previousLabeledFrameIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">cur_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">frame_idx</span>
        <span class="n">frames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">frames</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">,</span> <span class="n">from_frame_idx</span><span class="o">=</span><span class="n">cur_idx</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">next_idx</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span><span class="o">.</span><span class="n">frame_idx</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">return</span> <span class="n">next_idx</span>

<div class="viewcode-block" id="MainWindow.previousLabeledFrame"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.previousLabeledFrame">[docs]</a>    <span class="k">def</span> <span class="nf">previousLabeledFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Goes to labeled frame prior to current frame.&quot;&quot;&quot;</span>
        <span class="n">frames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">frames</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">,</span> <span class="n">from_frame_idx</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">frame_idx</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_if_next</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.nextLabeledFrame"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.nextLabeledFrame">[docs]</a>    <span class="k">def</span> <span class="nf">nextLabeledFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Goes to labeled frame after current frame.&quot;&quot;&quot;</span>
        <span class="n">frames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">frames</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">,</span> <span class="n">from_frame_idx</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">frame_idx</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_if_next</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.nextUserLabeledFrame"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.nextUserLabeledFrame">[docs]</a>    <span class="k">def</span> <span class="nf">nextUserLabeledFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Goes to next labeled frame with user instances.&quot;&quot;&quot;</span>
        <span class="n">frames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">frames</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">,</span> <span class="n">from_frame_idx</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">frame_idx</span><span class="p">)</span>
        <span class="c1"># Filter to frames with user instances</span>
        <span class="n">frames</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">lf</span><span class="p">:</span> <span class="n">lf</span><span class="o">.</span><span class="n">has_user_instances</span><span class="p">,</span> <span class="n">frames</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_plot_if_next</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.nextSuggestedFrame"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.nextSuggestedFrame">[docs]</a>    <span class="k">def</span> <span class="nf">nextSuggestedFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seek_direction</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Goes to next (or previous) suggested frame.&quot;&quot;&quot;</span>
        <span class="n">next_video</span><span class="p">,</span> <span class="n">next_frame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">get_next_suggestion</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">frame_idx</span><span class="p">,</span> <span class="n">seek_direction</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">next_video</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gotoVideoAndFrame</span><span class="p">(</span><span class="n">next_video</span><span class="p">,</span> <span class="n">next_frame</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">next_frame</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">selection_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">get_suggestions</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">(</span>
                <span class="p">(</span><span class="n">next_video</span><span class="p">,</span> <span class="n">next_frame</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">suggestionsTable</span><span class="o">.</span><span class="n">selectRow</span><span class="p">(</span><span class="n">selection_idx</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.nextTrackFrame"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.nextTrackFrame">[docs]</a>    <span class="k">def</span> <span class="nf">nextTrackFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Goes to next frame on which a track starts.&quot;&quot;&quot;</span>
        <span class="n">cur_idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">frame_idx</span>
        <span class="n">track_ranges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="o">.</span><span class="n">get_track_occupany</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">)</span>
        <span class="n">next_idx</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">track_range</span><span class="o">.</span><span class="n">start</span>
                <span class="k">for</span> <span class="n">track_range</span> <span class="ow">in</span> <span class="n">track_ranges</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">track_range</span><span class="o">.</span><span class="n">start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">track_range</span><span class="o">.</span><span class="n">start</span> <span class="o">&gt;</span> <span class="n">cur_idx</span>
            <span class="p">],</span>
            <span class="n">default</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">next_idx</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotFrame</span><span class="p">(</span><span class="n">next_idx</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.gotoVideoAndFrame"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.gotoVideoAndFrame">[docs]</a>    <span class="k">def</span> <span class="nf">gotoVideoAndFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">video</span><span class="p">:</span> <span class="n">Video</span><span class="p">,</span> <span class="n">frame_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Activates video and goes to frame.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">video</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">video</span><span class="p">:</span>
            <span class="c1"># switch to the other video</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loadVideo</span><span class="p">(</span><span class="n">video</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotFrame</span><span class="p">(</span><span class="n">frame_idx</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.toggleLabels"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.toggleLabels">[docs]</a>    <span class="k">def</span> <span class="nf">toggleLabels</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Toggles whether skeleton node labels are shown in video overlay.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_show_labels</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_show_labels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_menu_actions</span><span class="p">[</span><span class="s2">&quot;show labels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_show_labels</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">showLabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_show_labels</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.toggleEdges"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.toggleEdges">[docs]</a>    <span class="k">def</span> <span class="nf">toggleEdges</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Toggles whether skeleton edges are shown in video overlay.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_show_edges</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_show_edges</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_menu_actions</span><span class="p">[</span><span class="s2">&quot;show edges&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_show_edges</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">showEdges</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_show_edges</span><span class="p">)</span></div>

<div class="viewcode-block" id="MainWindow.toggleTrails"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.toggleTrails">[docs]</a>    <span class="k">def</span> <span class="nf">toggleTrails</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Toggles whether track trails are shown in video overlay.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">overlays</span><span class="p">[</span><span class="s2">&quot;trails&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">show</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">overlays</span><span class="p">[</span><span class="s2">&quot;trails&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">show</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_menu_actions</span><span class="p">[</span><span class="s2">&quot;show trails&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">overlays</span><span class="p">[</span><span class="s2">&quot;trails&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotFrame</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.setTrailLength"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.setTrailLength">[docs]</a>    <span class="k">def</span> <span class="nf">setTrailLength</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trail_length</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets length of track trails to show in video overlay.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">overlays</span><span class="p">[</span><span class="s2">&quot;trails&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">trail_length</span> <span class="o">=</span> <span class="n">trail_length</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_menu_check_single</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trailLengthMenu</span><span class="p">,</span> <span class="n">trail_length</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">video</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotFrame</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.setPalette"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.setPalette">[docs]</a>    <span class="k">def</span> <span class="nf">setPalette</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">palette</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Sets color palette used for track colors.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_color_manager</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="n">palette</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_menu_check_single</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">paletteMenu</span><span class="p">,</span> <span class="n">palette</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">video</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotFrame</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">updateSeekbarMarks</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">_menu_check_single</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">menu</span><span class="p">,</span> <span class="n">item_text</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Helper method to select exactly one submenu item.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">menu_item</span> <span class="ow">in</span> <span class="n">menu</span><span class="o">.</span><span class="n">children</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">menu_item</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">item_text</span><span class="p">):</span>
                <span class="n">menu_item</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">menu_item</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<div class="viewcode-block" id="MainWindow.toggleColorPredicted"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.toggleColorPredicted">[docs]</a>    <span class="k">def</span> <span class="nf">toggleColorPredicted</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Toggles whether predicted instances are shown in track colors.&quot;&quot;&quot;</span>
        <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">overlays</span><span class="p">[</span><span class="s2">&quot;instance&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">color_predicted</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">overlays</span><span class="p">[</span><span class="s2">&quot;instance&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">color_predicted</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">val</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_menu_actions</span><span class="p">[</span><span class="s2">&quot;color predicted&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">overlays</span><span class="p">[</span><span class="s2">&quot;instance&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">color_predicted</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotFrame</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.toggleAutoZoom"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.toggleAutoZoom">[docs]</a>    <span class="k">def</span> <span class="nf">toggleAutoZoom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Toggles whether to zoom viewer to fit labeled instances.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_auto_zoom</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_auto_zoom</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_menu_actions</span><span class="p">[</span><span class="s2">&quot;fit&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_auto_zoom</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_auto_zoom</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">player</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">clearZoom</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotFrame</span><span class="p">()</span></div>

<div class="viewcode-block" id="MainWindow.openKeyRef"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.MainWindow.openKeyRef">[docs]</a>    <span class="k">def</span> <span class="nf">openKeyRef</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Shows gui for viewing/modifying keyboard shortucts.&quot;&quot;&quot;</span>
        <span class="n">ShortcutDialog</span><span class="p">()</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span></div></div>


<div class="viewcode-block" id="main"><a class="viewcode-back" href="../../../gui.html#sleap.gui.app.main">[docs]</a><span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Starts new instance of app.&quot;&quot;&quot;</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">QApplication</span><span class="p">([])</span>
    <span class="n">app</span><span class="o">.</span><span class="n">setApplicationName</span><span class="p">(</span><span class="s2">&quot;SLEAP Label&quot;</span><span class="p">)</span>

    <span class="n">window</span> <span class="o">=</span> <span class="n">MainWindow</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">window</span><span class="o">.</span><span class="n">showMaximized</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;labels_path&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">window</span><span class="o">.</span><span class="n">openProject</span><span class="p">(</span><span class="n">first_open</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">app</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">argparse</span>

    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;labels_path&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Path to labels file&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s2">&quot;?&quot;</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--nonnative&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Don&#39;t use native file dialogs&quot;</span><span class="p">,</span>
        <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_const&quot;</span><span class="p">,</span>
        <span class="n">const</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">nonnative</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;USE_NON_NATIVE_FILE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>

    <span class="n">main</span><span class="p">(</span><span class="n">labels_path</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">labels_path</span><span class="p">)</span>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Murthy Lab @ Princeton

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>